;==============================================================
; CNS File for C18 Z2 by Nico_18 & XGargoyle
; Helper States
;==============================================================

;VISM Timer OFF
[Statedef 9997]
type    = S
movetype= I
physics = N
anim = 9999
sprpriority = 9

[State 0, ParentVarSet] ;OFF
type = ParentVarSet
trigger1 = time=0
var(54) = 0
;ignorehitpause =
persistent = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible

[State 1061, End]
type = destroyself
trigger1 = time>60

;VISM Timer
[Statedef 9998]
type    = S
movetype= I
physics = N
anim = 9999
sprpriority = 9

[State 0, ParentVarSet] ;ON
type = ParentVarSet
trigger1 = time=0
var(54) = 1
;ignorehitpause =
persistent = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible

[State 1061, End]
type = destroyself
trigger1 = time>60


;V-Ism - Original code by Messatsu.
;Adaptations and customization by XGargoyle
;http://mugenguild.com/forum/topics/complete-vism--11568.0.html
;___________________________________________________________________
[Statedef 500];                // custom combo function
anim = 9999

[State 500, Pos X]
type     = helper
trigger1 = !time
id       = 501
stateno  = 501

[State 500, Pos Y]
type     = helper
trigger1 = !time
id       = 502
stateno  = 502

[State 500, Anim]
type     = helper
trigger1 = !time
id       = 503
stateno  = 503

[State 500, Stateno]
type     = helper
trigger1 = !time
id       = 504
stateno  = 504

[State 500, AnimElemNo]
type     = helper
trigger1 = !time
id       = 505
stateno  = 505

[State 500, Facing]
type     = null
trigger1 = !(root, hitpausetime)
trigger1 = fvar((floor(var(0) / 2.0))) := root, facing

[State 500, Clone]
type     = varset
trigger1 = !time
var(1)   = 1

[State 500, Next]
type     = varset
trigger1 = !time
var(2)   = 2

[State 500, Vism]
type     = helper
triggerall = NumHelper(500) && NumHelper(501) && NumHelper(502) && NumHelper(503) && NumHelper(504)
trigger1 = numhelper(666) < 1
trigger1 = time > root, var(51) - 2
trigger1 = helper(504), var((var(2))) != [0, 110)
trigger1 = helper(504), var((var(1))) != helper(504), var((var(2)))
postype  = left
pos      = helper(500), floor(pos x) - helper(501), var((var(2))) + 160, helper(500), floor(pos y) - helper(502), var((var(2)))
id       = 666
facing   = floor(fvar((floor(var(2) / 2.0))))
stateno  = helper(504), var((var(2)))
ignorehitpause = 1

[State 500, Modify]
type     = varadd
trigger1 = !(root, hitpausetime)
var(0)   = 1

[State 500, Modify]
type     = varadd
trigger1 = !(root, hitpausetime)
var(1)   = 1

[State 500, Modify]
type     = varadd
trigger1 = !(root, hitpausetime)
var(2)   = 1

[State 500, Train]
type     = varset
trigger1 = var(0) = root, var(51)
var(0)   = 0

[State 500, Train]
type     = varset
trigger1 = var(1) = root, var(51)
var(1)   = 0

[State 500, Train]
type     = varset
trigger1 = var(2) = root, var(51)
var(2)   = 0

[State 500, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1
;___________________________________________________________________

[Statedef 501]
anim = 9999

[State 501]
type     = null
triggerall = NumHelper(500)
trigger1 = !(root, hitpausetime)
trigger1 = var(( helper(500), var(0) )):= floor(helper(500), pos x - root, pos x)

[State 501]
type     = null
triggerall = NumHelper(500)
trigger1 = !(root, hitpausetime)
trigger1 = helper(500), var(0) = [0,30)
trigger1 = fvar(( helper(500), var(0) )):= root, vel x

[State 501, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1
;___________________________________________________________________

[Statedef 502]
anim = 9999

[State 502]
type     = null
triggerall = NumHelper(500)
trigger1 = !(root, hitpausetime)
trigger1 = var(( helper(500), var(0) )):= floor(helper(500), pos y - root, pos y)

[State 502]
type     = null
triggerall = NumHelper(500)
trigger1 = !(root, hitpausetime)
trigger1 = helper(500), var(0) = (29,60)
trigger1 = fvar(( helper(500), var(0) - 30 )):= root, vel x

[State 502, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1
;___________________________________________________________________

[Statedef 503]
anim = 9999

[State 503]
type     = null
triggerall = NumHelper(500)
trigger1 = !(root, hitpausetime)
trigger1 = var(( helper(500), var(0) )):= root, anim

[State 503]
type     = null
triggerall = NumHelper(500)
trigger1 = !(root, hitpausetime)
trigger1 = helper(500), var(0) = [0,30)
trigger1 = fvar(( helper(500), var(0) )):= root, vel y

[State 503, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1
;___________________________________________________________________

[Statedef 504]
anim = 9999

[State 504]
type     = null
triggerall = NumHelper(500)
trigger1 = !(root, hitpausetime)
trigger1 = var(( helper(500), var(0) )):= root, stateno

[State 504]
type     = null
triggerall = NumHelper(500)
trigger1 = !(root, hitpausetime)
trigger1 = helper(500), var(0) = (29,60)
trigger1 = fvar(( helper(500), var(0) - 30 )):= root, vel y

[State 504, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1

;___________________________________________________________________

[Statedef 505]
anim = 9999

[State 505]
type     = null
triggerall = NumHelper(500)
trigger1 = !(root, hitpausetime)
trigger1 = var(( helper(500), var(0) )):= root, AnimElemNo(0)

[State 505]
type     = null
triggerall = NumHelper(500)
trigger1 = !(root, hitpausetime)
trigger1 = helper(500), var(0) = (29,60)
trigger1 = fvar(( helper(500), var(0) - 30 )):= root, vel y

[State 505, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1

;-------------
[Statedef 550];                // custom combo function
anim = 9999

[State 550, Pos X]
type     = helper
trigger1 = !time
id       = 551
stateno  = 551

[State 550, Pos Y]
type     = helper
trigger1 = !time
id       = 552
stateno  = 552

[State 550, Anim]
type     = helper
trigger1 = !time
id       = 553
stateno  = 553

[State 550, Stateno]
type     = helper
trigger1 = !time
id       = 554
stateno  = 554

[State 550, AnimElemNo]
type     = helper
trigger1 = !time
id       = 555
stateno  = 555

[State 550, Facing]
type     = null
trigger1 = !(root, hitpausetime)
trigger1 = fvar((floor(var(0) / 2.0))) := root, facing

[State 550, Clone]
type     = varset
trigger1 = !time
var(1)   = 1

[State 550, Next]
type     = varset
trigger1 = !time
var(2)   = 2

[State 550, Vism]
type     = helper
triggerall = NumHelper(550) && NumHelper(551) && NumHelper(552) && NumHelper(553) && NumHelper(554)
trigger1 = numhelper(667) < 1
trigger1 = time > root, var(50) - 2
trigger1 = helper(554), var((var(2))) != [0, 110)
trigger1 = helper(554), var((var(1))) != helper(554), var((var(2)))
postype  = left
pos      = helper(550), floor(pos x) - helper(551), var((var(2))) + 160, helper(550), floor(pos y) - helper(552), var((var(2)))
id       = 667
facing   = floor(fvar((floor(var(2) / 2.0))))
stateno  = helper(554), var((var(2)))
ignorehitpause = 1

[State 550, Modify]
type     = varadd
trigger1 = !(root, hitpausetime)
var(0)   = 1

[State 550, Modify]
type     = varadd
trigger1 = !(root, hitpausetime)
var(1)   = 1

[State 550, Modify]
type     = varadd
trigger1 = !(root, hitpausetime)
var(2)   = 1

[State 550, Train]
type     = varset
trigger1 = var(0) = root, var(50)
var(0)   = 0

[State 550, Train]
type     = varset
trigger1 = var(1) = root, var(50)
var(1)   = 0

[State 550, Train]
type     = varset
trigger1 = var(2) = root, var(50)
var(2)   = 0

[State 550, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1

;___________________________________________________________________

[Statedef 551]
anim = 9999

[State 551]
type     = null
triggerall = NumHelper(550)
trigger1 = !(root, hitpausetime)
trigger1 = var(( helper(550), var(0) )):= floor(helper(550), pos x - root, pos x)

[State 551]
type     = null
triggerall = NumHelper(550)
trigger1 = !(root, hitpausetime)
trigger1 = helper(550), var(0) = [0,30)
trigger1 = fvar(( helper(550), var(0) )):= root, vel x

[State 551, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1
;___________________________________________________________________

[Statedef 552]
anim = 9999

[State 552]
type     = null
triggerall = NumHelper(550)
trigger1 = !(root, hitpausetime)
trigger1 = var(( helper(550), var(0) )):= floor(helper(550), pos y - root, pos y)

[State 552]
type     = null
triggerall = NumHelper(550)
trigger1 = !(root, hitpausetime)
trigger1 = helper(550), var(0) = (29,60)
trigger1 = fvar(( helper(550), var(0) - 30 )):= root, vel x

[State 552, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1
;___________________________________________________________________

[Statedef 553]
anim = 9999

[State 553]
type     = null
triggerall = NumHelper(550)
trigger1 = !(root, hitpausetime)
trigger1 = var(( helper(550), var(0) )):= root, anim

[State 553]
type     = null
triggerall = NumHelper(550)
trigger1 = !(root, hitpausetime)
trigger1 = helper(550), var(0) = [0,30)
trigger1 = fvar(( helper(550), var(0) )):= root, vel y

[State 553, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1
;___________________________________________________________________

[Statedef 554]
anim = 9999

[State 554]
type     = null
triggerall = NumHelper(550)
trigger1 = !(root, hitpausetime)
trigger1 = var(( helper(550), var(0) )):= root, stateno

[State 554]
type     = null
triggerall = NumHelper(550)
trigger1 = !(root, hitpausetime)
trigger1 = helper(550), var(0) = (29,60)
trigger1 = fvar(( helper(550), var(0) - 30 )):= root, vel y

[State 554, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1

;___________________________________________________________________

[Statedef 555]
anim = 9999

[State 555]
type     = null
triggerall = NumHelper(550)
trigger1 = !(root, hitpausetime)
trigger1 = var(( helper(550), var(0) )):= root, AnimElemNo(0)

[State 555]
type     = null
triggerall = NumHelper(550)
trigger1 = !(root, hitpausetime)
trigger1 = helper(550), var(0) = (29,60)
trigger1 = fvar(( helper(550), var(0) - 30 )):= root, vel y

[State 555, X_X]
type     = destroyself
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1

;Heart Helper
[Statedef 7902]
type = A
movetype = I
physics = N
ctrl = 0
anim = 7902
velset = 0,0
sprpriority = 10

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NT,ST,HT,NP,SP,HP
;value2 = S,NA
time = 1
;ignorehitpause =
;persistent =

;----------------------
;Aimed projectile, based on code made by Bea

;Finds the X component of the vector Player, EnemyNear
;Formula to find the components of a given vector AB
;V(x) = B(x) - A(x)
;V(y) = B(y) - A(y)
[State 1640, X]
Type = VarSet
Trigger1 = 1
;fvar(1) = Pos X - (enemy,pos X -(Enemy,Const(size.head.pos.x)))* Facing ;Adjust the direction towards player facing
fvar(1) = abs(ScreenPos X - enemy,screenpos X)-abs(Enemy,Const(size.head.pos.x))
;Finds the Y component of the vector Player, EnemyNear
[State 1640, Y]
Type = VarSet
trigger1 = 1
fvar(2) = Pos Y + abs(Enemy,Const(size.head.pos.y)) + abs(enemy,Pos Y)

;Finds the vector length
;Formula of the length of a given vector AB
;|AB| = (AB(x)^2  + AB(y)^2)^1/2
[State 1640, Vector Length 0]
Type = VarSet
trigger1 = 1
fvar(3) = Exp(0.5*ln((fvar(1) * fvar(1))+(fvar(2) * fvar(2))))

;Normalizes the components
;and multiply by the desired absolute velocity.
;----------------------

[State 0, VelSet]
type = VelSet
trigger1 = anim=7902
x = (Fvar(1)/fvar(3)) * 1.5
y = -(FVar(2)/fvar(3)) * 1.5
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = anim=7902
;trigger1 = Pos X - (enemy,pos X - (enemy,Const(size.head.pos.x)))=[-5,5]
trigger1 = abs(floor(ScreenPos X - enemy,screenpos X))-abs(Enemy,Const(size.head.pos.x))=[-5,5]
trigger1 = Pos Y - (enemy,Const(size.head.pos.y))=[-5,5]
trigger2 = IsHelper(195) ;Taunt
trigger2 = time>120
value = 7903
;elem = 1
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = Anim = 7903
x = 0
y = 0
;ignorehitpause =
;persistent =

[State 0, DestroySelf]
type = DestroySelf
trigger1 = Anim = 7903
trigger1 = !animtime
;ignorehitpause =
;persistent =

;===================================================
;DASH COLLISION NOTIFICATION
[Statedef 13200]
type=A
physics=N
movetype=I
anim = 15999
velset=0,0
sprpriority=6

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State -2, Explod]; Notification
type = null;Explod
trigger1 = !time
anim = 13200
removetime = -2
supermove = 1
sprpriority = 1
id = 13200
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = -1
facing = facing
scale = 0.5,0.5

[state 17100,scale FX]
type = null;modifyexplod
trigger1 = numexplod(13200)
trigger1 = time>=10
scale = 0.5+0.02*(time-10),0.5+0.02*(time-10)
id = 13200

[State 8000, End]
type=destroyself
trigger1= time>=40

;Limiter Timer
[Statedef 9999]
type    = S
movetype= I
physics = N
anim = 9999
sprpriority = 9

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible

[State 1061, End]
type = destroyself
trigger1 = IsHelper(241) ;F+s.MK1
trigger1 = time>20
trigger2 = IsHelper(1600) ;Graceful Revolution
trigger2 = time>120
trigger3 = IsHelper(625) ;J.SP stomp punch
trigger3 = time>20
trigger3 = P2MoveType != H
trigger4 = IsHelper(1500) ;Blitz Deadend
trigger4 = root,NumHelper(1540)=0
trigger4 = P2MoveType != H
trigger5 = IsHelper(1205) ;Cross kick
trigger5 = time>20
trigger5 = P2MoveType != H


;======================================================================
;---------------------------
;Detect life Helper (Coded by 2OS)
[Statedef 2]

[State 2OS]
type = statetypeset
trigger1 = 1
movetype = I
ignorehitpause = 1
persistent = 1

[State 2OS, Blank Animation]
type = changeanim
trigger1 = 1
value = 15999
ignorehitpause = 1
persistent = 1

[State 2OS]
type = bindtoroot
trigger1 = 1
pos = 0,0
ignorehitpause = 1
persistent = 1

[State 2OS, Damage Var Delay Reset]
type = varset
trigger1 = var(1)>1
var(1) = 0
ignorehitpause = 1
persistent = 1

[State 2OS, Damage Var Delay]
type = varadd
trigger1 = var(2) != root,life
var(1) = 1
ignorehitpause = 1
persistent = 1

[State 2OS, Damage Var]
type = varset
trigger1 = (var(1)!=[0,1])
var(2) = root,life
ignorehitpause = 1
persistent = 1



;======================================================================
; POWER CHARGE AURA
[Statedef 905]
type = A
MoveType = I
physics = N
ctrl = 0
anim = 906
velset = 0,0
sprpriority = 5 ;-1

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "time=%d | FN(x)=%f"
params = time,1+0.05*cos((time-12)/10.0)
ignorehitpause = 1
;persistent =

[State 1902, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time<12
value = 1
scale = 1,0.08*time
ignorehitpause = 1
;persistent =

[State 0, AngleDraw] ;heat effect
type = AngleDraw
trigger1 = time>=12
value = 1
scale = 1+0.05*cos((time-12)/10.0),1+0.05*cos((time-12)/10.0)
ignorehitpause = 1
;persistent =


[State 1902, BindToParent]
type = BindToParent
trigger1 = anim = 906
pos = 0,0 ;-10,-2

[State 1902, Anim]
type = null;ChangeAnim
triggerall = anim = 906
trigger1 = root,stateno = 901
value = 906

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = anim = 906 && (Root,StateNo != 900)
trigger2 = root,movetype=H
;trigger2 = anim = 906 && animTime = 0
;trigger3 = Root,stateno = [5000,5090]

;Blitz Fireball
[Statedef 1030]
type    = S
movetype= A
physics = N
anim = 1030
sprpriority = 5
hitcountpersist = 1
;movehitpersist = 1
facep2 = 1

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "ROOT=%d | ID=%d | vel x=%f | FallenvID=%d | NumTarget=%d | DistX: %d"
params = (root,ID), ID, gethitvar(xvel), gethitvar(fall.envshake.ampl), (root,NumTarget), rootdist x
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NA, SA, HA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 0, bounce]
type = HitOverride
trigger1 = Time >= 0
slot = 1
stateno = 1031
attr = SCA, NA, SA, HA
time = 1

[State 0, vanish]
type = HitOverride
trigger1 = Time >= 0
slot = 2
stateno = 1032
attr = SCA, NP, SP, HP
time = 1

[State 0, Offset]
type = Offset
trigger1 = Time >= 0
x = random%3
y = random%3
;ignorehitpause =
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = 1030,0



[State 0, Turn]
type = Turn
trigger1 = facing != root,facing
ignorehitpause = 1
;persistent =

[State 1061, Hitdef]
type = HitDef
trigger1 = root,ID=parent,ID ;spawned by Root
attr = S, SP
animtype  = hard
damage = ceil(ifElse(root,fvar(11) * 30< 7, 7, root,fvar(11) *30)),3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
affectteam = E
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = -1;s1210,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -7.8,0
guard.velocity = -7.5
air.velocity = -5.8,-3
airguard.velocity = -5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= Cond((root,NumHelper(4750)=0),ifelse(p2movetype=H,40,140),0),Cond((root,NumHelper(4750)=0),10,0)
givepower = 35,35
;ID = 1030
persistent = 0
[State 1061, Hitdef]
type = HitDef
trigger1 = root,ID!=parent,ID ;spawned by Clone
attr = S, SP
animtype  = hard
damage = 7,3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
affectteam = E
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = -1;s1210,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -7.8,0
guard.velocity = -7.5
air.velocity = -5.8,-3
airguard.velocity = -5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 0,0
;ID = 1030
persistent = 0

[State 0, HitAdd]
type = null;HitAdd
trigger1 = numtarget(1030)
value = 0
ignorehitpause = 1
;persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 =  movecontact
value = 1032
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

[State 3001, Guardshake]
type = envshake
trigger1 = moveguarded
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 0, ChangeState] ;to disappear
type = ChangeState
trigger1 = time>180
trigger2 = root,NumExplod(991901) ;cinematic
value = 1034
ctrl = 0
ignorehitpause = 1
;persistent =

[State 1061, End]
type = destroyself
trigger1 = (pos x!=[-240,240])


;Blitz Fireball movement
[Statedef 1031]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1031 ;1030
velset = 0,0
sprpriority = 10
facep2 = 1

[State 0, ChangeState] ;hit by enemy
type = ChangeState
triggerall = 1
trigger1 = !PlayerIDExist(gethitvar(fall.envshake.ampl))
trigger2 = (root,ID)!=gethitvar(fall.envshake.ampl)
value = 1033
ctrl = 0
;anim =
ignorehitpause = 1
persistent = 0


[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NT,ST,HT
;value2 = S,NA
time = 1
;ignorehitpause =
;persistent =

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA,NA,SA,HA,NP,SP,HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = 1032
attr = SCA, AA, AP ;, AT
ignorehitpause = 1


[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "ROOT=%d | ID=%d | vel x=%f | FallenvID=%d | NumTarget=%d"
params = (root,ID), ID, gethitvar(xvel), gethitvar(fall.envshake.ampl), (root,NumTarget)
ignorehitpause = 1
;persistent =

[State 0, Turn]
type = Turn
trigger1 = facing != root,facing
ignorehitpause = 1
;persistent =

[State 0, VelSet] ;apply speed only if hit by root
type = VelSet
trigger1 = PlayerIDExist(gethitvar(fall.envshake.ampl))
trigger1 = (root,ID)=gethitvar(fall.envshake.ampl)
trigger1 = !time
x = 1.3*abs(gethitvar(xvel))+3*(root,stateno=215)+2*(root,statetype=A)
y = -4-abs(gethitvar(yvel)) ;-2 ;gethitvar(yvel)
ignorehitpause = 1
;persistent =

[State 0, Gravity]
type = VelAdd
trigger1 = 1
y = 0.6*const(movement.yaccel)
;ignorehitpause =
;persistent =

;----------------------
;Aimed projectile, based on code made by Bea

;Finds the X component of the vector Player, EnemyNear
;Formula to find the components of a given vector AB
;V(x) = B(x) - A(x)
;V(y) = B(y) - A(y)
[State 1640, X]
Type = VarSet
Trigger1 = 1
fvar(1) = (EnemyNear(0),Pos X - Pos X) * Facing ;Adjust the direction towards player facing
;Finds the Y component of the vector Player, EnemyNear
[State 1640, Y]
Type = VarSet
trigger1 = 1
fvar(2) = (EnemyNear(0),pos Y - Pos Y)

;Finds the vector length
;Formula of the length of a given vector AB
;|AB| = (AB(x)^2  + AB(y)^2)^1/2
[State 1640, Vector Length 0]
Type = VarSet
trigger1 = 1
fvar(3) = Exp(0.5*ln((fvar(1) * fvar(1))+(fvar(2) * fvar(2))))

[State 37001, Velocity 0]
type = null;VelSet
trigger1 = Time = 0
x = (Fvar(1)/fvar(3)) * 10.0
y = (FVar(2)/fvar(3)) * 10.0
;Normalizes the components
;and multiply by the desired absolute velocity.
;----------------------
[State 0, VarSet] ;angle
type = VarSet
trigger1 = 1 ;time=0
fvar(4)= (180/pi)*atan((-1*(vel y))/vel x)
;ignorehitpause =
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = fvar(4)
scale = 1,1
;ignorehitpause =
;persistent =



[State 1061, Hitdef]
type = HitDef
;trigger1 = Time >= 0
trigger1 = root,ID=parent,ID ;spawned by Root
attr = S, SP
animtype  = hard
damage = ceil(ifElse(root,fvar(11) * 30< 7, 7, root,fvar(11) *30)),3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
affectteam = E
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = -1;s1210,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -7.8,0
guard.velocity = -7.5
air.velocity = -5.8,-3
airguard.velocity = -5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= Cond((root,NumHelper(4750)=0),ifelse(p2movetype=H,40,140),0),Cond((root,NumHelper(4750)=0),10,0)
givepower = 35,35
;ID = 1030
persistent = 0
[State 1061, Hitdef]
type = HitDef
;trigger1 = Time >= 0
trigger1 = root,ID!=parent,ID ;spawned by Clone
attr = S, SP
animtype  = hard
damage = 7,3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
affectteam = E
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = -1;s1210,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -7.8,0
guard.velocity = -7.5
air.velocity = -5.8,-3
airguard.velocity = -5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 0,0
;ID = 1030
persistent = 0

[State 0, HitAdd]
type = null;HitAdd
trigger1 = numtarget(1030)
value = 0
ignorehitpause = 1
;persistent = 0

[State 0, Offset]
type = Offset
trigger1 = Time >= 0
x = random%3
y = random%3
ignorehitpause = 1
;persistent =

[State 0, DestroySelf]
type = DestroySelf
trigger1 = (pos x!=[-240,240])
;trigger2 = time>60
;ignorehitpause =
;persistent =

[State 1061, Fade]
type = changestate
trigger1 = movecontact
trigger2 = pos Y >= -5 ;10
value = 1032
ignorehitpause=1
;persistent = 0

;Blitz Fireball vanish
[Statedef 1032]
type    = A
movetype= A
physics = N
anim = 1032
sprpriority = 5
velset = 0,0
facep2 = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1002, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NT,ST,HT,NP,SP,HP
;value2 = S,NA
time = 1
;ignorehitpause =
;persistent =

[State 0, Turn]
type = Turn
trigger1 = facing != root,facing
ignorehitpause = 1
;persistent =

[State 13100, explosion sound]
type = playsnd
trigger1 = !time
value = 1000,0

[State 1061, End]
type = destroyself
trigger1 = animtime = 0

;Blitz static vanish
[Statedef 1034]
type    = A
movetype= A
physics = N
anim = 1034
sprpriority = 5
velset = 0,0
facep2 = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1002, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NT,ST,HT,NP,SP,HP
;value2 = S,NA
time = 1
;ignorehitpause =
;persistent =

[State 0, Turn]
type = Turn
trigger1 = facing != root,facing
ignorehitpause = 1
;persistent =

[State 0, PlaySnd] ;puff
type = PlaySnd
trigger1 = !time
value = 1030,1
volumescale = 255
ignorehitpause = 1
;persistent =

[State 1061, End]
type = destroyself
trigger1 = animtime = 0

;Blitz Fireball movement
[Statedef 1033]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1030
velset = 0,0
sprpriority = 10
facep2 = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 =  1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 1
ignorehitpause = 1
;persistent =

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "ROOT=%d | ID=%d | vel x=%f | FallenvID=%d | NumTarget=%d"
params = (root,ID), ID, gethitvar(xvel), gethitvar(fall.envshake.ampl), (root,NumTarget)
ignorehitpause = 1
;persistent =

[State 1061, Hitdef]
type = HitDef
trigger1 = root,ID=parent,ID ;spawned by Root
attr = S, SP
animtype  = hard
damage = ceil(ifElse(root,fvar(11) * 30< 7, 7, root,fvar(11) *30)),3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
affectteam = E
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1210,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -7.8,0
guard.velocity = -7.5
air.velocity = -5.8,-3
airguard.velocity = -5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= Cond((root,NumHelper(4750)=0),ifelse(p2movetype=H,40,140),0),Cond((root,NumHelper(4750)=0),10,0)
givepower = 35,35
;ID = 1030
persistent = 0
[State 1061, Hitdef]
type = HitDef
trigger1 = root,ID!=parent,ID ;spawned by Clone
attr = S, SP
animtype  = hard
damage = 7,3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
affectteam = E
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1210,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -7.8,0
guard.velocity = -7.5
air.velocity = -5.8,-3
airguard.velocity = -5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 0,0
;ID = 1030
persistent = 0

[State 0, HitAdd]
type = null;HitAdd
trigger1 = numtarget(1030)
value = 0
ignorehitpause = 1
;persistent = 0

[State 0, Offset]
type = Offset
trigger1 = Time >= 0
x = random%3
y = random%3
ignorehitpause = 1
;persistent =

[State 0, Turn]
type = Turn
trigger1 = facing != root,facing
ignorehitpause = 1
;persistent =

[State 0, DestroySelf]
type = DestroySelf
trigger1 = (pos x!=[-240,240])
;trigger2 = time>60
;ignorehitpause =
;persistent =

[State 1061, Fade]
type = changestate
trigger1 = time=1 ;movecontact
value = 1032
ignorehitpause=1
;persistent = 0

;Ballistic Kiss DUST
[Statedef 1110]
type = S
movetype = I
physics = N
ctrl = 0
anim = 17100
velset = 0,0
sprpriority = -4

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
scale = 0.75,0.75
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 =  root,pos Y<-10
flag = invisible
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = 1
x = root,pos X
ignorehitpause = 1
;persistent =


[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno!=1100
trigger1 = root,stateno!=186
ignorehitpause = 1
;persistent =

;TEMP Crossfire Helper
[Statedef 1210]
type    = S
movetype= A
physics = N
anim = 1010
sprpriority = 5
hitcountpersist = 1
movehitpersist = 1

[State 2311, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45
scale = 1,1
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 13100, launch sound]
type = playsnd
trigger1 = !time
value = 1000,1

[State 1061, Velocity]
type = VelSet
trigger1 = !Time
x = 4
y = 4

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = 1213
attr = SCA, AA, AP, AT
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = 1
attr = A, SP
animtype  = hard
;damage    = ceil(23*root,fvar(15)), ceil(3*root,fvar(15))
damage = ceil(ifElse(root,fvar(11) * (40+20*IsHelper(1211))< 7, 7, root,fvar(11) *(40+20*IsHelper(1211)))),(4+2*IsHelper(1211))
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
pausetime = 0,20 ;10;10
guard.pausetime = 0,10 ;10;10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = -1;s1210,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 25;20
ground.hittime  = 25 ;20
ground.velocity = -7.8,0
guard.velocity = -7.5
air.velocity = -5.8,-3
airguard.velocity = -5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= Cond((root,NumHelper(4750)=0),ifelse(p2movetype=H,40,140),0),Cond((root,NumHelper(4750)=0),10,0)
givepower = 35,35
persistent = 0

[State 1061, Velocity]
type = VelSet
trigger1 = Movehit
x = 0
y = 0

[State 3001, Guardshake]
type = envshake
trigger1 = moveguarded
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = (pos x!=[-240,240])
trigger2 = time>180

[State 1061, Fade]
type = changestate
trigger1 = movecontact
trigger2 =  pos Y>=-5
value = 1213
ignorehitpause=1

;TEMP Crossfire Vanish
[Statedef 1213]
type    = A
movetype= A
physics = N
anim = 1013
sprpriority = 5
velset = 0,0

[State 2311, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45
scale = 1,1
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1002, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 13100, explosion sound]
type = playsnd
trigger1 = !time
value = 1000,0

[State 1061, End]
type = destroyself
trigger1 = animtime = 0

;Crossfire pusher
[Statedef 1215]
physics = N
velset = 0, 0
anim = 1215

[State 3205, NHB]
type = nothitby
trigger1 = 1
time = -1
value = SCA

[State 3205, HitOverride]
type = hitoverride
trigger1 = 1
time = -1
attr = SCA, AA, AP, AT
stateno = 2212
ignorehitpause = 1

[State 3205, bound]
type = screenbound
trigger1 = 1
value = 0

[State 3205, Push]
type = playerpush
trigger1 = 1
value = 1

[State 3205, Pos]
type = posset
trigger1 = 1
y = 0

[State 3205, Vel]
type = null;velset
trigger1 = 1
x = 350.0 / (rootdist x + 50.0)

[State 3205, Pos]
type = posadd
trigger1 = 1
x = 1

[State 3205, End]
type = destroyself
trigger1 = IsHelper(1215) ;Normal
trigger1 = root,stateno!=[1200,1204]
trigger2 = IsHelper(1216) ;EX
trigger2 = parent,stateno!=[1260,1264]
trigger3 = IsHelper(1216) ;EX
trigger3 = root,stateno=1204



;======================================================================
; Repel helper : 1305
; Destroyed : 1306
; Reflect with random projectile : 1308
; Reflected projectile : 1315
; Reflected projectile explods : 1316
;======================================================================

; REPEL HELPER FOR Focus Attack
[Statedef 1305]
type = S
physics = N
movetype = A
ctrl = 0
sprpriority = 4

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
time = 1
facing = 0
pos = 50, -40
ignorehitpause = 1
;persistent =

[State 1305, nothitby]
type = nothitby
trigger1 = 1
time = -1
value = SCA
ignorehitpause = 1

[State 1305, HB]
type = hitby
trigger1 = 1
time = 1
value = SCA, NP, SP, HP
ignorehitpause = 1

[State 1305, HitOverride]
type = hitoverride
trigger1 = 1
time = -1
attr = SCA, AA, AP, AT
stateno = 1306
ignorehitpause = 1

[State 1305, HitOverride]
type = hitoverride
trigger1 = 1
time = -1
attr = SCA, NP, SP,HP
stateno = 1308
ignorehitpause = 1

[State 1305, Anim]
type = changeanim
trigger1 = anim != 1305
value = 1305

[State 1305, timevar]
type = varadd
trigger1 = 1
var(4) = 1

[State 1305, Shadows]
type = afterimage
trigger1 = !time && !prevstateno
time = 999
timegap = 1
framegap = 4
length = 12
palcontrast = 30, 60, 120
trans = add

[State 1305, Type]
type = statetypeset
trigger1 = movecontact
movetype = I

[State 1305, End]
type = changestate
trigger1 = var(4) >= 13
value = 1306

;-----------------------------------------
; Destroyed
[Statedef 1306]
type = A
physics = N
movetype = I
velset = 0, 0
ctrl = 0
sprpriority = 1
anim = 15998

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 1306, End]
type = destroyself
trigger1 = !animtime

;-----------------------------------------
; Reflect with projectile
[Statedef 1308]
type = A
physics = N
movetype = I
ctrl = 0
anim = 15998

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 1308, reflected]
type = helper
trigger1 = !time
stateno = 1315
ID = 1315
name = "Reflected"
postype = p1
pos = 25, -20
ownpal = 1
size.xscale = 1
size.yscale = 1

[State 1308, End]
type = changestate
trigger1 = 1
value = 1306   ;1305

;-----------------------------------------
; Reflected projectile Kamehameha
[Statedef 1315]
type=S
physics=N
movetype=A
ctrl=0
velset=0,0
sprpriority=4
poweradd = 100

[State 200, Ki goes SFX]
type = PlaySnd
trigger1 = !time
value = 10,0
channel = 1

[State -2, Explod];P1 Side.
type = Explod
trigger1 = !time && numexplod(13300)=0 && teamside = 1
anim = 13300
pos = 10,80
postype = left  ;p2,front,back,left,right
removetime = -2
;scale = 0.5,0.5
sprpriority = 0
id = 13300
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = -1
persistent = 0

[State -2, Explod];P2 Side.
type = Explod
trigger1 = !time && numexplod(13300)=0 && teamside = 2
anim = 13301
pos = -169,80
postype = right
removetime = -2
;scale = 0.5,0.5
sprpriority = 0
id = 13300
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = -1
persistent = 0

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1315, HitOverride]
type=hitoverride
trigger1= 1
time=-1
attr=SCA,AA,AP,AT
stateno=1316
ignorehitpause=1

[State 1315, HB]
type=hitby
trigger1= 1
time=-1
value=SCA,NP,SP,HP
ignorehitpause=1

[state 1315]
type = varset
triggerall = numenemy
triggerall = enemy,authorname = "Balthazar & Cybaster"
trigger1 = enemy,name = "Goku Z2"
trigger2 = enemy,name = "SSJ Goku Z2"
trigger3 = enemy,name = "Vegeta Z2"
trigger4 = enemy,name = "Gohan Z2"
var(11) = 1

[State 1315, Anim];normal kamehameha FX (yellow/blue)
type=changeanim
trigger1= !time && !prevstateno && var(11)=0 && root,var(44)=0
value=1311
[State 1315, Anim];normal kamehameha FX (old purple)
type=changeanim
trigger1= !time && !prevstateno && var(11)=0 && root,var(44)>=1
value=1310
[State 1315, Anim];Vegeta kamehameha FX
type=changeanim
trigger1= !time && !prevstateno && var(11)=1
value=1010

[State 1315, Vel]
type=velset
trigger1= 1
x = 8

[State 1315, image]
type=afterimage
trigger1= !time && !prevstateno
time=999
timegap=1
framegap=2
length=5
palcontrast=50,50,200
trans=add

[State 1315, Hit]
type=hitdef
trigger1= 1
priority=4,Hit
attr = S,SP
damage = ceil(61*root,fvar(12)), ceil(6*root,fvar(12))
animtype = Hard
hitflag = MAF
guardflag=MA
pausetime=0,10
sparkno = -1
guard.sparkno = -1
sparkxy = -10,0
hitsound  = S999,0
guardsound = S6,1
ground.type=High
ground.slidetime=16
ground.hittime=16
ground.velocity=-10,0
ground.cornerpush.veloff=0
air.velocity=-4,-2
getpower= Cond((root,NumHelper(4750)=0),ifelse(p2movetype=H,40,140),0),Cond((root,NumHelper(4750)=0),35,0)
givepower = 35,35
envshake.time=14
envshake.freq=120
envshake.ampl=4
air.fall=1
fall.recover=1
fall.recovertime=16
yaccel=.5
airguard.ctrltime= 16
airguard.velocity= -8, -1.5
forcestand=1
p1sprpriority = 5

[State 1315, Sparks]
type=explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim=7020
sprpriority=3
postype=p2
pos=(target,const(size.ground.front)-10),-floor(p2dist y)
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
persistent=0
pausemovetime=100
supermovetime=100

[State 1315, End]
type=changestate
trigger1= movecontact
value=1316
ignorehitpause=1

[State 1315, End]
type=destroyself
trigger1=pos x!=[-200,200]

;-----------------------------------------
; Kamehameha explod/vanish
[Statedef 1316]
type=A
physics=N
movetype=I
velset=0,0
ctrl=0
sprpriority=4

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 3005, anim];VS Z2 chars
type = changeanim
trigger1 = !time && var(11)=1
value = 1013
[State 3005, anim];Repel (old)
type = changeanim
trigger1 = !time && var(11)=0 && prevstateno=1315 && root,var(44)>=1
value = 1316
[State 3005, anim];Repel (yellow/blue)
type = changeanim
trigger1 = !time && var(11)=0 && prevstateno=1315 && root,var(44)=0
value = 1311

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1316, End]
type=destroyself
trigger1= !animtime

;Blitz Deadend Fireball
[Statedef 1540]
type    = S
movetype= A
physics = N
anim = 1031 ;1030
hitcountpersist = 1
movehitpersist = 1
;facep2 = 1

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "spawned by root? = %d | dampener = %f | Roothitcount=%d | Heleprhitcount=%d"
params = (root,Id=parent,Id),(root,fvar(11) * 15), (root,hitcount), hitcount
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 0, bounce]
type = HitOverride
trigger1 = Time >= 0
slot = 1
stateno = 1032
attr = SCA, NA, SA, HA, NP, SP, HP
time = 1

[State 0, Offset]
type = Offset
trigger1 = Time >= 0
x = random%3
y = random%3
;ignorehitpause =
;persistent =

[State 0, BindToRoot] ;LP
type = BindToParent
triggerall = !time
trigger1 = parent,stateno=1501
time = 4
pos = 49,-77
ignorehitpause = 1
;persistent =

[State 0, BindToRoot] ;SP
type = BindToParent
triggerall = !time
trigger1 = parent,stateno=1521
time = 4
pos = 75,-77
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
triggerall = parent,stateno!=1511
trigger1 = !time
x = 4 ;2*abs(parent,vel X) ;to change
ignorehitpause = 1
;persistent =

[State 0, VelSet] ;LP
type = null;VelSet
triggerall = parent,stateno=1501
trigger1 = !time
x = 4.5; 2*abs(parent,vel X) ;to change
ignorehitpause = 1
;persistent =

[State 0, VelSet] ;MP
type = VelSet
triggerall = parent,stateno=1511
trigger1 = !time
x = 3.5 ;to change
ignorehitpause = 1
;persistent =

[State 0, VelSet] ;SP
type = null;VelSet
triggerall = parent,stateno=1521
trigger1 = !time
x = 4.5 ;2*abs(parent,vel X) ;to change
ignorehitpause = 1
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = 1030,0

[State 0, SprPriority]
type = SprPriority
trigger1 = time<5
value = IfElse(IsHelper(1540),-5,5)
ignorehitpause = 1
;persistent =

[State 0, SprPriority]
type = SprPriority
trigger1 = time>=5
value = 0
ignorehitpause = 1
;persistent =

[State 1061, Hitdef]
type = HitDef
trigger1 = root,ID=parent,ID ;spawned by Root
attr = S, SP
animtype  = hard
damage = ceil(ifElse((root,fvar(11)*15)< 7, 7, (root,fvar(11)*15))),2
priority  = 4,Hit
guardflag = MA
hitflag = MAF;LD
affectteam = E
pausetime = 0,15
guard.pausetime = 0,20-15*IsHelper(1542) ;10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1210,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 5
ground.hittime  = 20
ground.velocity = -2,0
guard.velocity = -2.5
air.velocity = -3.8,-3
airguard.velocity = -3, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= Cond((root,NumHelper(4750)=0),ifelse(p2movetype=H,40,140),0),Cond((root,NumHelper(4750)=0),10,0)
givepower = 35,35
;ID = 1030
persistent = 0
[State 1061, Hitdef]
type = HitDef
trigger1 = root,ID!=parent,ID ;spawned by Clone
attr = S, SP
animtype  = hard
damage = 7,2
priority  = 4,Hit
guardflag = MA
hitflag = MAF;LD
affectteam = E
pausetime = 0,15
guard.pausetime = 0,20-15*IsHelper(1542) ;10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1210,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 5
ground.hittime  = 20
ground.velocity = -2,0
guard.velocity = -2.5
air.velocity = -3.8,-3
airguard.velocity = -3, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 0,0
;ID = 1030
persistent = 0

[State 0, Projectile]
type = null;Projectile
trigger1 = movecontact ;MoveHit = 1
ProjID = 91540
projanim = 15999
projremovetime = 2 ;30 ;15
ignorehitpause=1

[State 0, VarAdd] ; cancel
type = ParentVarSet
trigger1 = root,ID=parent,ID ;spawned by Root
trigger1 = movecontact ;
var(40)=1540
ignorehitpause = 1
persistent = 0


[State 0, VarAdd]
type = null ;ParentVarAdd
trigger1 = MoveHit = 1
fvar(13) = 8

[State 0, ChangeState]
type = ChangeState
trigger1 =  movecontact
value = 1032
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

[State 3001, Guardshake]
type = envshake
trigger1 = moveguarded
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = (pos x!=[-240,240])
trigger2 = time>180

;Cascade LP Crater
[Statedef 3140]
type    = A
movetype= I
physics = N
anim = 3178
sprpriority = -6
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumHelper(3150)
trigger1 = Helper(3150),Anim=3151
trigger1 = Anim=3178
trigger2 = root,movetype=H
value = 3179
ignorehitpause = 1
persistent = 0

[State 1061, End]
type = destroyself
trigger1 = Anim=3179
trigger1 = !animtime

;Cascade LP shield
[Statedef 3150]
type    = S
movetype= A
physics = N
anim = 3150
sprpriority = 5
hitcountpersist = 1
movehitpersist = 1

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
time = 1
;facing = 0
pos = 3,-24
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = Time >= 0
attr = S, HP
animtype  = hard
;damage = 7,7
damage = ceil(ifElse(root,fvar(11) * 7 < 3, 3, root,fvar(11) * 7)), 3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s3150,1 ;s1000,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -7.8,0
guard.velocity = -7.5
air.velocity = -5.8,-3
airguard.velocity = -5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
sprpriority = 5
getpower = 0,0
givepower = 20,20
persistent = 0

[State 0, VarAdd]
type = ParentVarAdd
trigger1 = MoveHit = 1
fvar(13) = 1

[State 0, Projectile]
type = Projectile
trigger1 = MoveHit = 1
ProjID = 3000
projanim = 15999
projremovetime = 1
ignorehitpause=1

[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno=3102
trigger2 = root,movetype=H
value = 3151
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;Cascade LP shield vanish
[Statedef 3151]
type    = S
movetype= I
physics = N
anim = 3151
sprpriority = 5
hitcountpersist = 1
movehitpersist = 1

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
time = 1
;facing = 0
pos = 3,-24
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
trigger1 = root,movetype=H
value = 3151
elem = 3
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = !animtime

;Cascade LP pillar
[Statedef 3155]
type    = S
movetype= A
physics = N
anim = 3155
sprpriority = -6
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = 3150,0
channel = 5
ignorehitpause = 1
;persistent =

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, Explod Mid]
type = Explod
trigger1 = !NumExplod(3157)
trigger1 = time=8
anim = 3157
ID =3157
pos = 0,-50 ;-55
postype = p1
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -1
pausemovetime=0 ;100
supermovetime=0 ;100
scale = 1,8
sprpriority = -7
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 1
ignorehitpause = 1
;trans =
;persistent =

[State 0, Explod Top]
type = Explod
trigger1 = !NumExplod(3158)
trigger1 = time=8
anim = 3158
ID =3158
pos = 0,-120 ;-125
postype = p1
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -1
pausemovetime=0;100
supermovetime=0;100
scale = 1,1
sprpriority = -6
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 1
ignorehitpause = 1
;trans =
;persistent =

[State 1061, Hitdef]
type = HitDef
trigger1 = Time >= 0
trigger1 = time%10=0
attr = S, HP
animtype  = Up
damage = ceil(ifElse(root,fvar(11) * 30< 3, 3, root,fvar(11) *30)),3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
pausetime = 0,2;+8*(hitcount>3)
sparkno = -1 ;s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s3150,1 ;s1000,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 10
ground.hittime  = 10
ground.velocity = -1.8,-6.8
guard.velocity = -1.5
air.velocity = -0.5,-5-4*(root,var(3)!=0) ;-1,-5.8;-4*(hitcount>3)
airguard.velocity = -1, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.35
fall = 1
air.animtype = back
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
sprpriority = -5
getpower = 0,0
givepower = 20,20
;persistent = 0

[State 0, VarAdd]
type = ParentVarAdd
trigger1 = MoveHit = 1
fvar(13) = 1

[State 0, Projectile]
type = Projectile
trigger1 = MoveHit = 1
ProjID = 3000
projanim = 15999
projremovetime = 1
ignorehitpause=1

[State 3302, Sparks]
type=explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim=7020
sprpriority=7
postype=p2
pos=(target,const(size.ground.front)-2),-62 ;-77;floor(p2dist y)
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
;persistent=0
pausemovetime=100
supermovetime=100

[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno=3102
trigger2 = root,movetype=H
value = 3156
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;Cascade LP pillar vanish
[Statedef 3156]
type    = S
movetype= I
physics = N
anim = 3156
sprpriority = 5
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 0, RemoveExplod Mid]
type = RemoveExplod
trigger1 = !time
id = 3157
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod Top]
type = RemoveExplod
trigger1 = !time
id = 3158
ignorehitpause = 1
;persistent =

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, ChangeState] ; Combo keeper
type = ChangeState
triggerall = root,var(3)=3110 || root,var(3)=3120
trigger1 = !animtime
value = 3191
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

[State 1061, End]
type = destroyself
triggerall = root,var(3)!=3110 && root,var(3)!=3120
trigger1 = !animtime


;Cascade MP Tail
[Statedef 3160]
type    = A
movetype= A
physics = N
anim = 3160
sprpriority = -4
hitcountpersist = 1
movehitpersist = 1

[State 0, PosSet] ;lock position
type = PosSet
trigger1 = 1
x = root,pos X-19*(root,facing)
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = 3150,0
channel = 5
ignorehitpause = 1
;persistent =


[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno=3112
trigger2 = root,movetype=H
value = 3165
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;Cascade MP Mid
[Statedef 3161]
type    = A
movetype= A
physics = N
anim = 3171
sprpriority = -4
hitcountpersist = 1
movehitpersist = 1

[State 0, PosSet] ;lock position
type = PosSet
trigger1 = 1
x = root,pos X-19*(root,facing)
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, Scale Tracker Y]
type = Varadd
triggerall = NumHelper(3162)
trigger1 = Helper(3162),Anim=3162
fvar(2) = (time/2.0)
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = 1,1.1*(fvar(2)/2.0)
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = NumHelper(3160)
y = (Helper(3160),pos y)-15-4.95*fvar(2)
ignorehitpause = 1
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno=3112
trigger2 = root,movetype=H
value = 3166
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;Cascade MP Head
[Statedef 3162]
type    = A
movetype= A
physics = N
anim = 3162
sprpriority = -3
hitcountpersist = 1
movehitpersist = 1

[State 0, PosSet] ;lock position
type = PosSet
trigger1 = 1
x = root,pos X-19*(root,facing)
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = NumHelper(3161)
y = (Helper(3161),pos y)
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno=3112
trigger2 = root,movetype=H
value = 3167
ctrl = 0
;anim =
;ignorehitpause =
;persistent =


;Cascade MP Tail vanish
[Statedef 3165]
type    = A
movetype= I
physics = N
anim = 3165
sprpriority = -4
hitcountpersist = 1
movehitpersist = 1

[State 0, PosSet] ;lock position
type = PosSet
trigger1 = 1
x = root,pos X-19*(root,facing)
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = !animtime
trigger2 = root,movetype=H

;Cascade MP Mid vanish
[Statedef 3166]
type    = A
movetype= I
physics = N
anim = 3166
sprpriority = -4
hitcountpersist = 1
movehitpersist = 1

[State 0, PosSet] ;lock position
type = PosSet
trigger1 = 1
x = root,pos X-19*(root,facing)
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, PosSet];offset correction
type = PosSet
trigger1 = !time
trigger1 = NumHelper(3160)
y = (Helper(3160),pos y)-30
ignorehitpause = 1
;persistent =

[State 0, AngleDraw] ;1st frame Scaling hack fix
type = AngleDraw
trigger1 = !time
value = 0
scale = 1,0.02
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time>0
value = 0
scale = 1,8
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = !animtime
trigger2 = root,movetype=H

;Cascade MP Head vanish
[Statedef 3167]
type    = A
movetype= I
physics = N
anim = 3167
sprpriority = -3
hitcountpersist = 1
movehitpersist = 1

[State 0, PosSet] ;lock position
type = PosSet
trigger1 = 1
x = root,pos X-19*(root,facing)
ignorehitpause = 1
;persistent =


[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, PosSet];offset correction
type = PosSet
trigger1 = !time
trigger1 = NumHelper(3160)
y = (Helper(3160),pos y)-100
ignorehitpause = 1
;persistent =

[State 1061, End]
type = destroyself
trigger1 = !animtime
trigger2 = root,movetype=H

;Cascade MP Damage
[Statedef 3169]
type    = A
movetype= A
physics = N
anim = 3169
sprpriority = 1
hitcountpersist = 1
movehitpersist = 1

[State 0, PosSet] ;lock position
type = PosSet
trigger1 = 1
x = root,pos X-19*(root,facing)
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = Time >= 0
trigger1 = time%10=0
attr = S, HP
animtype  = Up
damage = ceil(ifElse(root,fvar(11) * 30< 3, 3, root,fvar(11) *30)),3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
pausetime = 0,2
sparkno = -1 ;s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s3150,1 ;s1000,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 10
ground.hittime  = 10
ground.velocity = -1.8,-6.8
guard.velocity = -1.5
air.velocity = -1,-5.8
airguard.velocity = -1, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
fall = 1
air.animtype = back
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
sprpriority = -5
getpower = 0,0
givepower = 20,20
;persistent = 0

[State 0, VarAdd]
type = ParentVarAdd
trigger1 = MoveHit = 1
fvar(13) = 1

[State 0, Projectile]
type = Projectile
trigger1 = MoveHit = 1
ProjID = 3000
projanim = 15999
projremovetime = 1
ignorehitpause=1

[State 3302, Sparks]
type=explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim=7020
sprpriority=7
postype=p2
pos=(target,const(size.ground.front)-10),-62 ;-77;floor(p2dist y)
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
;persistent=0
pausemovetime=100
supermovetime=100

[State 0, ChangeState] ; Combo keeper
type = ChangeState
triggerall = root,var(3)=3120
trigger1 = root,movetype=H
trigger2 = NumHelper(3160)
trigger2 = Helper(3160),Anim=3165
value = 3191
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

[State 0, DestroySelf]
type = DestroySelf
triggerall = root,var(3)!=3120
trigger1 = root,movetype=H
trigger2 = NumHelper(3160)
trigger2 = Helper(3160),Anim=3165
ignorehitpause = 1
;persistent =

;Cascade SP Tail
[Statedef 3170]
type    = A
movetype= A
physics = N
anim = 3170
sprpriority = -4
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = 3150,0
channel = 5
ignorehitpause = 1
;persistent =

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno=3122
trigger2 = root,movetype=H
value = 3175
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;Cascade SP Mid
[Statedef 3171]
type    = A
movetype= A
physics = N
anim = 3171
sprpriority = -4
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, Scale Tracker Y]
type = VarSet
triggerall = NumHelper(3172)
trigger1 = Helper(3172),Anim=3172
fvar(2) = (time/2.0)
ignorehitpause = 0
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = 1,2+fvar(2)
ignorehitpause = 0
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno=3122
trigger2 = root,movetype=H
value = 3176
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;Cascade SP Head
[Statedef 3172]
type    = A
movetype= A
physics = N
anim = 3172
sprpriority = -3
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, PosAdd]
type = PosAdd
triggerall = NumHelper(3171)
trigger1 = pos y<-30
y = Helper(3171),fvar(2) ;(time/2.0)
ignorehitpause = 1
;persistent =

[State 1000, cascade Crater]
type = Helper
triggerall = !NumHelper(3178)
trigger1 = Anim=3172
trigger1 = pos y>=-30
helpertype = normal
name = "Cascade Crater"
postype = P1
pos = 0,35
facing = 1
ownpal = 1
supermovetime = 0;9999
pausemovetime = 0;9999
stateno = 3178
id = 3178

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = NumHelper(3171)
trigger1 = Anim=3172
trigger1 = pos y>=-30
value = 3173
elem = Helper(3171),Animelemtime(0)+3 ;1
ignorehitpause = 1
persistent = 0

[State 0, PosAdd]
type = PosSet
trigger1 = Anim=3173
y = 5
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno=3122
trigger2 = root,movetype=H
value = 3177
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;Cascade SP Tail vanish
[Statedef 3175]
type    = A
movetype= I
physics = N
anim = 3175
sprpriority = -4
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = !animtime
trigger2 = root,movetype=H

;Cascade SP Mid vanish
[Statedef 3176]
type    = A
movetype= I
physics = N
anim = 3176
sprpriority = -4
hitcountpersist = 1
movehitpersist = 1

[State 0, PosAdd] ;TEMP
type = null;PosAdd
trigger1 = !Time
x = 50
;ignorehitpause =
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AngleDraw] ;1st frame Scaling hack fix
type = AngleDraw
trigger1 = !time
value = 0
scale = 1,0.8
ignorehitpause = 0
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time>0 ;1
value = 0
scale = 1,0.8+fvar(2)
ignorehitpause = 0
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = !animtime
trigger2 = root,movetype=H

;Cascade SP Head vanish
[Statedef 3177]
type    = A
movetype= I
physics = N
anim = 3177
sprpriority = -3
hitcountpersist = 1
movehitpersist = 1

[State 0, PosSet]
type = null;PosSet
trigger1 =  !time
y = root,pos Y-20
;ignorehitpause =
;persistent =

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 0, PosSet];offset correction
type = PosSet
trigger1 = !time
trigger1 = NumHelper(3170)
y = (Helper(3170),pos y)+93
ignorehitpause = 1
;persistent =

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = !animtime
trigger2 = root,movetype=H

;Cascade SP Crater
[Statedef 3178]
type    = A
movetype= I
physics = N
anim = 3178
sprpriority = -6
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumHelper(3172)
trigger1 = Helper(3172),Anim=3177
trigger1 = Anim=3178
trigger2 = root,movetype=H
value = 3179
ignorehitpause = 1
persistent = 0

[State 1061, End]
type = destroyself
trigger1 = Anim=3179
trigger1 = !animtime

;Cascade SP Damage
[Statedef 3180]
type    = A
movetype= A
physics = N
anim = 3180
sprpriority = 1
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = Time >= 0
trigger1 = time%10=0
attr = A, HP
animtype  = back ;Hard
damage = ceil(ifElse(root,fvar(11) * 32< 3, 3, root,fvar(11) *32)),3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
pausetime = 0,2
sparkno = -1 ;s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s3150,1 ;s1000,0
guardsound = S6,1
ground.type = low
air.type = low
ground.slidetime = 10
ground.hittime  = 10
ground.velocity = 0,-0.8;-1.8,-0.8
guard.velocity = 0;-1.5
air.velocity = 0,0 ;0,0.8;-1,0.8
airguard.velocity = 0,0 ;0,0.8;-1, 0.8
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
fall = 1
air.animtype = hard;back;back;back
fall.animtype = hard;back;back;hard;Up
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
sprpriority = -5
getpower = 0,0
givepower = 20,20
;persistent = 0

[State 0, TargetState]
type = TargetState
triggerall = numtarget
trigger1 = target,stateno!=3195
trigger1 = target,statetype=L;movehit
value = 3195
ID = -1
ignorehitpause = 1
;persistent =


[State 0, TargetVelSet]
type = TargetVelSet
triggerall = numtarget
trigger1 = target,stateno!=3195
trigger1 = target,time=1
trigger1 = movehit
x = 0
y = 0.8
ID = -1
ignorehitpause = 1
;persistent =


[State 0, VarAdd]
type = ParentVarAdd
trigger1 = MoveHit = 1
fvar(13) = 1

[State 0, Projectile]
type = Projectile
trigger1 = MoveHit = 1
ProjID = 3000
projanim = 15999
projremovetime = 1
ignorehitpause=1

[State 3302, Sparks]
type=explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim=7020
sprpriority=7
postype=p2
pos=(target,const(size.ground.front)-10),-62 ;-77;floor(p2dist y)
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
;persistent=0
pausemovetime=100
supermovetime=100

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,movetype=H
trigger2 = NumHelper(3170)
trigger2 = Helper(3170),Anim=3175
ignorehitpause = 1
;persistent =

;---------------------------------------------------------------------------
; Cascade P2 Downed get-hit (shaking)
[Statedef 3195]
type    = L
movetype= H
physics = N
velset = 0,0

[State 5080, 3]
type = ChangeAnim
trigger1 = !time
value = 5100
ignorehitpause = 1

[State 5080, 4]
type = SelfState
trigger1 = !animtime
value = 5110
ignorehitpause = 1

; Cascade - No Push Dummy
[Statedef 3190]
ctrl = 0
hitcountpersist = 1
movehitpersist = 1

[State 1216, ChangeAnim]
type = ChangeAnim
trigger1 = SelfAnimExist(Parent,Anim); 1
value = Parent, Anim
elem = Parent, AnimElemNo(0)

[State 1216, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 1216, BindToParent]
type = BindToParent
trigger1 = !Time
time = -1
facing = 1

[State 1216, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
flag2 = Invisible

[State 1216, NotHitBy]
type = NotHitBy
trigger1 = !Time
value = SCA
time = -1

[State 1216, Remove]
type = DestroySelf
trigger1 = IsHelper(3190) ;Cascade
trigger1 = Parent, StateNo != [3100,3102]
trigger2 = IsHelper(3390) ;Power Breaker
trigger2 = Parent, StateNo != [3300,3302]

; Cascade - Combo keeper
[Statedef 3191]
anim = 9999
ctrl = 0
hitcountpersist = 1
movehitpersist = 1

[State 1216, NotHitBy]
type = NotHitBy
trigger1 = !Time
value = SCA
time = -1

[State 1216, Remove]
type = DestroySelf
trigger1 = root, StateNo != [3100,3122]

;IB BEAMS
[Statedef 3230]
type    = A
movetype= A
physics = N
sprpriority = 5
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, PlayerPush]
type = PlayerPush
trigger1 =  1
value = 0
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 3224+Ishelper(3225)+2*Ishelper(3226)+3*Ishelper(3227)+4*Ishelper(3228)+5*Ishelper(3229)
;elem = 1
ignorehitpause = 1
;persistent =

[State 13100, launch sound]
type = playsnd
trigger1 = !time
value = 1000,1 ;3350,1 ;1000,1
volumescale = 15

[State 1061, Velocity A]
type = VelSet
trigger1 = IsHelper(3225)
trigger1 = !Time
x = 6*cos(90*Pi/180.0)
y = 6*sin(90*Pi/180.0)
[State 1061, Velocity B]
type = VelSet
trigger1 = IsHelper(3226)
trigger1 = !Time
x = 6*cos(72*Pi/180.0)
y = 6*sin(72*Pi/180.0)
[State 1061, Velocity C]
type = VelSet
trigger1 = IsHelper(3227)
trigger1 = !Time
x = 6*cos(38*Pi/180.0)
y = 6*sin(38*Pi/180.0)
[State 1061, Velocity D]
type = VelSet
trigger1 = IsHelper(3228)
trigger1 = !Time
x = 6*cos(14*Pi/180.0)
y = 6*sin(14*Pi/180.0)
[State 1061, Velocity E]
type = VelSet
trigger1 = IsHelper(3229)
trigger1 = !Time
x = 6*cos(0*Pi/180.0)
y = 6*sin(0*Pi/180.0)

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT, NP, SP, HP
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = 1
attr = A, HP
animtype  = light
damage = ceil(ifElse(root,fvar(11) * 6 < 3, 3, root,fvar(11) * 6)), 3
;damage =  6,0
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
pausetime = 0,11
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = -1 ;s3220,1;s1210,0
guardsound = -1 ;S6,1
ground.type = high
air.type = low
ground.slidetime = 2;20
ground.hittime  = 2 ;20
ground.velocity = -1.8,0
guard.velocity = -1.5
air.velocity = -0.8,-3
airguard.velocity = -0.5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
fall = (root,var(3)>5)
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 35,35
persistent = 0

[State 0, TargetState]
type = TargetState
trigger1 = numtarget
trigger1 = MoveHit
value = 3231
ID = -1
ignorehitpause = 1
persistent = 0

[State 0, ParentVarAdd]
type = ParentVarAdd
trigger1 = movehit
var(3) = 1
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = ParentVarAdd
trigger1 = MoveHit = 1
fvar(13) = 1

[State 0, Projectile]
type = Projectile
trigger1 = MoveHit = 1
ProjID = 3000
projanim = 15999
projremovetime = 1
ignorehitpause=1

[State 13100, hit sound]
type = playsnd
trigger1 = movehit
value = 3220,1
volumescale = 30
persistent = 0
[State 13100, guardsound]
type = playsnd
trigger1 = moveguarded
value = 6,1
volumescale = 20
persistent = 0

[State 3001, Guardshake]
type = envshake
trigger1 = moveguarded
time = 4
ampl = 6
freq = 80 ;176
ignorehitpause = 1
persistent = 0

[State 1061, End]
type = destroyself
trigger1 = time>60

;PB_BEAM HELPER
[Statedef 3351]
type = A
physics = N
movetype = A
anim = 9999
ctrl = 0
sprpriority = 1
hitcountpersist = 1
movehitpersist = 1

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
;time = 1
;facing = 0
pos = 0,0
;ignorehitpause =
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = 3350,1
volumescale = 255
channel = 1
lowpriority = 1
;abspan =
;ignorehitpause =
;persistent =

[State 3000, Breaker Beam Tail]
type = helper
trigger1 = !time
helpertype = normal
stateno = 3352
ID = 3352+20000*(Ishelper(23351))
name = "breaker tail"
postype = p1
pos = 0,0
ownpal = 1

[State 3000, Breaker Beam Damage]
type = helper
trigger1 = !time
helpertype = normal
stateno = 3353
ID = 3353+20000*(Ishelper(23351))
name = "Breaker damage"
postype = p1
pos = 80,-77 ;0,0
ownpal = 1

[State 0, VarSet]
type = VarSet
trigger1 = IsHelper(3351)
trigger1 = NumHelper(3353)
var(1) = ceil(abs(ScreenPos X - helper(3353),ScreenPos X))
ignorehitpause = 1
;persistent =

[State 0, VarSet]
type = VarSet
trigger1 = IsHelper(23351)
trigger1 = NumHelper(23353)
var(1) = ceil(abs(ScreenPos X - helper(23353),ScreenPos X))
ignorehitpause = 1
;persistent =


[State 0, Scale Tracker X]
type =null; VarAdd
triggerall = var(1)<30
trigger1 = NumHelper(3353)
trigger1 = Helper(3353),vel x>0
trigger2 = root,vel x<0
trigger2 = (root,BackEdgeDist>30) ;|| (root,AnimElemTime(5)<30)
;trigger2 = rootdist x<30
var(1) = 1
ignorehitpause = 0
;persistent =

[State 0, Scale Tracker Y]
type = VarAdd
triggerall = var(2)<10
triggerall = IsHelper(3351)
trigger1 = NumHelper(3353)
trigger1 = Helper(3353),var(2)>=(Helper(3353),var(3)) ;total hits
trigger2 = time>250 ;not hitting
var(2) = 1
ignorehitpause = 0
;persistent =

[State 0, Scale Tracker Y]
type = VarAdd
triggerall = var(2)<10
triggerall = IsHelper(23351)
trigger1 = NumHelper(23353)
trigger1 = Helper(23353),var(2)>=(Helper(23353),var(3)) ;total hits
trigger2 = time>250 ;not hitting
var(2) = 1
ignorehitpause = 0
;persistent =

[State -2, Explosion]
type = Explod
triggerall = !NumExplod(3570)
triggerall = NumHelper(3353)
triggerall = IsHelper(3351)
trigger1 = var(2)>1
ID = 3570
anim = 3570
pos = ceil(Helper(3353),ScreenPos X)+30,ceil(Helper(3353),ScreenPos Y) ;0,0
postype = left ;p1
velocity = 0, 0
accel = 0, 0
bindtime = 1
removetime =-2
sprpriority =10
ignorehitpause = 1
persistent = 0
facing =1
[State -2, Explosion]
type = Explod
triggerall = !NumExplod(3570)
triggerall = NumHelper(23353)
triggerall = IsHelper(23351)
trigger1 = var(2)>1
ID = 3570
anim = 3570
pos = ceil(Helper(23353),ScreenPos X)+30,ceil(Helper(23353),ScreenPos Y) ;0,0
postype = left ;p1
velocity = 0, 0
accel = 0, 0
bindtime = 1
removetime =-2
sprpriority =10
ignorehitpause = 1
persistent = 0
facing =1

[State 10500, snd]
type = playsnd
triggerall = NumExplod(3570)
trigger1 = !win
value = 3560,2
persistent = 0

[State 1061, End]
type = destroyself
trigger1 = var(2)>=10
trigger2 = root,movetype=H
trigger3 = time>260 ;260 ;not hitting

;PB_BEAM Tail
[Statedef 3352]
type = A
physics = N
movetype = I
anim = 3351
ctrl = 0
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
;flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1


[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
;facing = 0
pos = 32,-77
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = IsHelper(3352)
trigger1 = NumHelper(3351)
;trigger1 = NumHelper(2312)
;trigger1 = Helper(2312),var(2)>=7
value = 0
scale = 1,1-(Helper(3351),var(2))/10.0
ignorehitpause = 0
;persistent =
[State 0, AngleDraw]
type = AngleDraw
trigger1 = IsHelper(23352)
trigger1 = NumHelper(23351)
;trigger1 = NumHelper(2312)
;trigger1 = Helper(2312),var(2)>=7
value = 0
scale = 1,1-(Helper(23351),var(2))/10.0
ignorehitpause = 0
;persistent =

[State 1061, End]
type = destroyself
trigger1 = IsHelper(3352)
trigger1 = !NumHelper(3351)
[State 1061, End]
type = destroyself
trigger1 = IsHelper(23352)
trigger1 = !NumHelper(23351)


;PB_BEAM Damage
[Statedef 3353]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 1
hitcountpersist = 1
movehitpersist = 1

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "Root=%d | Kame=%d | DistX=%d | var(1)=%d | AElem=%d | Target2310: %d"
params = (root,pos X),pos X, abs((root,pos X)-pos X), var(1),-10+floor(abs((root,pos X)-pos X)/7), numtarget(2310)
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1 ;!time
value = 3353
elem = IFElse((floor(abs((root,pos X)-pos X)/7)-10)<=0,1,floor(abs((root,pos X)-pos X)/7)-10);var(1)
ignorehitpause = 1
;persistent =

[State 0, total hits]
type = VarSet
trigger1 = !time
var(3) = 15 ;define total number of hits
ignorehitpause = 1
;persistent =

[State 0, Capture Anim]
type = VarSet
triggerall = !NumProjID(3590)
trigger1 = 1 ;movecontact
var(1) = AnimElemno(0)
ignorehitpause = 1
;persistent =

[State 3000, Gackt Beam Body]
type = helper
triggerall = IsHelper(3353)
trigger1 = !NumHelper(3354)
trigger1 = !time;=4
helpertype = normal
stateno = 3354
ID = 3354
name = "gackt body"
postype = p1
pos = 30,0
ownpal = 1
[State 3000, Gackt Beam Body]
type = helper
triggerall = IsHelper(23353)
trigger1 = !NumHelper(23354)
trigger1 = !time;=4
helpertype = normal
stateno = 3354
ID = 23354
name = "gackt body 2"
postype = p1
pos = 30,0
ownpal = 1

[State 3000, Gackt Beam tip]
type = helper
triggerall = IsHelper(3353)
trigger1 = !NumHelper(3355)
trigger1 = !time;=4
helpertype = normal
stateno = 3355
ID = 3355
name = "gackt tip"
postype = p1
pos = 30,0
ownpal = 1
[State 3000, Gackt Beam tip]
type = helper
triggerall = IsHelper(23353)
trigger1 = !NumHelper(23355)
trigger1 = !time;=4
helpertype = normal
stateno = 3355
ID = 23355
name = "gackt tip 2"
postype = p1
pos = 30,0
ownpal = 1

[State 0, VelSet]
type = VelAdd
trigger1 = FrontEdgeDist > 40
x = 2 ;0.2
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = FrontEdgeDist <= 40
x = 0
;ignorehitpause =
;persistent =

[State 0, StateTypeSet] ;buu fix
type = StateTypeSet
trigger1 = enemy,name = "Buu Z2"
trigger1 = enemy,stateno=301
movetype = I        ;I,A,H
ignorehitpause = 1
;persistent =

[State 3005, hit]
type = hitdef
;triggerall = !NumProjID(3590)
triggerall = IsHelper(3353)
trigger1 = NumHelper(3353)
trigger1 = var(2)<(Helper(3353),var(3))  ; ;7
attr = A,HP
hitflag = MAF;D
guardflag = MA
priority = 7,Hit
damage = 14,3 ;ceil(13*root,fvar(12)), 3
getpower = 0,0
givepower = 20,20
pausetime = 1,1 ;4,4 ; 5,10
animtype = Heavy ;Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 4 ;16
ground.slidetime = 4 ;16
guard.hittime = 4 ;16
air.hittime = 4 ;13
airguard.ctrltime = 16
ground.velocity= -5,0
guard.velocity = -9
air.velocity = -5.5,-8 ;-3.9-6*(ifElse(root,Facing = 1, (root,NumExplod(90030016) || root,NumExplod(90030003)),(root,NumExplod(90030101) || root,NumExplod(90030114)))); -7*(root,var(3)=3320)
airguard.velocity = -5.5, -1.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = -1
;hitsound   = s1000,0
guardsound = S6,1
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
;forcestand = 1
;palfx.sinadd=64,64,64,4
;palfx.mul=128,128,128
;palfx.time=32
;p1sprpriority = 5
p2sprpriority = 3
kill = 1 ;Cond(target,life<=4,1,0) ;0
getpower = 0,0
ID = 2310
;chainID = 2310
[State 3005, hit]
type = hitdef
;triggerall = !NumProjID(3590)
triggerall = IsHelper(23353)
trigger1 = NumHelper(23353)
trigger1 = var(2)<(Helper(23353),var(3))  ; ;7
attr = A,HP
hitflag = MAF;D
guardflag = MA
priority = 7,Hit
damage = 14,3 ;ceil(13*root,fvar(12)), 3
getpower = 0,0
givepower = 20,20
pausetime = 1,1 ;4,4 ; 5,10
animtype = Heavy ;Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 4 ;16
ground.slidetime = 4 ;16
guard.hittime = 4 ;16
air.hittime = 4 ;13
airguard.ctrltime = 16
ground.velocity= -5,0
guard.velocity = -9
air.velocity = -5.5,-8 ;-3.9-6*(ifElse(root,Facing = 1, (root,NumExplod(90030016) || root,NumExplod(90030003)),(root,NumExplod(90030101) || root,NumExplod(90030114)))); -7*(root,var(3)=3320)
airguard.velocity = -5.5, -1.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = -1
;hitsound   = s1000,0
guardsound = S6,1
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
;forcestand = 1
;palfx.sinadd=64,64,64,4
;palfx.mul=128,128,128
;palfx.time=32
;p1sprpriority = 5
p2sprpriority = 3
kill = 1 ;Cond(target,life<=4,1,0) ;0
getpower = 0,0
ID = 2310
;chainID = 2310

[State 3302, Sparks]
type=null;explod
triggerall = !NumExplod(7020)
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
ID = 7020
anim=7020
sprpriority=6
postype=p2
pos=(target,const(size.ground.front)-random%20),5-random%20 ;-77;floor(p2dist y)
facing = IfElse(random<500,1,-1)
vfacing = IfElse(random<500,1,-1)
removetime=-2
ownpal=1
ignorehitpause=1
;persistent=0
pausemovetime=100
supermovetime=100


[State 1000, shake]
type = EnvShake
trigger1 = numtarget
trigger1 = time%4=0
time=5
freq=80
ampl=5+0.02*time
ignorehitpause = 1


[State 241, 1]  ;FX beam hit NOT WORKING
type = null; PlaySnd
trigger1 = numtarget
trigger1 = time>40
trigger1 = time%4=0
value = 3150,1
volumescale = 255

[State 0, Projectile]
type = Projectile
trigger1 = numtarget
trigger1 = MoveHit = 1
ProjID = 3000
projanim = 15999
projremovetime = 1
ignorehitpause=1


[State 0, TargetBind]
type = TargetBind
;triggerall = !NumProjID(3590)
trigger1 = numtarget
trigger1 = movehit
time = 1
id = -1
pos = 70,0
ignorehitpause = 1
;persistent =

[State 0, TargetBind]
type = null;TargetBind
;triggerall = !NumProjID(3590)
trigger1 = numtarget
trigger1 = moveguarded
time = 1
id = -1
pos = 70,77
ignorehitpause = 1
;persistent =

[State 0, Explod Hit]
type = Explod
trigger1 = numtarget
trigger1 = time%4=0
trigger1 = target,stateno!=[120,155]
anim = 7020+10*random%2
ID = 7010
pos=(target,const(size.ground.front)-random%20),5-random%20
postype = p2
facing = IfElse(random<500,1,-1)
vfacing = IfElse(random<500,1,-1)
bindtime = 1
random = 30,30
removetime = -2
pausemovetime = 9999
sprpriority = 10
ontop = 1
shadow = 0,0,0
ownpal = 0
ignorehitpause = 1

[State 0, Explod Guard]
type = Explod
trigger1 = numtarget
trigger1 = time%4=0
trigger1 = target,stateno=[120,155]
anim = 7000
ID = 7010
pos=(target,const(size.ground.front)-random%20),-75-random%10
postype = p2
facing = 1
vfacing = 1
bindtime = 1
random = 15,15
removetime = -2
pausemovetime = 9999
sprpriority = 10
ontop = 1
shadow = 0,0,0
ownpal = 0
ignorehitpause = 1

[State 0, TargetState]  ;no kill
type = TargetState
;triggerall = !NumProjID(3590)
triggerall = numtarget
;triggerall = target,life>8
trigger1 = movehit ;movecontact
trigger1 = !(target, ishelper)
value = 3370
ignorehitpause = 1
persistent = 0

[State 0, Projectile]
type = null;Projectile
triggerall = !NumProjID(3590)
triggerall = numtarget
trigger1 = target,life<=8
ProjID = 3590
projanim = 15999 ;3595 ;15999
offset = 0,50
postype = p1        ;p2,front,back,left,right
projremovetime = 1
ignorehitpause=1
;hitdef
attr = A,HP        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD       ;HLAFD+-
;guardflag = MA         ;HLA
animtype = Heavy
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
getpower = 0,0
givepower = 0,0
damage = 0,0
pausetime = 0,0
guard.pausetime = 0,0
sparkno = -1
guard.sparkno = -1
hitsound = -1
guardsound = -1
;;p2stateno = 3591  ;cinematic kill
kill = 0

[State 0, TargetState]  ;cinematic kill
type = null;TargetState
triggerall = numtarget
triggerall = target,life<=8
trigger1 = movecontact
;trigger1 = NumProjID(3590)
trigger1 = !(target, ishelper)
value = 3591
ignorehitpause = 1
persistent = 0

[State 0, StateTypeSet]
type = null;StateTypeSet
triggerall = numtarget
trigger1 = target,life<=8
movetype = I        ;I,A,H
ignorehitpause = 1
;persistent =

[State 0, PlaySnd]
type = PlaySnd
triggerall = !NumProjID(3590)
;triggerall = gametime%2
triggerall = !moveguarded
triggerall = numtarget
trigger1 = target, time=1
;trigger1 = movehit=1
value = 3150,1 ;1000,0
volumescale = 10+20*(IsHelper(3353))
channel = -1 ;7
lowpriority = 1
;abspan =
ignorehitpause = 1
;persistent =


[State 0, TargetVelSet]
type = null;TargetVelSet
trigger1 = numtarget
x = -vel X/2.0
y = 0
ID = -1
ignorehitpause = 1
;persistent =



[State 0, ChangeState]
type = ChangeState
triggerall = IsHelper(3353)
triggerall = !NumProjID(3590)
triggerall = NumHelper(3353)
triggerall = var(2)<(Helper(3353),var(3))  ;50 ;7
trigger1 = numtarget
trigger1 = movecontact
trigger1 = HitPauseTime = 0 ;target,HitShakeOver=0
trigger2 = !numtarget
trigger2 = time>1 ;2 ;4
value = 3360
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =
[State 0, ChangeState]
type = ChangeState
triggerall = IsHelper(23353)
triggerall = !NumProjID(3590)
triggerall = NumHelper(23353)
triggerall = var(2)<(Helper(23353),var(3))  ;50 ;7
trigger1 = numtarget
trigger1 = movecontact
trigger1 = HitPauseTime = 0 ;target,HitShakeOver=0
trigger2 = !numtarget
trigger2 = time>1 ;2 ;4
value = 3360
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod] ;hitspark
type = RemoveExplod
triggerall = IsHelper(3353)
trigger1 = !NumHelper(3351)
id = 7020
ignorehitpause = 1
;persistent =
[State 0, RemoveExplod] ;hitspark
type = RemoveExplod
triggerall = IsHelper(23353)
trigger1 = !NumHelper(23351)
id = 7020
ignorehitpause = 1
;persistent =

[State 0, ChangeState] ; Combo keeper
type = ChangeState
triggerall = IsHelper(3353)
triggerall = root,var(3)=3320
trigger1 = !NumHelper(3351)
value = 3356
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

[State 1061, End]
type = destroyself
triggerall = IsHelper(3353)
triggerall = root,var(3)!=3320
trigger1 = !NumHelper(3351)
[State 1061, End]
type = destroyself
triggerall = IsHelper(23353)
triggerall = root,var(3)!=3320
trigger1 = !NumHelper(23351)


;PB_BEAM Body
[Statedef 3354]
type = A
physics = N
movetype = I
anim = 3352
ctrl = 0
sprpriority = 4

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
;flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
trigger1 = NumHelper(3351)
text = "scaleX=%f"
params = ((helper(3351),var(1))/12.1)
ignorehitpause = 1
;persistent =


[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
;facing = 0
pos = 65,0
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
triggerall = IsHelper(3354)
trigger1 = NumHelper(3351)
trigger1 = 1
value = 0
scale = (helper(3351),var(1))/13.8,1-(Helper(3351),var(2))/10.0
ignorehitpause = 1 ;0
;persistent =
[State 0, AngleDraw]
type = AngleDraw
triggerall = IsHelper(23354)
trigger1 = NumHelper(23351)
trigger1 = 1
value = 0
scale = (helper(23351),var(1))/13.8,1-(Helper(23351),var(2))/10.0
ignorehitpause = 1 ;0
;persistent =

[State 1061, End]
type = destroyself
triggerall = IsHelper(3354)
trigger1 = !NumHelper(3351)
[State 1061, End]
type = destroyself
triggerall = IsHelper(23354)
trigger1 = !NumHelper(23351)

;PB_BEAM Tip
[Statedef 3355]
type = A
physics = N
movetype = I
anim = 3355
ctrl = 0
sprpriority = 6

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
;flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
;facing = 0
pos = 20,0
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
triggerall = IsHelper(3355)
trigger1 = NumHelper(3351)
trigger1 = 1
value = 0
scale = 1,1-(Helper(3351),var(2))/10.0
ignorehitpause = 0
;persistent =
[State 0, AngleDraw]
type = AngleDraw
triggerall = IsHelper(23355)
trigger1 = NumHelper(23351)
trigger1 = 1
value = 0
scale = 1,1-(Helper(23351),var(2))/10.0
ignorehitpause = 0
;persistent =

[State 1061, End]
type = destroyself
triggerall = IsHelper(3355)
trigger1 = !NumHelper(3351)
[State 1061, End]
type = destroyself
triggerall = IsHelper(23355)
trigger1 = !NumHelper(23351)

; PB - Combo keeper
[Statedef 3356]
anim = 9999
ctrl = 0
hitcountpersist = 1
movehitpersist = 1

[State 1216, NotHitBy]
type = NotHitBy
trigger1 = !Time
value = SCA
time = -1

[State 1216, Remove]
type = DestroySelf
trigger1 = root, StateNo != [3300,3322]

;Empty state for spawning Gackt
[Statedef 3360]
type = A
physics = N
movetype = I
ctrl = 0

[State 0, VarAdd] ;Number of hits
type = VarAdd
trigger1 = !time
var(2) = 1
ignorehitpause = 1
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !time
value = 3353
ctrl = 0
ignorehitpause = 1
;persistent =

;PB2_BEAM HELPER
[Statedef 13351]
type = A
physics = N
movetype = A
anim = 9999
ctrl = 0
sprpriority = 1
hitcountpersist = 1
movehitpersist = 1

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
;time = 1
;facing = 0
pos = 3,-3
;ignorehitpause =
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = 3350,2
volumescale = 255
channel = 1
lowpriority = 1
;abspan =
;ignorehitpause =
;persistent =

[State 3000, Breaker Beam Tail]
type = helper
trigger1 = !time
helpertype = normal
stateno = 13352
ID = 13352
name = "breaker tail"
postype = p1
pos = 0,0
ownpal = 1

[State 3000, Breaker Beam Damage]
type = helper
trigger1 = !time
helpertype = normal
stateno = 13353
ID = 13353
name = "Breaker damage"
postype = p1
pos = 80,-77 ;0,0
ownpal = 1

[State 0, VarSet]
type = VarSet
trigger1 = 1
trigger1 = NumHelper(13353)
var(1) = ceil(abs(ScreenPos X - helper(13353),ScreenPos X))
ignorehitpause = 1
;persistent =


[State 0, Scale Tracker X]
type =null; VarAdd
triggerall = var(1)<30
trigger1 = NumHelper(13353)
trigger1 = Helper(13353),vel x>0
trigger2 = root,vel x<0
trigger2 = (root,BackEdgeDist>30) ;|| (root,AnimElemTime(5)<30)
;trigger2 = rootdist x<30
var(1) = 1
ignorehitpause = 0
;persistent =

[State 0, Scale Tracker Y]
type = VarAdd
triggerall = var(2)<10
trigger1 = NumHelper(13353)
trigger1 = Helper(13353),var(2)>=(Helper(13353),var(3)) ;total hits
trigger2 = time>250 ;not hitting
var(2) = 1
ignorehitpause = 0
;persistent =

[State -2, Explosion]
type = Explod
triggerall = !NumExplod(3570)
triggerall = NumHelper(13353)
trigger1 = var(2)>1
ID = 13570
anim = 3570
pos = ceil(Helper(13353),ScreenPos X)+30,ceil(Helper(13353),ScreenPos Y) ;0,0
postype = left ;p1
velocity = 0, 0
accel = 0, 0
bindtime = 1
removetime =-2
sprpriority =10
ignorehitpause = 1
persistent = 0
facing =1

[State 10500, snd]
type = playsnd
triggerall = NumExplod(3570)
trigger1 = !win
value = 3560,2
persistent = 0

[State 1061, End]
type = destroyself
trigger1 = var(2)>=10
trigger2 = root,movetype=H
trigger3 = time>260 ;260 ;not hitting

;PB2_BEAM Tail
[Statedef 13352]
type = A
physics = N
movetype = I
anim = 3351
ctrl = 0
sprpriority = 3

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
;flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1


[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
;facing = 0
pos = 35,-80
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = NumHelper(13351)
;trigger1 = NumHelper(2312)
;trigger1 = Helper(2312),var(2)>=7
trigger1 = 1
value = 0
scale = 1,1-(Helper(13351),var(2))/10.0
ignorehitpause = 0
;persistent =

[State 1061, End]
type = destroyself
trigger1 = !NumHelper(13351)

;PB2_BEAM Damage
[Statedef 13353]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 1
hitcountpersist = 1
movehitpersist = 1

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "Root=%d | Kame=%d | DistX=%d | var(1)=%d | AElem=%d"
params = (root,pos X),pos X, abs((root,pos X)-pos X), var(1),-10+floor(abs((root,pos X)-pos X)/7)
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1 ;!time
value = 3353
elem = IFElse((floor(abs((root,pos X)-pos X)/7)-10)<=0,1,floor(abs((root,pos X)-pos X)/7)-10);var(1)
ignorehitpause = 1
;persistent =

[State 0, total hits]
type = VarSet
trigger1 = !time
var(3) = 15 ;define total number of hits
ignorehitpause = 1
;persistent =

[State 0, Capture Anim]
type = VarSet
triggerall = !NumProjID(3590)
trigger1 = 1 ;movecontact
var(1) = AnimElemno(0)
ignorehitpause = 1
;persistent =

[State 3000, Gackt Beam Body]
type = helper
trigger1 = !NumHelper(13354)
trigger1 = !time;=4
helpertype = normal
stateno = 13354
ID = 13354
name = "gackt body"
postype = p1
pos = 30,0
ownpal = 1

[State 3000, Gackt Beam tip]
type = helper
trigger1 = !NumHelper(13355)
trigger1 = !time;=4
helpertype = normal
stateno = 13355
ID = 13355
name = "gackt tip"
postype = p1
pos = 30,0
ownpal = 1

[State 0, VelSet]
type = VelAdd
trigger1 = FrontEdgeDist > 40
x = 2 ;0.2
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = FrontEdgeDist <= 40
x = 0
;ignorehitpause =
;persistent =

[State 0, StateTypeSet] ;buu fix
type = StateTypeSet
trigger1 = enemy,name = "Buu Z2"
trigger1 = enemy,stateno=301
movetype = I        ;I,A,H
ignorehitpause = 1
;persistent =

[State 3005, hit]
type = hitdef
;triggerall = !NumProjID(3590)
trigger1 = NumHelper(13353)
trigger1 = var(2)<(Helper(13353),var(3))  ; ;7
attr = A,HP
hitflag = MAF;D
guardflag = MA
priority = 7,Hit
damage = 5,1 ;ceil(13*root,fvar(12)), 3
getpower = 0,0
givepower = 20,20
pausetime = 1,1 ;4,4 ; 5,10
animtype = Heavy ;Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 4 ;16
ground.slidetime = 4 ;16
guard.hittime = 4 ;16
air.hittime = 4 ;13
airguard.ctrltime = 16
ground.velocity= -5,0
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = -1
;hitsound   = s1000,0
guardsound = S6,1
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
;forcestand = 1
;palfx.sinadd=64,64,64,4
;palfx.mul=128,128,128
;palfx.time=32
;p1sprpriority = 5
p2sprpriority = 3
kill = 1 ;Cond(target,life<=4,1,0) ;0
getpower = 0,0
ID = 2310
;chainID = 2310

[State 3302, Sparks]
type=null;explod
triggerall = !NumExplod(7021)
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
ID = 7021
anim=7020
sprpriority=6
postype=p2
pos=(target,const(size.ground.front)-random%20),5-random%20 ;-77;floor(p2dist y)
facing = IfElse(random<500,1,-1)
vfacing = IfElse(random<500,1,-1)
removetime=-2
ownpal=1
ignorehitpause=1
;persistent=0
pausemovetime=100
supermovetime=100

[State 0, Explod Hit]
type = Explod
trigger1 = numtarget
trigger1 = time%4=0
trigger1 = target,stateno!=[120,155]
anim = 7020+10*random%2
ID = 7010
pos=(target,const(size.ground.front)-random%20),5-random%20
postype = p2
facing = IfElse(random<500,1,-1)
vfacing = IfElse(random<500,1,-1)
bindtime = 1
random = 30,30
removetime = -2
pausemovetime = 9999
sprpriority = 10
ontop = 1
shadow = 0,0,0
ownpal = 0
ignorehitpause = 1

[State 0, Explod Guard]
type = Explod
trigger1 = numtarget
trigger1 = time%4=0
trigger1 = target,stateno=[120,155]
anim = 7000
ID = 7010
pos=(target,const(size.ground.front)-random%20),-75-random%10
postype = p2
facing = 1
vfacing = 1
bindtime = 1
random = 15,15
removetime = -2
pausemovetime = 9999
sprpriority = 10
ontop = 1
shadow = 0,0,0
ownpal = 0
ignorehitpause = 1


[State 1000, shake]
type = EnvShake
trigger1 = numtarget
trigger1 = time%4=0
time=5
freq=80
ampl=5+0.02*time
ignorehitpause = 1


[State 0, TargetBind]
type = TargetBind
;triggerall = !NumProjID(3590)
trigger1 = numtarget
trigger1 = movehit
time = 1
id = -1
pos = 70,0
ignorehitpause = 1
;persistent =

[State 0, TargetState]  ;no kill
type = TargetState
;triggerall = !NumProjID(3590)
triggerall = numtarget
;triggerall = target,life>8
trigger1 = movehit ;movecontact
trigger1 = !(target, ishelper)
value = 3370
ignorehitpause = 1
persistent = 0

[State 0, Projectile]
type = null;Projectile
triggerall = !NumProjID(3590)
triggerall = numtarget
trigger1 = target,life<=8
ProjID = 3590
projanim = 15999 ;3595 ;15999
offset = 0,50
postype = p1        ;p2,front,back,left,right
projremovetime = 1
ignorehitpause=1
;hitdef
attr = A,HP        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD       ;HLAFD+-
;guardflag = MA         ;HLA
animtype = Heavy
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
getpower = 0,0
givepower = 0,0
damage = 0,0
pausetime = 0,0
guard.pausetime = 0,0
sparkno = -1
guard.sparkno = -1
hitsound = -1
guardsound = -1
;;p2stateno = 3591  ;cinematic kill
kill = 0

[State 0, TargetState]  ;cinematic kill
type = null;TargetState
triggerall = numtarget
triggerall = target,life<=8
trigger1 = movecontact
;trigger1 = NumProjID(3590)
trigger1 = !(target, ishelper)
value = 3591
ignorehitpause = 1
persistent = 0

[State 0, StateTypeSet]
type = null;StateTypeSet
triggerall = numtarget
trigger1 = target,life<=8
movetype = I        ;I,A,H
ignorehitpause = 1
;persistent =

[State 0, PlaySnd]
type = PlaySnd
triggerall = !NumProjID(3590)
;triggerall = gametime%2
triggerall = !moveguarded
triggerall = numtarget
trigger1 = target, time=1
;trigger1 = movehit=1
value = 3150,1 ;1000,0
volumescale = 10
channel = -1 ;7
lowpriority = 1
;abspan =
ignorehitpause = 1
;persistent =


[State 0, TargetVelSet]
type = null;TargetVelSet
trigger1 = numtarget
x = -vel X/2.0
y = 0
ID = -1
ignorehitpause = 1
;persistent =



[State 0, ChangeState]
type = ChangeState
triggerall = !NumProjID(3590)
triggerall = NumHelper(13353)
triggerall = var(2)<(Helper(13353),var(3))  ;50 ;7
trigger1 = numtarget
trigger1 = movecontact
trigger1 = HitPauseTime = 0 ;target,HitShakeOver=0
trigger2 = !numtarget
trigger2 = time>1 ;2 ;4
value = 13360
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod] ;hitspark
type = RemoveExplod
trigger1 = !NumHelper(13351)
id = 7020
ignorehitpause = 1
;persistent =

[State 1061, End]
type = destroyself
trigger1 = !NumHelper(13351)

;PB2_BEAM Body
[Statedef 13354]
type = A
physics = N
movetype = I
anim = 3352
ctrl = 0
sprpriority = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
;flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
trigger1 = NumHelper(13351)
text = "scaleX=%f"
params = ((helper(13351),var(1))/12.1)
ignorehitpause = 1
;persistent =


[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
;facing = 0
pos = 68,-6
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = NumHelper(13351)
trigger1 = 1
value = 0
scale = (helper(13351),var(1))/13.8,1-(Helper(13351),var(2))/10.0
ignorehitpause = 1 ;0
;persistent =

[State 1061, End]
type = destroyself
trigger1 = !NumHelper(13351)

;PB2_BEAM Tip
[Statedef 13355]
type = A
physics = N
movetype = I
anim = 3355
ctrl = 0
sprpriority = 4

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
;flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
;facing = 0
pos = 23,-6
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = NumHelper(13351)
trigger1 = 1
value = 0
scale = 1,1-(Helper(13351),var(2))/10.0
ignorehitpause = 0
;persistent =

[State 1061, End]
type = destroyself
trigger1 = !NumHelper(13351)

;Empty state for spawning Gackt
[Statedef 13360]
type = A
physics = N
movetype = I
ctrl = 0

[State 0, VarAdd] ;Number of hits
type = VarAdd
trigger1 = !time
var(2) = 1
ignorehitpause = 1
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !time
value = 13353
ctrl = 0
ignorehitpause = 1
;persistent =

;CO BEAM
[Statedef 3606]
type    = A
movetype= A
physics = N
sprpriority = 5
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
flag2 = nojugglecheck
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 3606
ignorehitpause = 1
;persistent =

[State 13100, launch sound]
type = playsnd
trigger1 = !time
value = 3220,0

[State 1061, Velocity]
type = VelSet
trigger1 = !Time
x = 8.3*cos(14*Pi/180.0)
y = 8.3*sin(14*Pi/180.0)

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT, NP, SP, HP
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = 1
attr = A, HP
animtype  = hard;light
;damage    = ceil(23*root,fvar(15)), ceil(3*root,fvar(15))
damage =  20,0
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
pausetime = 0,8
sparkno = -1 ;s3607 ;s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s3606,1 ;s3220,1;s1210,0
guardsound = S6,1
ground.type = trip;high
air.type = trip ;high ;low
ground.slidetime = 2;20
ground.hittime  = 2 ;20
ground.velocity = -3.5,-11;-1.8,0
guard.velocity = -1.5
air.velocity = -3.5,-11
airguard.velocity = -0.5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
fall = 1
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 0,0
ID = 3606
persistent = 0

[State 0, Projectile]
type = Projectile
trigger1 = MoveHit = 1
ProjID = 3000
projanim = 15999
projremovetime = 1
ignorehitpause=1

[State 0, Explosion]
type = Explod
trigger1 = movehit=2 ;3
anim = 3608
ID = 3607
pos = 0,-40
postype = p2  ;p2,front,back,left,right
facing = 1 ;Cond(random%2,1,-1)
vfacing = 1 ;Cond(random%2,1,-1)
bindtime = 1
random = 20,20
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 10
shadow = 0,0,0
ownpal = 0
removeongethit = 1
persistent = 0


[State 3001, Guardshake]
type = envshake
trigger1 = moveguarded
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = time>60

;CO BEAM CHARGE
[Statedef 3609]
type    = A
movetype= I
physics = N
sprpriority = 5
hitcountpersist = 1
movehitpersist = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
flag2 = nojugglecheck
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA, NA, SA, HA, NT, ST, HT, NP, SP, HP
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 3609
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time<20
scale = 0.05*time,0.05*time
ignorehitpause = 1
;persistent =

[State 1061, End]
type = destroyself
trigger1 = time>22

;C17 Winpose 3b
[Statedef 6183]
type = S
MoveType = I
physics = S
ctrl = 0
anim = 6183
velset = 0,0
sprpriority = 5

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1


[State 801, teleport sound]
type = PlaySnd
trigger1 = !time
value = 810,0

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = root,alive=0

;C17 Intro
[Statedef 6708]
type = S
MoveType = I
physics = S
ctrl = 0
anim = 6708
velset = 0,0
sprpriority = 6

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = root,anim=7081
trigger1 = Anim=6708
value = 6709

[State 801, teleport sound]
type = PlaySnd
trigger1 = Anim=6709
trigger1 = AnimelemTime(1)=0
value = 810,0

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = Anim=6709
trigger1 = !Animtime

;C16 Intro
[Statedef 16000]
type = S
MoveType = I
physics = S
ctrl = 0
anim = 16000
velset = 0,0
sprpriority = -5

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0, Bird 1]
type = Helper
triggerall = !NumHelper(16005)
trigger1 = Anim=16000
trigger1 = AnimelemTime(12)=0
helpertype = normal
name = "Bird 1"
ID = 16005
stateno = 16005
pos = 37,-117
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 0
pausemovetime = 0

[State 0, Bird 2]
type = Helper
triggerall = !NumHelper(16006)
trigger1 = Anim=16000
trigger1 = AnimelemTime(12)=0
helpertype = normal
name = "Bird 2"
ID = 16006
stateno = 16006
pos = 28,-153
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 0
pausemovetime = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = root,anim=7081
trigger1 = Anim=16000
value = 16001

[State 801, teleport sound]
type = PlaySnd
trigger1 = Anim=16001
trigger1 = AnimelemTime(1)=0
value = 810,0

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = Anim=16001
trigger1 = !Animtime

;C16 Bird 1
[Statedef 16005]
type = S
MoveType = I
physics = N
ctrl = 0
anim = 16005
velset = 0,0
sprpriority = 5

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = -1
y = -2

[State 0, Offset]
type = Offset
trigger1 = !time
y = 2*cos((time)*pi/180)

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = roundstate=2

;C16 Bird 2
[Statedef 16006]
type = S
MoveType = I
physics = N
ctrl = 0
anim = 16006
velset = 0,0
sprpriority = 5

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 1
y = -2

[State 0, Offset]
type = Offset
trigger1 = !time
y = 2*cos((time)*pi/180)

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = roundstate=2

;C16 Winpose 3b
[Statedef 16010]
type = S
MoveType = I
physics = S
ctrl = 0
anim = 16010
velset = 0,0
sprpriority = -5

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1


[State 801, teleport sound]
type = null;PlaySnd
trigger1 = !time
value = 810,0

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = root,alive=0

;DTD Fireball
[Statedef 4331]
type    = A
movetype= A
physics = N
anim = 4332 ;4331
hitcountpersist = 1
movehitpersist = 1
sprpriority = 7
;facep2 = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 1
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim] ;laser
type = ChangeAnim
triggerall = !time
trigger1 = IsHelper(4333) || IsHelper(4334)
trigger2 = IsHelper(4335) || IsHelper(4336)
value = 4332
elem = 8
ignorehitpause = 1
;persistent =

[State 0, PosAdd]
type = PosAdd
triggerall = !time
trigger1 = IsHelper(4333) || IsHelper(4334)
trigger2 = IsHelper(4335) || IsHelper(4336)
x = Cond((root,gametime%2),-random%5,random%5)
ignorehitpause = 1
;persistent =


[State 0, VelSet]
type = VelSet
trigger1 = time=9
y = 10+4*(random%3) ;15
ignorehitpause = 1
;persistent =

[State 0, PlaySnd]
type = PlaySnd
triggerall = IsHelper(4331) || IsHelper(4332)
trigger1 = time=9
value = 4331,random%3
volumescale = 60 ;20

[State 1061, Hitdef]
type = HitDef
trigger1 = IsHelper(4333) || IsHelper(4334)
trigger2 = IsHelper(4335) || IsHelper(4336)
attr = A, HP
animtype  = hard
damage = 0,0
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
affectteam = E
pausetime = 0,15
guard.pausetime = 0,10
sparkno = -1 ;s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s4331,50+random%3 ;s1210,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 5
ground.hittime  = 20
ground.velocity = -2,0
guard.velocity = -2.5
air.velocity = -3.8,-3
airguard.velocity = -3, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 0,0
p2stateno = 4356+(IsHelper(4335) || IsHelper(4336))
;ID = 1030
;persistent = 0

[State 0, Explosion]
type = Explod
trigger1 = movehit=1
anim = 3607
ID = 3607
;pos = -20+random%41,-40+random%41
pos = -10+random%21,-10+random%21
postype = p1  ;p2,front,back,left,right
facing = Cond(random%2,1,-1)
vfacing = Cond(random%2,1,-1)
bindtime = 1
;random = 20,20
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 8
shadow = 0,0,0
ownpal = 0
removeongethit = 1
;persistent = 0

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = IsHelper(4333) || IsHelper(4334)
trigger1 = root,stateno!=4303
trigger2 = IsHelper(4335) || IsHelper(4336)
trigger2 = root,stateno!=4304
id = 3607
ignorehitpause = 1
;persistent =


[State 1061, End]
type = destroyself
trigger1 = pos y>150
trigger2 = IsHelper(4331)
trigger2 = Root,stateno!=4302
trigger3 = IsHelper(4332)
trigger3 = Root,stateno!=4302
trigger4 = IsHelper(4333)
trigger4 = Root,stateno!=4303
trigger5 = IsHelper(4334)
trigger5 = Root,stateno!=4303
trigger6 = movehit
trigger7 = IsHelper(4335)
trigger7 = Root,stateno!=4304
trigger8 = IsHelper(4336)
trigger8 = Root,stateno!=4304

;YAKON BG
[Statedef 4390]
type = S
movetype = I
physics = N
anim = 4390
ctrl = 0
sprpriority = 10

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = -floor(GameHeight/2.0)
ignorehitpause = 1
;persistent =


[State 0, Trans]
type = null;Trans
trigger1 = time<32
trans = addalpha
alpha = 8*time,256-8*time

[State 0, Trans]
type = Trans
trigger1 = !time ;time=[32,64]
trans = addalpha
alpha = 256,0

[State 0, Trans]
type = Trans
trigger1 = time>0
trans = addalpha
alpha = 256-8*(time),0+8*(time)

[State 0, Trans]
type = null;Trans
trigger1 = time>64
trans = addalpha
alpha = 256-8*(time-64),0+8*(time-64)

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time>31 ;96
;ignorehitpause =
;persistent =

;ANTIYAKON BG
[Statedef 4391]
type = S
movetype = I
physics = N
anim = 4391
ctrl = 0
sprpriority = 10

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = -floor(GameHeight/2.0)
ignorehitpause = 1
;persistent =


[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
ignorehitpause = 1

[State 0, Trans]
type = null;Trans
trigger1 = time<32
trans = addalpha
alpha = 8*time,256-8*time

[State 0, Trans]
type = Trans
trigger1 = !time ;time=[32,64]
trans = addalpha
alpha = 0,256

[State 0, Trans]
type = Trans
trigger1 = time<32
trans = addalpha
alpha = 0+8*(time),256-8*(time)

[State 0, Trans]
type = Trans
trigger1 = time>=32
trans = addalpha
alpha = 256,0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time>80 ;40;64
;ignorehitpause =
;persistent =

;F0_BEAM HELPER
[Statedef 4451]
type = A
physics = N
movetype = A
anim = 9999
ctrl = 0
sprpriority = 1
hitcountpersist = 1
movehitpersist = 1
facep2 = 1

[State 0, BindToRoot]
type = BindToRoot
;trigger1 = 1
trigger1 = time<100
;time = 1
;facing = 0
pos = 0,0
;ignorehitpause =
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = 3350,3
volumescale = 255
channel = 1
lowpriority = 1
;abspan =
;ignorehitpause =
;persistent =

[State 3000, Breaker Beam Tail]
type = helper
trigger1 = !time
helpertype = normal
stateno = 4452
ID = 4452
name = "breaker tail"
postype = p1
pos = 0,0
ownpal = 1

[State 3000, Breaker Beam Damage]
type = helper
trigger1 = !time
helpertype = normal
stateno = 4453
ID = 4453
name = "Breaker damage"
postype = p1
pos = 280,-35 ;280,-77 ;22,-35
ownpal = 1

[State 0, VarSet]
type = VarSet
trigger1 = 1
trigger1 = NumHelper(4453)
var(1) = ceil(abs(ScreenPos X - helper(4453),ScreenPos X))
ignorehitpause = 1
;persistent =


[State 0, Scale Tracker X]
type =null; VarAdd
triggerall = var(1)<30
trigger1 = NumHelper(4453)
trigger1 = Helper(4453),vel x>0
trigger2 = root,vel x<0
trigger2 = (root,BackEdgeDist>30) ;|| (root,AnimElemTime(5)<30)
;trigger2 = rootdist x<30
var(1) = 1
ignorehitpause = 0
;persistent =

[State 0, Scale Tracker Y]
type = VarAdd
triggerall = var(2)<10
trigger1 = NumHelper(4453)
trigger1 = Helper(4453),var(2)>=(Helper(4453),var(3)) ;total hits
trigger2 = time>250 ;not hitting
var(2) = 1
ignorehitpause = 0
;persistent =

[State -2, Explosion]
type = Explod
triggerall = !NumExplod(3570)
triggerall = NumHelper(4453)
trigger1 = var(2)>1
ID = 3570
anim = 3570
pos = ceil(Helper(4453),ScreenPos X)+30,ceil(Helper(4453),ScreenPos Y) ;0,0
postype = left ;p1
velocity = 0, 0
accel = 0, 0
bindtime = 1
removetime =-2
sprpriority =10
ignorehitpause = 1
persistent = 0
facing =1

[State 10500, snd]
type = playsnd
triggerall = NumExplod(3570)
trigger1 = !win
value = 3560,2
persistent = 0

[State 1061, End]
type = destroyself
trigger1 = var(2)>=10
trigger2 = root,movetype=H
trigger3 = time>260 ;260 ;not hitting

;F0_BEAM Tail
[Statedef 4452]
type = A
physics = N
movetype = I
anim = 3351
ctrl = 0
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
;flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1


[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
;facing = 0
pos = 22,-35 ;32,-77
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = NumHelper(4451)
;trigger1 = NumHelper(2312)
;trigger1 = Helper(2312),var(2)>=7
trigger1 = 1
value = 0
scale = 1,1-(Helper(4451),var(2))/10.0
ignorehitpause = 0
;persistent =

[State 1061, End]
type = destroyself
trigger1 = !NumHelper(4451)

;F0_BEAM Damage
[Statedef 4453]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 1
hitcountpersist = 1
movehitpersist = 1

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "Root=%d | Kame=%d | DistX=%d | var(1)=%d | AElem=%d"
params = (root,pos X),pos X, abs((root,pos X)-pos X), var(1),-10+floor(abs((root,pos X)-pos X)/7)
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1 ;!time
value = 4453
elem = 1 ;IFElse((floor(abs((root,pos X)-pos X)/7)-10)<=0,1,floor(abs((root,pos X)-pos X)/7)-10);var(1)
ignorehitpause = 1
;persistent =

[State 0, total hits]
type = VarSet
trigger1 = !time
var(3) = 49 ;define total number of hits
ignorehitpause = 1
;persistent =

[State 0, Capture Anim]
type = VarSet
triggerall = !NumProjID(3590)
trigger1 = 1 ;movecontact
var(1) = AnimElemno(0)
ignorehitpause = 1
;persistent =

[State 3000, Gackt Beam Body]
type = helper
trigger1 = !NumHelper(4454)
trigger1 = !time;=4
helpertype = normal
stateno = 4454
ID = 4454
name = "gackt body"
postype = p1
pos = 30,0
ownpal = 1

[State 3000, Gackt Beam tip]
type = helper
trigger1 = !NumHelper(4455)
trigger1 = !time;=4
helpertype = normal
stateno = 4455
ID = 4455
name = "gackt tip"
postype = p1
pos = 30,0
ownpal = 1

[State 0, VelSet]
type = null;VelAdd
trigger1 = FrontEdgeDist > 40
x = 2 ;0.2
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = null;VelSet
trigger1 = FrontEdgeDist <= 40
x = 0
;ignorehitpause =
;persistent =

[State 3005, hit]
type = hitdef
triggerall = !NumProjID(3590)
trigger1 = NumHelper(4453)
trigger1 = var(2)<(Helper(4453),var(3))  ; ;7
attr = A,HP
hitflag = MAF;D
guardflag = MA
priority = 7,Hit
damage = 1,1 ;ceil(13*root,fvar(12)), 3
getpower = 0,0
givepower = 20,20
pausetime = 4,4 ; 5,10
animtype = Heavy ;Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 4 ;16
ground.slidetime = 4 ;16
guard.hittime = 4 ;16
air.hittime = 4 ;13
airguard.ctrltime = 16
ground.velocity= -5,0
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = -1
;hitsound   = s1000,0
guardsound = S6,1
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
;forcestand = 1
;palfx.sinadd=64,64,64,4
;palfx.mul=128,128,128
;palfx.time=32
;p1sprpriority = 5
p2sprpriority = 3
kill = Cond((var(2)+3)<(Helper(4453),var(3)),0,1) ;0
getpower = 0,0
ID = 2310
;chainID = 2310

[State 0, Explod]
type = Explod
trigger1 = numtarget
trigger1 = time%4=0
anim = 7020+10*random%2
ID = 7010
pos=(target,const(size.ground.front)-random%20),5-random%20
postype = p2
facing = IfElse(random<500,1,-1)
vfacing = IfElse(random<500,1,-1)
bindtime = 1
random = 30,30
removetime = -2
pausemovetime = 9999
sprpriority = 10
ontop = 1
shadow = 0,0,0
ownpal = 0
ignorehitpause = 1


[State 1000, shake]
type = EnvShake
trigger1 = numtarget
trigger1 = time%4=0
time=5
freq=80
ampl=20+0.02*time
ignorehitpause = 1

[State 0, Projectile]
type = Projectile
trigger1 = numtarget
trigger1 = MoveHit = 1
ProjID = 3000
projanim = 15999
projremovetime = 1
ignorehitpause=1


[State 0, TargetBind]
type = null;TargetBind
;triggerall = !NumProjID(3590)
trigger1 = numtarget
trigger1 = movehit
time = 1
id = -1
pos = 30,0 ;70,0
ignorehitpause = 1
;persistent =

[State 0, Projectile]
type = Projectile
triggerall = root,Matchover
triggerall = !NumProjID(3590)
triggerall = numtarget
trigger1 = target,alive=0 ;target,life<=8
ProjID = 3590
projanim = 15999 ;3595 ;15999
offset = 0,50
postype = p1        ;p2,front,back,left,right
projremovetime = 1
ignorehitpause=1
;hitdef
attr = A,HP        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD       ;HLAFD+-
;guardflag = MA         ;HLA
animtype = Heavy
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
getpower = 0,0
givepower = 0,0
damage = 0,0
pausetime = 0,0
guard.pausetime = 0,0
sparkno = -1
guard.sparkno = -1
hitsound = -1
guardsound = -1
;;p2stateno = 3591  ;cinematic kill
kill = 0

[State 0, TargetState]  ;cinematic kill
type = TargetState
triggerall = root,Matchover
triggerall = NumProjID(3590)
triggerall = numtarget
trigger1 = movecontact
trigger1 = !(target, ishelper)
value = 3591
ignorehitpause = 1
persistent = 0

[State 0, TargetState]  ;no kill
type = TargetState
triggerall = root,Matchover=0
triggerall = !NumProjID(3590)
triggerall = numtarget
;triggerall = target,life>8
trigger1 = movehit ;movecontact
trigger1 = !(target, ishelper)
value = 4470
ignorehitpause = 1
persistent = 0


[State 0, StateTypeSet]
type = null;StateTypeSet
triggerall = numtarget
trigger1 = target,life<=8
movetype = I        ;I,A,H
ignorehitpause = 1
;persistent =

[State 0, PlaySnd]
type = PlaySnd
triggerall = !NumProjID(3590)
;triggerall = gametime%2
triggerall = numtarget
trigger1 = target, time=1
;trigger1 = movehit=1
value = 3150,1 ;1000,0
volume = 0
channel = -1 ;7
lowpriority = 1
;abspan =
ignorehitpause = 1
;persistent =


[State 0, TargetVelSet]
type = null;TargetVelSet
trigger1 = numtarget
x = -vel X/2.0
y = 0
ID = -1
ignorehitpause = 1
;persistent =



[State 0, ChangeState]
type = ChangeState
triggerall = !NumProjID(3590)
triggerall = NumHelper(4453)
triggerall = var(2)<(Helper(4453),var(3))  ;50 ;7
trigger1 = numtarget
trigger1 = movecontact
trigger1 = HitPauseTime = 0 ;target,HitShakeOver=0
trigger2 = !numtarget
trigger2 = time>1 ;2 ;4
value = 4460
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod] ;hitspark
type = RemoveExplod
trigger1 = !NumHelper(4451)
id = 7020
ignorehitpause = 1
;persistent =

[State 1061, End]
type = destroyself
trigger1 = !NumHelper(4451)

;F0_BEAM Body
[Statedef 4454]
type = A
physics = N
movetype = I
anim = 3352
ctrl = 0
sprpriority = 4

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
;flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
trigger1 = NumHelper(4451)
text = "scaleX=%f"
params = ((helper(4451),var(1))/12.1)
ignorehitpause = 1
;persistent =


[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
;facing = 0
pos = 65,0
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = NumHelper(4451)
trigger1 = 1
value = 0
scale = (helper(4451),var(1))/13.8,1-(Helper(4451),var(2))/10.0
ignorehitpause = 1 ;0
;persistent =

[State 1061, End]
type = destroyself
trigger1 = !NumHelper(4451)

;PB_BEAM Tip
[Statedef 4455]
type = A
physics = N
movetype = I
anim = 3355
ctrl = 0
sprpriority = 6

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
;flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
;facing = 0
pos = 20,0
ignorehitpause = 1
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = NumHelper(4451)
trigger1 = 1
value = 0
scale = 1,1-(Helper(4451),var(2))/10.0
ignorehitpause = 0
;persistent =

[State 1061, End]
type = destroyself
trigger1 = !NumHelper(4451)

;Empty state for spawning Gackt
[Statedef 4460]
type = A
physics = N
movetype = I
ctrl = 0

[State 0, VarAdd] ;Number of hits
type = VarAdd
trigger1 = !time
var(2) = 1
ignorehitpause = 1
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !time
value = 4453
ctrl = 0
ignorehitpause = 1
;persistent =

;==========================================================
; EMOTION GAUGE HELPER P1
[Statedef 4750]
physics = N
velset = 0, 0
sprpriority = 7
anim = 9999

;[State 0, ParentVarSet] ;bar initialize
;type = ParentVarAdd
;trigger1 = root,stateno=4000
;trigger1 = 1 && var(52):=1
;var(52) = 1 ;ROOT
;persistent=0


[State 0, RTC];detect enemy superpause
type = Null
trigger1 = 1
trigger1 = var(58):=gametime
trigger1 = var(59):=root,var(59)
ignorehitpause = 1
;persistent =

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "Root_EMO=%d | H_level=%d | V-Ism=%d | RTC=%d | HTC=%d"
params = (root,var(52)), var(52), (root,var(54)), (root,var(59)), var(59)
ignorehitpause = 1
;persistent =

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 1
;ignorehitpause =
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1
;persistent =

[State 0, ParentVarSet] ;Freeze powerbar
type = ParentVarSet
trigger1 = !time
var(55) = root,power
ignorehitpause = 1
;persistent =


[State 4750, Bar Display frame]
type = Explod
trigger1 = !NumExplod(4749)
anim = 4749
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4749
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, ParentVarSet] ;bar autofill
type = ParentVarAdd
triggerall = var(58)=var(59) ;RTC
triggerall = root,var(54)=0 ;no EMO Exit
triggerall = roundstate=2
triggerall = root,var(52)>=0
triggerall = root,var(52)<2100
triggerall = root,NumExplod(4000)=0 ;don't fill during attacks
triggerall = root,Movetype!=H ; don't fill while being hit/block
trigger1 = root,stateno!=4000 ;don't fill on Emo activation
trigger1 = root,stateno!=4900 ;don't fill on Emo Exit activation
var(52) = 2 + 0*Cond((var(52)>root,var(52)),0,var(52):=(root,var(52)+2));ROOT
ignorehitpause = 1
;persistent =

[State 0, ParentVarSet] ;cooldown
type = ParentVarAdd
triggerall = var(58)=var(59) ;RTC
triggerall = root,var(54)=0 ;no EMO Exit
triggerall = roundstate=2
triggerall = root,NumExplod(4000)=0 ;don't fill during attacks
triggerall = root,Movetype!=H ; don't fill while being hit/block
trigger1 = root,var(52)<0
trigger1 = root,var(52)!=var(52)
var(52) = 3 + 0*(var(52):=0) ;ROOT, reset finisher bar
ignorehitpause = 1
;persistent =
;Var(52): Root, bar autofill
;Var(52): Helper, finisher bar level

[State 0, ParentVarSet] ;bar burning - EMO exit treshold equalizer
type = VarAdd
triggerall = roundstate=2
triggerall = root,stateno!=4901 ; don't apply during emo exit activation
triggerall = root,var(52)<var(52) ;threshold bigger than current level
trigger1 = root,var(54)>0 ;EMO Exit
var(52) = -7 ;+ 0*(var(52):=(root,var(52)));ROOT
ignorehitpause = 1
;persistent =
[State 0, ParentVarSet] ;bar burning - EMO exit treshold same
type = parentVarAdd
triggerall = roundstate=2
triggerall = root,stateno!=4901 ; don't apply during emo exit activation
triggerall = root,var(52)>=var(52) ;threshold equalized
trigger1 = root,var(54)>0 ;EMO Exit
var(52) = -7 + 0*(var(52):=(root,var(52)));ROOT
ignorehitpause = 1
;persistent =

[State 4750, Bar Display middle static]
type = Explod
triggerall = root,var(54)=0 ;no EMO Exit
triggerall = !NumExplod(4748) ;static
trigger1 = root,stateno=4000 ; Emo activation
trigger2 = var(52)>root,var(52)
trigger3 = root,NumExplod(4000)=1
trigger4 = root,Movetype=H
trigger5 = NumExplod(4782) ;overheat
anim = 4748
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4748
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar Display middle anim]
type = Explod
triggerall = !NumExplod(4747) ;anim
trigger1 = var(52)=root,var(52)
trigger2 = root,NumExplod(4000)=0
trigger3 = root,Movetype!=H
trigger4 = root,var(54)>0 ;EMO Exit
anim = 4747
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4747
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Display eye static]
type = Explod
triggerall = !NumExplod(4740) ;explosion
triggerall = !NumExplod(4745) ;overheat
triggerall = !NumExplod(4746) ;normal
trigger1 = !NumExplod(4744) ;static
anim = 4744
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4744
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar eye normal]
type = Explod
triggerall = NumExplod(4746)<2 ;normal
triggerall = root,stateno!=4000 ;don't fill on Emo activation
triggerall = root,stateno!=4900 ;don't fill on Emo Exit activation
trigger1 = var(52)=root,var(52)
trigger2 = root,NumExplod(4000)=0
trigger3 = root,Movetype!=H
anim = 4746
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = 1,1
sprpriority = 10
id = 4746
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar eye overheat]
type = Explod
triggerall = root,stateno!=4000 ;don't fill on Emo activation
triggerall = NumExplod(4745)<2  ;overheat
trigger1 = NumExplod(4782)
anim = 4745
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = 1,1
sprpriority = 10
id = 4745
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Filling]
type = Explod
trigger1 = root,var(52)>=0
trigger1 = root,var(52)<2100 ;1
anim = 4760+floor(root,var(52)/100.0)
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4760
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar threshold]
type = Explod
;triggerall = !NumExplod(4790)
trigger1 = var(52)>=0
trigger1 = var(52)<2100 ;1
anim = 4700+floor(var(52)/100.0)
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4790
bindtime = -1
ontop = 1
ownpal = 1
;trans = addalpha
;alpha = 128,128
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Fill max]
type = Explod
trigger1 = root,var(52)>=2100 ;1
anim = 4781
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = 1,1
sprpriority = 10
id = 4760
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Threshold max]
type = Explod
trigger1 = var(52)>=2100 ;1
anim = 4721
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = -1,1
sprpriority = 10
id = 4790
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Fill overheat]
type = Explod
trigger1 = root,var(52)<0;1
anim = 4782
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = 1,1
sprpriority = 10
id = 4782
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Display 0]
type = Explod
trigger1 = root,var(52)=[0,700)
anim = 4750
pos = 20+(root,var(45)),233-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4750
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar Display 1]
type = Explod
trigger1 = root,var(52)=[700,1400)
anim = 4751
pos = 20+(root,var(45)),233-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4751
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar Display 2]
type = Explod
trigger1 = root,var(52)=[1400,2100)
anim = 4752
pos = 20+(root,var(45)),233-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = 1,1 ;0.5,0.5
sprpriority = 10
id = 4752
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar Display MAX]
type = Explod
trigger1 = !NumExplod(4753)
trigger1 = root,var(52)>=2100
anim = 4753
pos = 20+(root,var(45)),233-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4753
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar Display BROKEN]
type = Explod
trigger1 = root,var(52)<0
anim = 4754
pos = 20+(root,var(45)),233-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4754
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 0, Remove MAX]
type = RemoveExplod
trigger1 = root,var(52)<2100 ;!=2100
trigger2 = root,stateno=3500 ;Overdrive Lv3
trigger3 = root,NumProjID(4900) ;EMO Exit killer
id = 4753
ignorehitpause = 1
;persistent =

[State 4750, engine explosion]
type = Explod
triggerall = !NumExplod(4740)
trigger1 = (root,var(52))<=-1000
trigger2 = root,var(54)>0 ;EMO Exit
trigger2 = var(52)<=0 ;bar empty
trigger3 = root,NumProjID(4900) ;EMO Exit killer
anim = 3607
pos = 20+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = 1,1
sprpriority = 10
id = 4740
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, RemoveEye overheat]
type = RemoveExplod
trigger1 = !NumExplod(4782) ;fill overheat
trigger2 = (root,var(52))<=-1000
trigger3 = NumExplod(4740) ;explosion
trigger4 = root,NumProjID(4900) ;EMO Exit killer
id = 4745
ignorehitpause =  1
;persistent =
[State 0, Remove middle anim]
type = RemoveExplod
trigger1 = root,var(54)=0 ;No EMO Exit
trigger1 = var(52)>root,var(52)
trigger2 = root,NumExplod(4000)=1
trigger3 = root,Movetype=H
trigger4 = var(52)=0;NumExplod(4745)
trigger5 = (root,var(52))<=-1000 ;overheat exceed
trigger6 = root,var(54)>0 ;EMO Exit
trigger6 = var(52)<=0 ;bar empty
trigger7 = root,stateno=3500 ;Overdrive Lv3
trigger8 = root,NumProjID(4900) ;EMO Exit killer
id = 4747
ignorehitpause =  1
;persistent =
[State 0, RemoveEye normal]
type = RemoveExplod
trigger1 = var(52)>root,var(52)
trigger2 = root,NumExplod(4000)=1
trigger3 = root,Movetype=H
trigger4 = var(52)=0;NumExplod(4745)
trigger5 = root,stateno=3500 ;Overdrive Lv3
trigger6 = root,NumProjID(4900) ;EMO Exit killer
id = 4746
ignorehitpause =  1
;persistent =
[State 0, RemoveEye static]
type = RemoveExplod
trigger1 = NumExplod(4745) ;overheat
trigger2 = NumExplod(4746) ;normal
trigger3 = NumExplod(4740) ;explosion
;trigger4 = root,var(54)>0 ;EMO Exit
;trigger4 = var(52)<0 ;bar empty
trigger4 = root,stateno=3500 ;Overdrive Lv3
trigger5 = root,NumProjID(4900) ;EMO Exit killer
id = 4744
ignorehitpause =  1
;persistent =
[State 0, Remove middle static]
type = RemoveExplod
;trigger1 = NumExplod(4745) ;overheat
trigger1 = NumExplod(4746) ;normal
trigger2 = NumExplod(4740) ;explosion
trigger3 = root,var(54)>0 ;EMO Exit
trigger4 = var(52)<0 ;bar empty
trigger5 = root,stateno=3500 ;Overdrive Lv3
trigger6 = root,NumProjID(4900) ;EMO Exit killer
id = 4748
ignorehitpause =  1
;persistent =

[State 0, Remove frame]
type = RemoveExplod
trigger1 = (root,var(52))<=-1000
trigger2 = root,var(54)>0 ;EMO Exit
trigger2 = var(52)<=0 ;bar empty
trigger3 = root,stateno=3500 ;Overdrive Lv3
trigger4 = root,NumProjID(4900) ;EMO Exit killer
id = 4749
ignorehitpause = 1
;persistent =

[State 3033, End]
type = destroyself
;triggerall = root,stateno!=4000
trigger1 = (root,var(52))<=-1000 ;overheat exceed
trigger2 = root,var(54)>0 ;EMO Exit
trigger2 = var(52)<=0 ;bar empty
trigger3 = root,stateno=3500 ;Overdrive Lv3
trigger4 = root,NumProjID(4900) ;EMO Exit killer

; EMOTION GAUGE HELPER P2
[Statedef 4760]
physics = N
velset = 0, 0
sprpriority = 7
anim = 9999

;[State 0, ParentVarSet] ;bar initialize
;type = ParentVarAdd
;trigger1 = root,stateno=4000
;trigger1 = 1 && var(52):=1
;var(52) = 1 ;ROOT
;persistent=0

[State 0, RTC];detect enemy superpause
type = Null
trigger1 = 1
trigger1 = var(58):=gametime
trigger1 = var(59):=root,var(59)
ignorehitpause = 1
;persistent =

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "Root_EMO=%d | H_level=%d | V-Ism=%d | RTC=%d | HTC=%d"
params = (root,var(52)), var(52), (root,var(54)), (root,var(59)), var(59)
ignorehitpause = 1
;persistent =

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 1
;ignorehitpause =
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
flag2 = invisible
;flag3 = roundnotover
ignorehitpause = 1
;persistent =

[State 0, ParentVarSet] ;Freeze powerbar
type = ParentVarSet
trigger1 = !time
var(55) = root,power
ignorehitpause = 1
;persistent =

[State 4750, Bar Display frame]
type = Explod
trigger1 = !NumExplod(4749)
anim = 4749
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = -1,1
sprpriority = 10
id = 4749
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, ParentVarSet] ;bar autofill
type = ParentVarAdd
triggerall = var(58)=var(59) ;RTC
triggerall = root,var(54)=0 ;no EMO Exit
triggerall = roundstate=2
triggerall = root,var(52)>=0
triggerall = root,var(52)<2100
triggerall = root,NumExplod(4000)=0 ;don't fill during attacks
triggerall = root,Movetype!=H ; don't fill while being hit/block
trigger1 = root,stateno!=4000 ;don't fill on Emo activation
trigger1 = root,stateno!=4900 ;don't fill on Emo Exit activation
var(52) = 2 + 0*Cond((var(52)>root,var(52)),0,var(52):=(root,var(52)+2));ROOT
ignorehitpause = 1
;persistent =

[State 0, ParentVarSet] ;cooldown
type = ParentVarAdd
triggerall = var(58)=var(59) ;RTC
triggerall = root,var(54)=0 ;no EMO Exit
triggerall = roundstate=2
triggerall = root,NumExplod(4000)=0 ;don't fill during attacks
triggerall = root,Movetype!=H ; don't fill while being hit/block
trigger1 = root,var(52)<0
trigger1 = root,var(52)!=var(52)
var(52) = 3 + 0*(var(52):=0) ;ROOT, reset finisher bar
ignorehitpause = 1
;persistent =
;Var(52): Root, bar autofill
;Var(52): Helper, finisher bar level

[State 0, ParentVarSet] ;bar burning - EMO exit treshold equalizer
type = VarAdd
triggerall = roundstate=2
triggerall = root,stateno!=4901 ; don't apply during emo exit activation
triggerall = root,var(52)<var(52) ;threshold bigger than current level
trigger1 = root,var(54)>0 ;EMO Exit
var(52) = -7 ;+ 0*(var(52):=(root,var(52)));ROOT
ignorehitpause = 1
;persistent =
[State 0, ParentVarSet] ;bar burning - EMO exit treshold same
type = parentVarAdd
triggerall = roundstate=2
triggerall = root,stateno!=4901 ; don't apply during emo exit activation
triggerall = root,var(52)>=var(52) ;threshold equalized
trigger1 = root,var(54)>0 ;EMO Exit
var(52) = -7 + 0*(var(52):=(root,var(52)));ROOT
ignorehitpause = 1
;persistent =

[State 4750, Bar Display middle static]
type = Explod
triggerall = root,var(54)=0 ;no EMO Exit
triggerall = !NumExplod(4748) ;static
trigger1 = root,stateno=4000 ; Emo activation
trigger2 = var(52)>root,var(52)
trigger3 = root,NumExplod(4000)=1
trigger4 = root,Movetype=H
trigger5 = NumExplod(4782) ;overheat
anim = 4748
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = -1,1
sprpriority = 10
id = 4748
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar Display middle anim]
type = Explod
triggerall = !NumExplod(4747) ;anim
trigger1 = var(52)=root,var(52)
trigger2 = root,NumExplod(4000)=0
trigger3 = root,Movetype!=H
trigger4 = root,var(54)>0 ;EMO Exit
anim = 4747
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = -1,1
sprpriority = 10
id = 4747
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Display eye static]
type = Explod
triggerall = !NumExplod(4740) ;explosion
triggerall = !NumExplod(4745) ;overheat
triggerall = !NumExplod(4746) ;normal
trigger1 = !NumExplod(4744) ;static
anim = 4744
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = -1,1
sprpriority = 10
id = 4744
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar eye normal]
type = Explod
triggerall = NumExplod(4746)<2  ;normal
triggerall = root,stateno!=4000 ;don't fill on Emo activation
triggerall = root,stateno!=4900 ;don't fill on Emo Exit activation
trigger1 = var(52)=root,var(52)
trigger2 = root,NumExplod(4000)=0
trigger3 = root,Movetype!=H
anim = 4746
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = -1,1
sprpriority = 10
id = 4746
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar eye overheat]
type = Explod
triggerall = root,stateno!=4000 ;don't fill on Emo activation
triggerall = NumExplod(4745)<2  ;overheat
trigger1 = NumExplod(4782)
anim = 4745
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = -1,1
sprpriority = 10
id = 4745
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Filling]
type = Explod
trigger1 = root,var(52)>=0
trigger1 = root,var(52)<2100 ;1
anim = 4760+floor(root,var(52)/100.0)
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = -1,1
sprpriority = 10
id = 4760
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar threshold]
type = Explod
;triggerall = !NumExplod(4790)
trigger1 = var(52)>=0
trigger1 = var(52)<2100 ;1
anim = 4700+floor(var(52)/100.0)
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = -1,1
sprpriority = 10
id = 4790
bindtime = -1
ontop = 1
ownpal = 1
;trans = addalpha
;alpha = 128,128
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Fill max]
type = Explod
trigger1 = root,var(52)>=2100 ;1
anim = 4781
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = -1,1
sprpriority = 10
id = 4760
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Threshold max]
type = Explod
trigger1 = var(52)>=2100 ;1
anim = 4721
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = -1,1
sprpriority = 10
id = 4790
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 4750, Bar Fill overheat]
type = Explod
trigger1 = root,var(52)<0;1
anim = 4782
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = -1,1
sprpriority = 10
id = 4782
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999


[State 4750, Bar Display 0]
type = Explod
trigger1 = root,var(52)=[0,700)
anim = 4750
pos = 225+(root,var(45)),233-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4750
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar Display 1]
type = Explod
trigger1 = root,var(52)=[700,1400)
anim = 4751
pos = 225+(root,var(45)),233-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4751
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar Display 2]
type = Explod
trigger1 = root,var(52)=[1400,2100)
anim = 4752
pos = 225+(root,var(45)),233-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = 1,1 ;0.5,0.5
sprpriority = 10
id = 4752
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar Display MAX]
type = Explod
trigger1 = !NumExplod(4753)
trigger1 = root,var(52)>=2100
anim = 4753
pos = 225+(root,var(45)),233-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4753
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 4750, Bar Display BROKEN]
type = Explod
trigger1 = root,var(52)<0
anim = 4754
pos = 225+(root,var(45)),233-(root,var(46))
postype = left
removetime = 1
supermove = 1
scale = 1,1
sprpriority = 10
id = 4754
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
[State 0, Remove MAX]
type = RemoveExplod
trigger1 = root,var(52)<2100 ;!=2100
trigger2 = root,stateno=3500 ;Overdrive Lv3
trigger3 = root,NumProjID(4900) ;EMO Exit killer
id = 4753
ignorehitpause = 1
;persistent =

[State 4750, engine explosion]
type = Explod
triggerall = !NumExplod(4740)
trigger1 = (root,var(52))<=-1000
trigger2 = root,var(54)>0 ;EMO Exit
trigger2 = var(52)<=0 ;bar empty
trigger3 = root,NumProjID(4900) ;EMO Exit killer
anim = 3607
pos = 300+(root,var(45)),220-(root,var(46))
postype = left
removetime = -2
supermove = 1
scale = 1,1
sprpriority = 10
id = 4740
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, RemoveEye overheat]
type = RemoveExplod
trigger1 = !NumExplod(4782) ;fill overheat
trigger2 = (root,var(52))<=-1000
trigger3 = NumExplod(4740) ;explosion
trigger4 = root,NumProjID(4900) ;EMO Exit killer
id = 4745
ignorehitpause =  1
;persistent =
[State 0, Remove middle anim]
type = RemoveExplod
trigger1 = root,var(54)=0 ;No EMO Exit
trigger1 = var(52)>root,var(52)
trigger2 = root,NumExplod(4000)=1
trigger3 = root,Movetype=H
trigger4 = var(52)=0;NumExplod(4745)
trigger5 = (root,var(52))<=-1000 ;overheat exceed
trigger6 = root,var(54)>0 ;EMO Exit
trigger6 = var(52)<=0 ;bar empty
trigger7 = root,stateno=3500 ;Overdrive Lv3
trigger8 = root,NumProjID(4900) ;EMO Exit killer
id = 4747
ignorehitpause =  1
;persistent =
[State 0, RemoveEye normal]
type = RemoveExplod
trigger1 = var(52)>root,var(52)
trigger2 = root,NumExplod(4000)=1
trigger3 = root,Movetype=H
trigger4 = var(52)=0;NumExplod(4745)
trigger5 = root,stateno=3500 ;Overdrive Lv3
trigger6 = root,NumProjID(4900) ;EMO Exit killer
id = 4746
ignorehitpause =  1
;persistent =
[State 0, RemoveEye static]
type = RemoveExplod
trigger1 = NumExplod(4745) ;overheat
trigger2 = NumExplod(4746) ;normal
trigger3 = NumExplod(4740) ;explosion
;trigger4 = root,var(54)>0 ;EMO Exit
;trigger4 = var(52)<0 ;bar empty
trigger4 = root,stateno=3500 ;Overdrive Lv3
trigger5 = root,NumProjID(4900) ;EMO Exit killer
id = 4744
ignorehitpause =  1
;persistent =
[State 0, Remove middle static]
type = RemoveExplod
;trigger1 = NumExplod(4745) ;overheat
trigger1 = NumExplod(4746) ;normal
trigger2 = NumExplod(4740) ;explosion
trigger3 = root,var(54)>0 ;EMO Exit
trigger4 = var(52)<0 ;bar empty
trigger5 = root,stateno=3500 ;Overdrive Lv3
trigger6 = root,NumProjID(4900) ;EMO Exit killer
id = 4748
ignorehitpause =  1
;persistent =

[State 0, Remove frame]
type = RemoveExplod
trigger1 = (root,var(52))<=-1000
trigger2 = root,var(54)>0 ;EMO Exit
trigger2 = var(52)<=0 ;bar empty
trigger3 = root,stateno=3500 ;Overdrive Lv3
trigger4 = root,NumProjID(4900) ;EMO Exit killer
id = 4749
ignorehitpause = 1
;persistent =

[State 3033, End]
type = destroyself
;triggerall = root,stateno!=4000
trigger1 = (root,var(52))<=-1000 ;overheat exceed
trigger2 = root,var(54)>0 ;EMO Exit
trigger2 = var(52)<=0 ;bar empty
trigger3 = root,stateno=3500 ;Overdrive Lv3
trigger4 = root,NumProjID(4900) ;EMO Exit killer

;Satan intro
[Statedef 7051]
type = S
MoveType = I
physics = N
ctrl = 0
anim = 7051
velset = 0,0
sprpriority = 5

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 410, 1] ;punch
type = PlaySnd
triggerall = Anim=7051
trigger1 = AnimElem = 2
trigger2 = AnimElem = 5
trigger3 = AnimElem = 9
value = 7051,0
volumescale = 30
[State 410, 1] ;hit
type = PlaySnd
triggerall = Anim=7051
trigger1 = AnimElem = 3
trigger2 = AnimElem = 7
trigger3 = AnimElem = 11
value = 7051,1
volumescale = 30

[State 0, Explod]
type = Explod
triggerall = Anim=7051
trigger1 = AnimElem = 3
trigger2 = AnimElem = 7
trigger3 = AnimElem = 11
anim = 7020+10*random%2
ID = 7051
pos= 90,-70
postype = p1
facing = IfElse(random<500,1,-1)
vfacing = IfElse(random<500,1,-1)
scale = 0.5,0.5
bindtime = 1
random = 5,10
removetime = -2
pausemovetime = 9999
sprpriority = 10
ontop = 1
shadow = 0,0,0
ownpal = 0
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim=7051
trigger1 = root,anim=705
trigger1 = root,animelemtime(7)=0
value = 7052
;ignorehitpause =
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = Anim=7052
id = 7051
;ignorehitpause =
;persistent =


[State 410, 1] ;ground bounce
type = PlaySnd
triggerall = Anim=7052
trigger1 = AnimElem = 6
value = 15000,0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim=7052
trigger1 = !animtime
value = 7053
;elem = 1
;ignorehitpause =
;persistent =

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Anim=7053
statetype = A       ;S,A,C,L
movetype = I        ;I,A,H
physics = N         ;A,C,S,N
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = Anim=7053
x = -5
y = -6
;ignorehitpause =
persistent = 0

[State 410, 1] ;away scream
type = PlaySnd
triggerall = Anim=7053
trigger1 = AnimElemTime(2) = 0
value = 7051,10

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = pos x != [-360,360]
;trigger2 = root,stateno!=705


;===================================================
; Limit basics comboability
[Statedef 15999]
type    = S
movetype= A
physics = N
anim = 15999
sprpriority = -5

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, destroy]
type = DestroySelf
trigger1 = numenemy
trigger1 = enemynear, movetype != H || (enemynear, stateno = [120,155]) || enemynear, ctrl
trigger2 = time = 24

;======================================================================
;LAND FX
[Statedef 17100]
type=A
movetype=I
physics=N
anim=15999
sprpriority=1
velset=0,0

[state 17100,bind]
type = bindtoparent
trigger1 = !time
pos = -11,0

[state 17100, Landing Effect]
type=explod
trigger1=!time
anim=17100
id=17100
pos=0,0
postype=P1
sprpriority=-3
ownpal=1
supermovetime=-1

[state 17100]
type=removeexplod
trigger1=time>10

[State 17100]
type=destroyself
trigger1=time>10

;===================================================
;Pulse Effect during fall recovery (taken from Possessed Heita by The_None)
[Statedef 52100]
type    = S
movetype = I
physics = S
sprpriority = 4
anim = 15999
ctrl = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT

[State 0, PosAdd]
type = PosAdd
trigger1 = 1
x = ifelse(root,stateno=5201,ceil(parentdist x/3.0),parentdist x)
y = parentdist y

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(0) = parent,anim

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(1) = parent,animelemno(0)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time
value = var(0)
elem = var(1)

[State 0, VarSet]
type = VarAdd
trigger1 = time
fvar(0) = 11.2

[State 0, VarSet]
type = VarAdd
trigger1 = time
fvar(1) = 0.015

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
scale = 1+fvar(1),1+fvar(1)

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 1
add = floor(0-fvar(0)),floor(0-fvar(0)),floor(0-fvar(0))

[State 0, ]
type = DestroySelf
trigger1 = root,stateno != 5201
trigger1 = root,stateno != 5210

;==========================================================
; SUPER BG - Street Fighter 3
[Statedef 19875]
type = S
velset = 0,0
sprpriority = 0
anim = 15999
ctrl = 0

[State 10500, snd]
type = playsnd
trigger1 = !time
value = 9,0

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = time <= 55
flag = noFG

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic

[State 10000, Explod]; White BG
type = Explod
trigger1 = time = 0
anim = 19877
id = 19875
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindtime = -1
ownpal = 1
removetime = 99999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999

scale = 1.20,1.20
ignorehitpause = 1
persistent = 0

[State 10000, Explod SF3]
type = Explod
trigger1 = time = 0
anim = 19875
id = 10000
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindtime = -1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
scale = 1.20*0.9,1.20*1.05
ignorehitpause = 1
persistent = 0

[State 10000, pause]
type = Pause
trigger1 = Time = 0
time = 40
movetime = 40

[State 10000, RemoveExplod]
type = RemoveExplod
trigger1 = time = 44
id = 10000

[State 10000, RemoveExplod]
type = RemoveExplod
trigger1 = time = 55
id = 10500

;==========================================================
; SUPER BG - Super DBZ (Physics)
[Statedef 19885]
type = S
velset = 0,0
sprpriority = 0
anim = 15999
ctrl = 0

[State 1000, shake]
type = EnvShake
trigger1 = !(time%4) && time<150
time=4
freq=80
ampl=7

[State 10500, snd]
type = playsnd
trigger1 = !time
value = 9,0

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
flag2 = nokoslow
ignorehitpause = 1

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = nobardisplay
ignorehitpause = 1

[State 10000, Explod]; White BG
type = Explod
trigger1 = time = 0
anim = 19884
id = 19884
pos =  160,120
postype = left
sprpriority = -4
facing = 1
bindtime = -1
ownpal = 1
pausemovetime = 99999999999999
supermovetime = 99999999999999
scale = 1.20,1.20
ignorehitpause = 1
persistent = 0
removetime = -2

[State 10000, Explod Krak]
type = Explod
trigger1 = time = 0
anim = 19885
id = 19885
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindtime = -1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
scale = 1,1
ignorehitpause = 1
persistent = 0

[State 10000, Scale Explod]
type = ModifyExplod
trigger1 = time>6
scale = 1+.01*time, 1+.01*time
id = 19885

[State 10000, RemoveExplod Krak]
type = RemoveExplod
trigger1 = time = 23 ;44
id = 19885

[State 10000, Explod Space BG]
type = Explod
trigger1 = time = 23
anim = 19886
id = 19886
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindtime = -1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
scale = 1.3,1.3
ignorehitpause = 1
persistent = 0

[State 10000, Explod planet left]
type = Explod
trigger1 = time = 23
anim = 19887
id = 19886
pos =  0,240
postype = left
sprpriority = -6
facing = 1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
scale = 1.2,1.2
ignorehitpause = 1
persistent = 0
;vel = -.2,0
bindtime = -1

[State 10000, Explod planet right]
type = Explod
trigger1 = time = 23
anim = 19888
id = 19886
pos =  320,240
postype = left
sprpriority = -6
facing = 1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
scale = 1.2,1.2
ignorehitpause = 1
persistent = 0
;vel = .2,0
bindtime = -1

[State 1000, Helper]
type = Helper
trigger1 = time>=23 && time<70 && !(time%5) && numhelper(19890)<80 && numhelper(19891)<80

name = "rocks"
id = 19890
pos = 160,20
postype = left
facing = 1
stateno = 19890
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 13300, black screen fade]
type = Explod
trigger1 = Time = 60
anim = 19883   ;2771
ID = 2771
postype = left
pos = 0,-50
bindtime = -1
removetime = 91
pausemovetime = 91
ontop = 1
scale = 2,3

[State 10000, RemoveExplod Krak]
type = RemoveExplod
trigger1 = time = 150
id = 19886

;------------------------------------------------------
;Rocks going up
[Statedef 19890]
type = A
movetype = I
physics = N
anim = 15999

[State 1003, Helper]
type = Helper
trigger1 = !time

name = "rocks"
id = 19891
pos = ((random%320)),10*(random%13)
postype = left
facing = 1
stateno = 19891
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .5
size.yscale = .5

[State 1003, Helper]
type = Helper
trigger1 = !time

name = "rocks"
id = 19891
pos = ((random%320)+320),10*(random%13)
postype = left
facing = 1
stateno = 19891
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .5
size.yscale = .5

[State 1003, Helper]
type = Helper
trigger1 = !time

name = "rocks"
id = 19891
pos = ((random%320)-320),10*(random%13)
postype = left
facing = 1
stateno = 19891
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .5
size.yscale = .5

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = time=2

;-----------------
[Statedef 19891]
type = A
movetype = I
physics = N
anim = 19890 + random%6
sprpriority = -5

[State 1004, assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 1004, vel]
type = velset
trigger1 = !time
y = -3-random%7

[State 1004, vel]
type = varset
trigger1 = !time
var(10) = random%2

[State 1004, assert]
type = angledraw
trigger1 = 1
value = ifelse(var(10)=0,5*time,-5*time)

[State 1004, DestroySelf]
type = DestroySelf
trigger1 = time > 300
trigger2 = pos Y < -340
trigger3 = root,stateno = 180

;==========================================================
; SUPER BG - Super DBZ (Ki attacks)
[Statedef 19892]
type = S
velset = 0,0
sprpriority = 0
anim = 15999
ctrl = 0

[State 3001, screen]
type = PosSet
trigger1 = !time
x = 0
y = -ceil(screenpos Y)
ignorehitpause = 1

[State 3001, screen]
type = PosSet
trigger1 = 1
x = 0
ignorehitpause = 1

[State 1000, shake]
type = EnvShake
trigger1 = !(time%4) && time<150
time=4
freq=80
ampl=7

[State 10500, snd]
type = playsnd
trigger1 = !time
value = 9,0

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
flag2 = nokoslow
ignorehitpause = 1

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = nobardisplay
ignorehitpause = 1

[State 10000, Explod]; White BG
type = Explod
trigger1 = !time
anim = 957
id = 11111
pos =  0,-30
postype = left
sprpriority = -7
facing = 1
bindtime = -1
ownpal = 1
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1
scale = 2,2

[State 10000, Explod Zwang]
type = Explod
trigger1 = time = 0
anim = 19896
id = 19896
pos =  160,120
postype = left
sprpriority = -5
facing = 1
bindtime = -1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
ignorehitpause = 1
scale = .9,1.2

[State 10000, Scale Explod]
type = ModifyExplod
trigger1 = time>50
scale = .9+.005*(time-50), 1.2+.005*(time-50)
id = 19896

[State 1003, Helper]
type = Helper
trigger1 = !time

name = "yellow_BG"
id = 19897
pos = 0,0
postype = left
facing = 1
stateno = 19897
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
persistent = 0

[State 13300, white screen fade]
type = Explod
trigger1 = Time = 60
anim = 19883
ID = 2771
postype = left
pos = 0,-50
bindtime = -1
removetime = 91
pausemovetime = 91
ontop = 1
scale = 2,3
ignorehitpause = 1

[State 10000, RemoveExplod zwang]
type = RemoveExplod
trigger1 = time = 140
id = 19896
[State 10000, RemoveExplod yellow BG]
type = RemoveExplod
trigger1 = time = 140
id = 19897
[State 10000, RemoveExplod white BG]
type = RemoveExplod
trigger1 = time = 140
id = 11111

[State 10000, pause]
type = Pause
trigger1 = !time
time = 20
movetime = 20
ignorehitpause = 1

;--------------------------------------
;Yellow Super BG Helper
[Statedef 19897]
type = S
movetype = I
physics = N
anim = 19897
sprpriority = -6

[State 1004, assert]
type = bindtoparent
trigger1 = 1
pos = 0,120
ignorehitpause = 1

[State 1004, assert]
type = assertspecial
trigger1 = 1
flag = noshadow
flag2 = noFG
ignorehitpause = 1

[State 1004, assert]
type = angledraw
trigger1 = time < 50
value = 10*time
scale = .7,.7
ignorehitpause = 1

[State 1004, assert]
type = angledraw
trigger1 = time >= 50
value = 10*time
scale = .7+.01*(time-50),.7+.01*(time-50)
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
;trigger1 = roundstate=4
trigger1 = time = 140
;ignorehitpause =
;persistent =

;==========================================================
; SUPER BG - Jojo's Bizarre Adventure
[Statedef 19900]
type    = A
movetype= I
physics = N
ctrl = 0
anim = 15999
sprpriority = -21

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19910
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindtime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19911
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindtime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19912
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindtime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19913
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindtime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19900
id = 19900
pos = 0,0
postype = back
sprpriority = 5
bindtime = -1
scale = .84, 1.07
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1
persistent = 0
ontop = 1

[State 10500, snd]
type = playsnd
trigger1 = !time
value = 9,0

[state haha]
type = varset
trigger1 = time = 0
var(3) = 0

[state haha]
type = varadd
trigger1 = time >= 5
trigger1 = var(3) < 220
var(3) = 5

[State that starts the inverted effect]
type           = PalFX
trigger1       = time >= 5
add            = var(3),var(3),var(3)
time           = 1
ignorehitpause = 1

[State 2030, 0]
type = AssertSpecial
Trigger1 = Time < ifelse(matchover, 120, 50)
flag = nofg
flag2 = nobardisplay
ignorehitpause = 1

[State haha]
type = RemoveExplod
trigger1 = Time = ifelse(matchover, 120, 50)
id = 8001

[State ChangeState!]
type = DestroySelf
trigger1 = RoundState = 0

;====================================
; Broken Back - BG Arms + legs
[Statedef 245947]
type = S
movetype = H
physics = N
velset = 0,0
anim = 5947

[State 2260, bind]
type = bindtoroot
trigger1 = 1
pos = 0,0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 126

;=========================================
;Debris generator
[Statedef 66853]
type = A
movetype = I
physics = N
Anim = 15999

[State 1003, Helper 1]
type = Helper
trigger1 = 1
Helpertype = Normal
name = "Debris"
id = 66854
pos = 9,0
postype = p1
facing = Cond(random%2,1,-1) ;facing
stateno = 66854
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
;size.xscale = .125
;size.yscale = .125

[State 1003, Helper 2]
type = Helper
trigger1 = 1
Helpertype = Normal
name = "Debris"
id = 66854
pos = 6,0
postype = p1
facing = Cond(random%2,1,-1) ;facing
stateno = 66854
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
;size.xscale = .125
;size.yscale = .125

[State 1003, Helper 3]
type = Helper
trigger1 = 1
Helpertype = Normal
name = "Debris"
id = 66854
pos = 3,0
postype = p1
facing = Cond(random%2,1,-1) ;facing
stateno = 66854
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
;size.xscale = .125
;size.yscale = .125

[State 1003, Helper 4]
type = Helper
trigger1 = 1
Helpertype = Normal
name = "Debris"
id = 66854
pos = -3,0
postype = p1
facing = Cond(random%2,1,-1) ;facing
stateno = 66854
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
;size.xscale = .125
;size.yscale = .125

[State 1003, Helper 5]
type = Helper
trigger1 = 1
Helpertype = Normal
name = "Debris"
id = 66854
pos = -6,0
postype = p1
facing = Cond(random%2,1,-1) ;facing
stateno = 66854
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
;size.xscale = .125
;size.yscale = .125


[State 1003, Helper 6]
type = Helper
trigger1 = 1
Helpertype = Normal
name = "Debris"
id = 66854
pos = -9,0
postype = p1
facing = Cond(random%2,1,-1) ;facing
stateno = 66854
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
;size.xscale = .125
;size.yscale = .125


[State 1003, DestroySelf]
type = DestroySelf
trigger1 = Time=2




;Debris
[Statedef 66854]
type = A
movetype = I
physics = N
Anim = 6685 + random%3
sprpriority = 7

[State 0, VelSet]
type = VelSet
trigger1 = !Time
x = 5+random%5
y = -5-random%7
;ignorehitpause =
;persistent =

[State 0, Gravity]
type = Gravity
trigger1 = 1
;ignorehitpause =
;persistent =

[State 1004, assert]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1004, vel]
type = VarSet
trigger1 = !Time
var(10) = random%2

[State 1004, assert]
type = AngleDraw
trigger1 = 1
value = IfElse(var(10)=0,5*Time,-5*Time)
ignorehitpause = 1

[State 1004, DestroySelf]
type = DestroySelf
trigger1 = pos y > -vel y



;========================<EXPLODSIVE BUFFERING HELPER>=============================
[StateDef 90000005]
type = A
physics = N
moveType = I
anim = 1
velSet = 0,0
ctrl = 0

[State 90000005, Turn]
type = Turn
trigger1 = (enemy, NumExplod(94646464) || enemy, NumExplod(92468246)) && !var(0)
trigger2 = !enemy, NumExplod(94646464) && !enemy, NumExplod(92468246) && var(0)
ignoreHitPause = 1

[State 90000005, Reverse Left/Right]
type = VarSet
trigger1 = (enemy, NumExplod(94646464) || enemy, NumExplod(92468246)) && !var(0)
var(0) = 1
ignoreHitPause = 1

[State 90000005, Reset Turn Variable]
type = VarSet
trigger1 = !enemy, NumExplod(94646464) && !enemy, NumExplod(92468246) && var(0)
var(0) = 0
ignoreHitPause = 1

[State 90000005, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "by JustMorphPointman"
ignoreHitPause = 1
