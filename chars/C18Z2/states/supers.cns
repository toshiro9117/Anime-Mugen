;================================
; CNS File for C18 Z2 by Nico_18 & XGargoyle
; Super and Hyper moves
;================================
;ETERNAL REVOLUTION
[Statedef 3000]
type = S
physics = S
movetype = A
anim = 3000
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(!NumHelper(4750),-1000,0)
facep2 = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1
[State 4000, threshold usage]
type = VarAdd
triggerall = NumHelper(4750)
trigger1 = !time
var(52)=-700
ignorehitpause = 1
;persistent =

[State 4900, Projectile] ;EMO Killer
type = Projectile
trigger1 = var(54)>0 ;EMO Exit active
ProjID = 4900
projanim = 9999
projremove = 3;4
projremovetime = 3;4
ignorehitpause = 1
;persistent =
;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State -2, VarSet] ;reset Blitz Deadend cancel
type = VarSet
trigger1 = !time
var(40)=0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nojugglecheck
ignorehitpause = 1


[State 9000, snd] ;attack calling
type = playsnd
triggerall = random<300
trigger1 = time=1
value = 3010,random%2
channel = 0
volumescale = 300
persistent = 0
[State 9000, snd] ;assorted voices
type = playsnd
triggerall = random<500
trigger1 = time=2
value = 9000,random%6
channel = 0
lowpriority = 1
volumescale = 300
persistent = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 =  AnimElemTime(2)=0
statetype = A       ;S,A,C,L
movetype = A        ;I,A,H
physics = N         ;A,C,S,N
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 =  AnimElemTime(2)=0
x = 0.1
y = -0.2
;ignorehitpause =
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = animelemtime(5)<0
flag = noBG
flag2 = noFG

[State 3000, nhb]
type = nothitby
trigger1 = time<=45 ;animelemtime(5)<0
time = 1
value = SCA

[State 3000, superpause]
type = superpause
trigger1 = time=10
time = 39
p2defmul = 1
unhittable = 1
anim = -1
sound = s3000,0 ;s2010,0
darken = 0
movetime = 39

[State 0, Super FX]
type = Explod
trigger1 = time = 10 ;5
anim = 3010
id = 3010
pos = -125,28
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 45
color=0
mul=0,0,0

[State 0, VelSet]
type = VelSet
trigger1 = time=45
x = 6
y = -14
ignorehitpause = 1
;persistent =

[State 40, 4]; fall
type = Veladd
trigger1 = time>=45
Y = 0.9

[State 800, hit]
type = hitdef
trigger1 = time>0
attr = A,HT
hitflag = MAF
priority = 1,Miss
sparkno = -1
p1facing = 1
p2facing = 1
;p1stateno = 1401
guard.dist = 0
fall = 1
fall.recover = 0
hitsound = s3000,5 ;s800,1
ID = 3000
numhits = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(3000)
trigger1 = MoveHit=1
value = 3002 + 0*Cond((target,statetype=C),var(9):=(target,const(size.head.pos.y)) ,var(9):=(target,const(size.mid.pos.y)))
ignorehitpause = 1
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = time>=45
trigger1 = pos Y>0
value = 3001
ctrl = 0
;ignorehitpause =
;persistent =

;ER Whiff
[Statedef 3001]
type = C
physics = C
movetype = I
anim = 3001
ctrl = 0
velset = 0,0
sprpriority = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0
ignorehitpause = 1
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

;ER Turbine
[Statedef 3002]
type = A
physics = N
movetype = A
anim = 3002
ctrl = 0
velset = 0,0
sprpriority = 5

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 =  1
value = 0
ignorehitpause = 1
;persistent =


[State 0, TargetState]
type = TargetState
trigger1 = numtarget
trigger1 = !time
value = 3020+2*(target,selfanimexist(5252))
ignorehitpause = 1
;persistent =

[State 0, PosAdd]
type = PosAdd
trigger1 = NumTarget
trigger1 = !time
x = 50
y = var(9);-43
ignorehitpause = 1
;persistent =

[State 0, TargetBind]
type = TargetBind
trigger1 = numtarget
time = 1
pos = 0,0+50*(target,selfanimexist(5252))-50*(target,name="Vegetto Z2")
ignorehitpause = 1
;persistent =

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = time>0
trigger1 = time%12=0
value = -10
ID = -1
kill = 0
absolute = 0
;ignorehitpause =

[State 0, HitAdd]
type = HitAdd
trigger1 = time>0
trigger1 = time%12=0
value = 1
ignorehitpause = 1
;persistent =


[State 0, PlaySnd]
type = null;PlaySnd
trigger1 = time=16 ;!time
value = 3000,12 ;10 ;11
channel = 4
volumescale = 255
loop = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=9 ;!time
trigger2 = time=36
trigger3 = time=57
trigger4 = time=75
trigger5 = time=89
trigger6 = time=104
trigger7 = time=116
;trigger8 = time=128
value = 3000,12 ;10 ;11
channel = -1 ;4
volumescale = 255


[State 0, PosAdd] ;levitation
type = PosAdd
triggerall = gametime%10=0
trigger1 = time>0
y = -2;-1
;ignorehitpause =
;persistent =

[State 801,tornado]
type = Explod
trigger1 = time=52
anim = 3012 ;3011
id = 3011
;pos = 10,80
;postype = p1
;postype = left
;pos = floor(ScreenPos X)+5*facing,floor(fvar(15))-120 ;30
postype = p1
pos = 0,0
sprpriority = 2
removetime = 78 ;72 ;78
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=52
value = 3000,13 ;10 ;11
channel = -1
volumescale = 255

[State 0, Advance Frame]
type = ChangeAnim
;triggerall = time=[51,100]
triggerall = time=[52,78]
triggerall = gametime%2=0
trigger1 = animtime<-3 ;-2
value = Anim
elem = AnimElemno(0)+1
ignorehitpause = 1
[State 0, Advance Frame]
type = ChangeAnim
;triggerall = time=[101,150]
triggerall = time=[79,104]
triggerall = gametime%2=0
trigger1 = animtime<-3 ;-2
value = Anim
elem = AnimElemno(0)+2;1
ignorehitpause = 1
[State 0, Advance Frame]
type = ChangeAnim
;triggerall = time=[151,200]
triggerall = time=[105,130]
triggerall = gametime%2=0
trigger1 = animtime<-3 ;-2
value = Anim
elem = AnimElemno(0)+3;1
ignorehitpause = 1

[State 801,tornado]
type = null;Explod
trigger1 = time=124
anim = 3012
id = 3012
postype = left
pos = floor(ScreenPos X)+5*facing,floor(fvar(15))-10
sprpriority = 2
removetime = -2
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1

[State 0, StopSnd]
type = StopSnd
trigger1 = time=130
channel = 4
;ignorehitpause =
;persistent =


[State 0, ChangeState]
type = ChangeState
trigger1 = time=130 ;200
value = 3003
ctrl = 0

;ER Spin
[Statedef 3003]
type = A
physics = N
movetype = A
anim = 3003
ctrl = 0
velset = 0,0
sprpriority = 1

[State 0, TargetState]
type = TargetState
trigger1 = numtarget
trigger1 = target,selfanimexist(5252)
value = 3021
ID = -1
ignorehitpause = 1
persistent = 0


;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 =  1
value = 0
ignorehitpause = 1
;persistent =

[State 0, PlaySnd] ;spin woosh
type = PlaySnd
trigger1 = !time
value = 3003,0
channel = -1 ;4
;ignorehitpause =
;persistent =

[State 0, TargetBind non-Z2]
type = TargetBind
triggerall = numtarget
triggerall = target,stateno=3020
trigger1 = Anim=3003
trigger2 = Anim=3004
trigger2 = AnimElemTime(3)<=0
time = 1
;pos = 0+40*(target,stateno=3021),0+80*(target,stateno=3021)+40*(target,name="Piccolo Z2")-40*(target,name="Vegetto Z2")-30*(target,name="Babidi Z2") ;hacks
pos = 0,0
ignorehitpause = 1
;persistent =

[State 0, TargetBind Z2]
type = TargetBind
triggerall = numtarget
triggerall = target,stateno=3021
trigger1 = Anim=3003
trigger2 = Anim=3004
trigger2 = AnimElemTime(3)<=0
time = 1
pos = 0,50-50*(target,name="Vegetto Z2");-abs(target,const(size.mid.pos.y))
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim=3003
trigger1 = !animtime
value = 3004
;elem = 1
ignorehitpause = 1
;persistent =

[State 0, PlaySnd] ;knee drop
type = PlaySnd
trigger1 = Anim=3004
trigger1 = AnimElemTime(1)=0
value = 3004,0
channel = 4
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = Anim=3004
trigger1 = AnimElemTime(3)>0
y = 16
ignorehitpause = 1
persistent = 0

[State 800, hit]
type = hitdef
trigger1 = Anim=3004
attr = A,HT
hitflag = MAF
priority = 1,Miss
sparkno = -1
p1facing = 1
p2facing = 1
;p1stateno = 1401
guard.dist = 0
fall = 1
fall.recover = 0
hitsound = s3004,1 ;s800,1
ID = 3004
numhits = 1 ;0

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(3004)
trigger1 = MoveHit=1
value = 3004
ignorehitpause = 1
persistent = 0

;ER Drop
[Statedef 3004]
type = A
physics = N
movetype = A
anim = 3005
ctrl = 0
velset = 0,0
sprpriority = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 =  1
value = 0
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = !time
y = 16
ignorehitpause = 1
;persistent = 0

[State 0, TargetState]
type = TargetState
trigger1 = !time
value = 856
ignorehitpause = 1
;persistent =

[State 0, TargetBind]
type = TargetBind
trigger1 = vel y!=0
time = 1
pos = 0,0
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim] ;freeze drop
type = ChangeAnim
trigger1 = pos y <-10
value = 3005
elem = 1
;ignorehitpause =
;persistent =

[State 0, PlaySnd] ;ground slam
type = PlaySnd
trigger1 = pos y >=0
value = 15000,0
volumescale = 255
ignorehitpause = 1
persistent = 0


[State 801, EnvShake]
type = EnvShake
trigger1 = pos y >=0
time = 12 ;8
ampl = -10
freq = 120
persistent = 0

[State 0, VelSet]
type = VelSet
trigger1 = pos y >=0
x = 0
y = 0
ignorehitpause = 1
persistent = 0

[State 0, PosSet]
type = PosSet
trigger1 = vel Y=0
y = 0
ignorehitpause = 1
;persistent =

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = vel Y=0
value = -100
ID = -1
kill = 1
absolute = 0
;ignorehitpause =
persistent = 0

[State 0, Projectile]
type = Projectile
trigger1 = numtarget
trigger1 = target,alive=0
ProjID = 3001
projanim = 15999
projremovetime = 1
ignorehitpause=1

[State 801,crater]
type = Explod
trigger1 = vel Y=0
anim = 3014
id = 3014
;pos = 10,80
;postype = p1
postype = left
pos = floor(ScreenPos X)+5*facing,floor(fvar(15))+10
sprpriority = -5
removetime = -2
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1
persistent = 0


[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Anim=3005
trigger1 = AnimElemTime(4)=0
statetype = A       ;S,A,C,L
movetype = I        ;I,A,H
physics = N         ;A,C,S,N
;ignorehitpause =
;persistent =

[State 0, Turn]  ;hack
type = Turn
trigger1 = Anim=3005
trigger1 = AnimElemTime(4)=0
;ignorehitpause =
;persistent =


[State 0, VelSet]
type = VelSet
trigger1 = Anim=3005
trigger1 = AnimElemTime(4)=0
x = -3 ;4
y = -7 ;new
ignorehitpause = 1
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = Anim=3005
trigger1 = AnimElemTime(4)=0
value = 50
ctrl = 1
;ignorehitpause =
;persistent =


[State 0, ChangeState] ;no longer used
type = ChangeState
trigger1 = Anim=3005
trigger1 = !animtime
value = 0
ctrl = 1
;anim =
;ignorehitpause =
;persistent =


;Thrown by ER (non Z2)
[Statedef 3020]
type = A
movetype = H
physics = N
velset = 0,0
sprpriority = 0

[State 0, PlayerPush]
type = PlayerPush
trigger1 =  1
value = 0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1
;persistent =

[State 182, 1]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = gethitvar(isbound)
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1

[State 0, NotHitBy]
type = HitBy
trigger1 = !gethitvar(isbound)
value = A,HT
time = 1
ignorehitpause = 1

[State 802, anim]
type = changeanim2
trigger1 = !time
value = 3020

[State 0, PosSet]
type = PosAdd
trigger1 = !gethitvar(isbound)
y = 60
ignorehitpause = 1
persistent = 0


[State 820, 2]
type = SelfState
;trigger1 = time>50
trigger1 = !gethitvar(isbound)
value = 5020

;Thrown by ER (Z2)
[Statedef 3021]
type = A
movetype = H
physics = N
velset = 0,0
sprpriority = 0

[State 0, PlayerPush]
type = PlayerPush
trigger1 =  1
value = 0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1
;persistent =

[State 182, 1]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = gethitvar(isbound)
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1

[State 0, NotHitBy]
type = HitBy
trigger1 = !gethitvar(isbound)
value = A,HT
time = 1
ignorehitpause = 1

[State 802, anim]
type = changeanim
trigger1 = !time
value = 5252

[State 0, PosSet]
type = null;PosAdd
trigger1 = !time
y = -20+abs(const(size.mid.pos.y)) ;-20
ignorehitpause = 1
persistent = 0

[State 2311, AngleDraw]
type = null;AngleDraw
trigger1 = 1
value = -45
scale = 1,1
ignorehitpause = 1
;persistent =

[State 2311, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -90;+2*time  ;disabled rotation
scale = 1,1
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = !time
y = -1
;ignorehitpause =
;persistent =


[State 820, 2]
type = SelfState
trigger1 = time>50
;trigger1 = !gethitvar(isbound)
value = 5020

;Thrown by ER (Spin Z2)
[Statedef 3022]
type = A
movetype = H
physics = N
velset = 0,0
anim = 5252
sprpriority = 0

[State 0, PlayerPush]
type = PlayerPush
trigger1 =  1
value = 0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1
;persistent =

[State 182, 1]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0

[State 802, anim]
type = null;changeanim
trigger1 = !time
value = 5252

[State 0, NotHitBy]
type = NotHitBy
trigger1 = gethitvar(isbound)
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1

[State 0, NotHitBy]
type = HitBy
trigger1 = !gethitvar(isbound)
value = A,HT
time = 1
ignorehitpause = 1


[State 2311, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -90
scale = 1,1
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosAdd
trigger1 = !gethitvar(isbound)
y = 60
ignorehitpause = 1
persistent = 0


[State 820, 2]
type = SelfState
;trigger1 = time>50
trigger1 = !gethitvar(isbound)
value = 5020

;CASCADE LP
[Statedef 3100]
type = S
physics = S
movetype = A
anim = 3100
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(!NumHelper(4750),-1000,0)
facep2 = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1
[State 4000, threshold usage]
type = VarAdd
triggerall = NumHelper(4750)
trigger1 = !time
var(52)=-700
ignorehitpause = 1
;persistent =
[State 4900, Projectile] ;EMO Killer
type = Projectile
trigger1 = var(54)>0 ;EMO Exit active
ProjID = 4900
projanim = 9999
projremove = 3;4
projremovetime = 3;4
ignorehitpause = 1
;persistent =
;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State -2, VarSet] ;reset Blitz Deadend cancel
type = VarSet
trigger1 = !time
var(40)=0
ignorehitpause = 1
;persistent =

[State 0, VarSet] ;reset buffer variable
type = VarSet
trigger1 = !time
var(3)=0
ignorehitpause = 1
;persistent =

[State 9000, snd] ;attack calling
type = playsnd
triggerall = random<300
trigger1 = time=1
value = 3100,random%2
channel = 0
volumescale = 300
persistent = 0
[State 9000, snd] ;assorted voices
type = playsnd
triggerall = random<500
trigger1 = time=2
value = 9000,random%6
channel = 0
lowpriority = 1
volumescale = 300
persistent = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = animelemtime(5)<0
flag = noBG
flag2 = noFG

[State 3000, nhb]
type = nothitby
trigger1 = time<=45 ;animelemtime(5)<0
time = 1
value = SCA

[State 3000, superpause]
type = superpause
trigger1 = time=10
time = 40
p2defmul = 1
unhittable = 1
anim = -1
sound = s3000,0 ;s2010,0
darken = 0
movetime = 40

[State 0, Super FX]
type = Explod
trigger1 = time = 10 ;5
anim = 3010
id = 3010
pos = -102,-35 ;-125,28
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 1200, No Push Dummy]
type = Helper
triggerall = !NumHelper(3190)
trigger1 = time=10
name = "Cascade - No Push"
id = 3190
stateno = 3190
size.ground.back = Const(size.ground.back) +20
size.ground.front = Const(size.ground.front) +20
size.height = Const(size.height) +60

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 45
color=0
mul=0,0,0

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime ;time>=45
value = 3101
ctrl = 0
;ignorehitpause =
;persistent =

;CASCADE LP LAUNCH
[Statedef 3101]
type = S
physics = S
movetype = A
anim = 3101
ctrl = 0
velset = 0,0
sprpriority = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, Width]
type = Width
trigger1 = 1
value = 0,0
;ignorehitpause =
;persistent =

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 1000, cascade shield]
type = Helper
triggerall = !NumHelper(3150)
trigger1 = !time
helpertype = normal
name = "Cascade shield"
postype = P1
pos = 3,-24
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3150
id = 3150

[State 1400, VarSet] ;Cascade Lv.1
type = VarSet
triggerall = !var(3)
triggerall = AILevel<=0
triggerall = time >0
; Corresponds to command = "2QCB"
triggerall = ((ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && (NumExplod(90030101) || NumExplod(90030114))) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && (NumExplod(90030016) || NumExplod(90030003))))
triggerall = power>=1000
trigger1 = NumExplod(90000210)
trigger1 = var(3):=3110*NumExplod(90000210) ;MP
trigger2 = NumExplod(90000220)
trigger2 = var(3):=3120*NumExplod(90000220)  ;SP
var(3) = var(3)

[State 1000, cascade pillar]
type = Helper
triggerall = !NumHelper(3155)
trigger1 = time=3
helpertype = normal
name = "Cascade pillar"
postype = P1
pos = Cond(frontedgedist<100,40,100),11 ;100,11
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3155
id = 3155

[State 1000, cascade Crater]
type = Helper
triggerall = !NumHelper(3140)
trigger1 = time=3
helpertype = normal
name = "Cascade Crater"
postype = P1
pos = Cond(frontedgedist<100,50,100),11 ;100,11
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3140
id = 3140

[State 0, ChangeState]
type = ChangeState
trigger1 = time>=66
value = 3102
ctrl = 0
;ignorehitpause =
;persistent =

;CASCADE LP END
[Statedef 3102]
type = S
physics = S
movetype = I
anim = 3102
ctrl = 0
velset = 0,0
sprpriority = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 1000, To buffered move]
type = Changestate
triggerall = p2movetype=H
trigger1 = var(3)!=0
trigger1 = AnimElemTime(3)=0
value = var(3)+1


[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;ignorehitpause =
;persistent =

;CASCADE MP
[Statedef 3110]
type = S
physics = S
movetype = A
anim = 3100
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(!NumHelper(4750),-1000,0)
facep2 = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1
[State 4000, threshold usage]
type = VarAdd
triggerall = NumHelper(4750)
trigger1 = !time
var(52)=-700
ignorehitpause = 1
;persistent =
[State 4900, Projectile] ;EMO Killer
type = Projectile
trigger1 = var(54)>0 ;EMO Exit active
ProjID = 4900
projanim = 9999
projremove = 3;4
projremovetime = 3;4
ignorehitpause = 1
;persistent =
;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State -2, VarSet] ;reset Blitz Deadend cancel
type = VarSet
trigger1 = !time
var(40)=0
ignorehitpause = 1
;persistent =

[State 9000, snd] ;attack calling
type = playsnd
triggerall = random<300
trigger1 = time=1
value = 3100,random%2
channel = 0
volumescale = 300
persistent = 0
[State 9000, snd] ;assorted voices
type = playsnd
triggerall = random<500
trigger1 = time=2
value = 9000,random%6
channel = 0
lowpriority = 1
volumescale = 300
persistent = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = animelemtime(5)<0
flag = noBG
flag2 = noFG

[State 3000, nhb]
type = nothitby
trigger1 = time<=45 ;animelemtime(5)<0
time = 1
value = SCA

[State 3000, superpause]
type = superpause
trigger1 = time=10
time = 40
p2defmul = 1
unhittable = 1
anim = -1
sound = s3000,0 ;s2010,0
darken = 0
movetime = 40

[State 0, Super FX]
type = Explod
trigger1 = time = 10 ;5
anim = 3010
id = 3010
pos = -102,-35 ;-125,28
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 45
color=0
mul=0,0,0

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime ;time>=45
value = 3111
ctrl = 0
;ignorehitpause =
;persistent =

;CASCADE MP LAUNCH
[Statedef 3111]
type = S
physics = S
movetype = A
anim = 3110
ctrl = 0
velset = 0,0
sprpriority = -5

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 4000, threshold usage]
type = VarAdd
trigger1 = prevstateno=3102
triggerall = NumHelper(4750)
trigger1 = !time
var(52)=-700
ignorehitpause = 1
;persistent =
[State 4900, Projectile] ;EMO Killer
type = Projectile
trigger1 = prevstateno=3102
trigger1 = var(54)>0 ;EMO Exit active
ProjID = 4900
projanim = 9999
projremove = 3;4
projremovetime = 3;4
ignorehitpause = 1
;persistent =
;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = prevstateno=3102
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State -2, VarSet] ;reset Blitz Deadend cancel
type = VarSet
trigger1 = !time
var(40)=0
ignorehitpause = 1
;persistent =


[State 0, Width]
type = Width
trigger1 = 1
value = 5,10
ignorehitpause = 1
;persistent =


[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 801, teleport sound]
type = PlaySnd
trigger1 = !time
value = 810,0

[State 0, VarSet] ;reset buffer variable
type = VarSet
trigger1 = !time
var(3)=0
ignorehitpause = 1
;persistent =

[State 1400, VarSet] ;Cascade Lv.1
type = VarSet
triggerall = !var(3)
triggerall = AILevel<=0
triggerall = time >0
; Corresponds to command = "2QCB"
triggerall = ((ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && (NumExplod(90030101) || NumExplod(90030114))) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && (NumExplod(90030016) || NumExplod(90030003))))
triggerall = power>=1000
trigger1 = NumExplod(90000220)
trigger1 = var(3):=3120*NumExplod(90000220)  ;SP
var(3) = var(3)

[state 1215, Smoke FX]
type = explod
trigger1 = Animelemtime(2)=0
anim = 10000
id = 1009
pos = 70,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
scale = .8,.8

[State 801, teleport sound]
type = PlaySnd
trigger1 = Animelemtime(3)=0
value = 5,8

[State 0, PosAdd] ;Non buffered
type = PosAdd
triggerall = prevstateno=3110
trigger1 = Animelemtime(3)=0
x = 100
;y = -100
ignorehitpause = 1
;persistent =

[State 0, PlayerPush]
type = PlayerPush
trigger1 = prevstateno=3102
value = 0
ignorehitpause = 1
;persistent =

[State 0, PowerAdd] ;Buffered
type = PowerAdd
trigger1 = prevstateno=3102
trigger1 = Animelemtime(3)=0
value = Cond(!NumHelper(4750),-1000,0)
ignorehitpause = 1
persistent = 0


[State 0, PosSet] ;Buffered
type = PosSet
triggerall = prevstateno=3102
trigger1 = Animelemtime(3)=0
x = (enemy,pos X) -20*facing
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = Animelemtime(3)=0
x = 8
ignorehitpause = 1
;persistent =
[State 0, VelMul]
type = VelMul
trigger1 = vel x>0
trigger1 = Animelemtime(3)>=0
x = 0.8
ignorehitpause = 1
;persistent =

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Animelemtime(3)=0
statetype = C       ;S,A,C,L
movetype = A        ;I,A,H
physics = C         ;A,C,S,N
ignorehitpause = 1
;persistent =

[State 1000, cascade Tail]
type = Helper
triggerall = !NumHelper(3160)
trigger1 = Animelemtime(6)=0
helpertype = normal
name = "Cascade Tail"
postype = P1
pos = -19,-100
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3160
id = 3160
[State 1000, cascade Damage]
type = Helper
triggerall = !NumHelper(3169)
trigger1 = Animelemtime(6)=0
helpertype = normal
name = "Cascade Damage"
postype = P1
pos = -19,-100
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3169
id = 3169
[State 1000, cascade Mid]
type = Helper
triggerall = !NumHelper(3161)
trigger1 = Animelemtime(6)=0
helpertype = normal
name = "Cascade Mid"
postype = P1
pos = -19,-120
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3161
id = 3161
[State 1000, cascade Head]
type = Helper
triggerall = !NumHelper(3162)
trigger1 = Animelemtime(6)=0
helpertype = normal
name = "Cascade Head"
postype = P1
pos = -19,-129
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3162
id = 3162

[State 0, ChangeState]
type = ChangeState
trigger1 = time>=66
value = 3112
ctrl = 0
;ignorehitpause =
;persistent =

;CASCADE MP END
[Statedef 3112]
type = C
physics = C
movetype = I
anim = 3111
ctrl = 0
velset = 0,0
sprpriority = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, Width]
type = Width
trigger1 = 1
value = 5,10
ignorehitpause = 1
;persistent =

[State 1000, To buffered move]
type = Changestate
triggerall = p2movetype=H
trigger1 = var(3)!=0
trigger1 = AnimElemTime(5)=0
value = var(3)+1

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;ignorehitpause =
;persistent =

;CASCADE SP
[Statedef 3120]
type = S
physics = S
movetype = A
anim = 3100
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(!NumHelper(4750),-1000,0)
facep2 = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1
[State 4000, threshold usage]
type = VarAdd
triggerall = NumHelper(4750)
trigger1 = !time
var(52)=-700
ignorehitpause = 1
;persistent =
[State 4900, Projectile] ;EMO Killer
type = Projectile
trigger1 = var(54)>0 ;EMO Exit active
ProjID = 4900
projanim = 9999
projremove = 3;4
projremovetime = 3;4
ignorehitpause = 1
;persistent =
;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State -2, VarSet] ;reset Blitz Deadend cancel
type = VarSet
trigger1 = !time
var(40)=0
ignorehitpause = 1
;persistent =

[State 9000, snd] ;attack calling
type = playsnd
triggerall = random<300
trigger1 = time=1
value = 3100,random%2
channel = 0
volumescale = 300
persistent = 0
[State 9000, snd] ;assorted voices
type = playsnd
triggerall = random<500
trigger1 = time=2
value = 9000,random%6
channel = 0
lowpriority = 1
volumescale = 300
persistent = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = animelemtime(5)<0
flag = noBG
flag2 = noFG

[State 3000, nhb]
type = nothitby
trigger1 = time<=45 ;animelemtime(5)<0
time = 1
value = SCA

[State 3000, superpause]
type = superpause
trigger1 = time=10
time = 40
p2defmul = 1
unhittable = 1
anim = -1
sound = s3000,0 ;s2010,0
darken = 0
movetime = 40

[State 0, Super FX]
type = Explod
trigger1 = time = 10 ;5
anim = 3010
id = 3010
pos = -102,-35 ;-125,28
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 45
color=0
mul=0,0,0

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime ;time>=45
value = 3121
ctrl = 0
;ignorehitpause =
;persistent =

;CASCADE SP LAUNCH
[Statedef 3121]
type = S
physics = S
movetype = A
anim = 3120
ctrl = 0
velset = 0,0
sprpriority = -5

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 4000, threshold usage]
type = VarAdd
trigger1 = prevstateno=3112
triggerall = NumHelper(4750)
trigger1 = !time
var(52)=-700
ignorehitpause = 1
;persistent =
[State 4900, Projectile] ;EMO Killer
type = Projectile
trigger1 = prevstateno=3112
trigger1 = var(54)>0 ;EMO Exit active
ProjID = 4900
projanim = 9999
projremove = 3;4
projremovetime = 3;4
ignorehitpause = 1
;persistent =
;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = prevstateno=3112
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State -2, VarSet] ;reset Blitz Deadend cancel
type = VarSet
trigger1 = !time
var(40)=0
ignorehitpause = 1
;persistent =

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, VarSet] ;reset buffer variable
type = VarSet
trigger1 = !time
var(3)=0
ignorehitpause = 1
;persistent =

[State 801, teleport sound]
type = PlaySnd
trigger1 = Animelemtime(2)=0 ;!time
value = 810,0

[State 0, PosAdd]  ;non buffered
type = PosAdd
triggerall = prevstateno=3120
trigger1 = Animelemtime(4)=0
x = 100
y = -100
ignorehitpause = 1
;persistent =

[State 0, PosSet] ;buffered
type = PosSet
triggerall = (prevstateno=3102) || (prevstateno=3112)
trigger1 = Animelemtime(4)=0
x = enemy,pos X
y = -100
ignorehitpause = 1
persistent = 0

[State 0, PowerAdd] ;Buffered
type = PowerAdd
triggerall = (prevstateno=3102) || (prevstateno=3112)
trigger1 = Animelemtime(4)=0
value = Cond(!NumHelper(4750),-1000,0)
ignorehitpause = 1
persistent = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Animelemtime(4)=0
statetype = A       ;S,A,C,L
movetype = A        ;I,A,H
physics = N         ;A,C,S,N
ignorehitpause = 1
;persistent =

[State 0, VarSet] ;reset buffer variable
type = VarSet
trigger1 = Animelemtime(5)=0
var(3)=0
ignorehitpause = 1
;persistent =


[State 1000, cascade Tail]
type = Helper
triggerall = !NumHelper(3170)
trigger1 = Animelemtime(7)=0
helpertype = normal
name = "Cascade Tail"
postype = P1
pos = 8,-34
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3170
id = 3170
[State 1000, cascade Damage]
type = Helper
triggerall = !NumHelper(3180)
trigger1 = Animelemtime(7)=0
helpertype = normal
name = "Cascade Damage"
postype = P1
pos = 8,-34
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3180
id = 3180
[State 1000, cascade Mid]
type = Helper
triggerall = !NumHelper(3171)
trigger1 = Animelemtime(7)=0
helpertype = normal
name = "Cascade Mid"
postype = P1
pos = 8,-20
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3171
id = 3171
[State 1000, cascade Head]
type = Helper
triggerall = !NumHelper(3172)
trigger1 = Animelemtime(7)=0
helpertype = normal
name = "Cascade Head"
postype = P1
pos = 8,-13 ;-15
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
stateno = 3172
id = 3172

[State 0, ChangeState]
type = ChangeState
trigger1 = time>=74 ;66
value = 3122
ctrl = 0
;ignorehitpause =
;persistent =

;CASCADE SP END
[Statedef 3122]
type = A
physics = N
movetype = I
anim = 3121
ctrl = 0
;velset = 0,0
sprpriority = -5

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Animelemtime(4)=0
statetype = A       ;S,A,C,L
movetype = I        ;I,A,H
physics = A         ;A,C,S,N
ignorehitpause = 1
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 50
ctrl = 1
;ignorehitpause =
;persistent =

;INFINITY BULLET
[Statedef 3200]
type = A
movetype = A
physics = N
anim = 3200
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(!NumHelper(4750),-1000,0)

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1
[State 4000, threshold usage]
type = VarAdd
triggerall = NumHelper(4750)
trigger1 = !time
var(52)=-700
ignorehitpause = 1
;persistent =
[State 4900, Projectile] ;EMO Killer
type = Projectile
trigger1 = var(54)>0 ;EMO Exit active
ProjID = 4900
projanim = 9999
projremove = 3;4
projremovetime = 3;4
ignorehitpause = 1
;persistent =
;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State 9000, snd] ;attack calling
type = playsnd
triggerall = random<300
trigger1 = time=1
value = 3200,random%2
channel = 0
volumescale = 300
persistent = 0
[State 9000, snd] ;assorted voices
type = playsnd
triggerall = random<500
trigger1 = time=2
value = 9000,random%6
channel = 0
lowpriority = 1
volumescale = 300
persistent = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1 ;animelemtime(5)<0
flag = noBG
flag2 = noFG

[State 3000, nhb]
type = nothitby
trigger1 = time<=45 ;animelemtime(5)<0
time = 1
value = SCA

[State 3000, superpause]
type = superpause
trigger1 = time=10
time = 40
p2defmul = 1
unhittable = 1
anim = -1
sound = s3000,0 ;s2010,0
darken = 0
movetime = 40

[State 0, Super FX]
type = Explod
trigger1 = time = 10 ;5
anim = 3010
id = 3010
pos = -145,-25;-102,-35
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 45
color=0
mul=0,0,0

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime ;time>=45
value = 3201
ctrl = 0
;ignorehitpause =
;persistent =

;IB Launch
[Statedef 3201]
type = A
movetype = A
physics = N
anim = 3201
ctrl = 0
velset = 0,0
sprpriority = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, VarSet] ;reset hitcounter
type = VarSet
trigger1 = !time
var(3) = 0
ignorehitpause = 1
;persistent =

[State 0, Infinity FX]
type = Explod
triggerall = !NumExplod(3220)
trigger1 = !time
anim = 3220
id = 3220
pos = 0,0
postype = p1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
supermove = 1
removetime = -1
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
removeongethit = 1
persistent = 0

[State 1061, Hitdef]
type = HitDef
trigger1 = Time >= 0
trigger1 = time%6=0
attr = A, HP
animtype  = hard
damage = 7,7 ;ceil(ifElse(root,fvar(11) * 23< 7, 7, root,fvar(11) *23)),3
priority  = 4,Hit
guardflag = MA
hitflag = MAFLD
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s3150,1 ;s1000,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -7.8,0
guard.velocity = -7.5
air.velocity = -5.8,-3
airguard.velocity = -5, -4
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
sprpriority = 1
getpower = 0,0
givepower = 20,20
;persistent = 0

[State 0, PlayerPush] ;disable push on contact
type = PlayerPush
trigger1 =  movecontact
value = 0
ignorehitpause = 1
;persistent =

[State 0, VarAdd] ;hitcount
type = VarAdd
trigger1 = MoveHit
var(3) = 1
ignorehitpause = 1
persistent = 0


[State 0, TargetState]
type = TargetState
trigger1 = numtarget
trigger1 = MoveHit
value = 3231
ID = -1
ignorehitpause = 1
persistent = 0

[State 0, VelSet]
type = null;VelSet
trigger1 = AnimElemTime(5)=0 ;!time
x = -0.2 ;0
y = -0.2
ignorehitpause = 1
;persistent =

[State 3200, Beam A]
type = Helper
trigger1 = AnimElemTime(5)>=0
trigger1 = time%12=0
helpertype = normal
name = "IB Beam A"
postype = P1
pos = 22,30
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 9999
id = 3225
stateno = 3230
ignorehitpause = 1
[State 3200, Beam B]
type = Helper
trigger1 = AnimElemTime(5)>=0
trigger1 = time%12=0
helpertype = normal
name = "IB Beam B"
postype = P1
pos = 41,32
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 9999
id = 3226
stateno = 3230
ignorehitpause = 1
[State 3200, Beam C]
type = Helper
trigger1 = AnimElemTime(5)>=0
trigger1 = time%12=0
helpertype = normal
name = "IB Beam C"
postype = P1
pos = 83,20
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 9999
id = 3227
stateno = 3230
ignorehitpause = 1
[State 3200, Beam D]
type = Helper
trigger1 = AnimElemTime(5)>=0
trigger1 = time%12=0
helpertype = normal
name = "IB Beam D"
postype = P1
pos = 100,-13
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 9999
id = 3228
stateno = 3230
ignorehitpause = 1
[State 3200, Beam E]
type = Helper
trigger1 = AnimElemTime(5)>=0
trigger1 = time%12=0
helpertype = normal
name = "IB Beam E"
postype = P1
pos = 97,-30
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 9999
id = 3229
stateno = 3230
ignorehitpause = 1


[State 0, ChangeState]
type = ChangeState
trigger1 = time>=60
value = 3202
ctrl = 0
;ignorehitpause =
;persistent =

;IB End
[Statedef 3202]
type = A
movetype = A
physics = N
anim = 3202
ctrl = 0
velset = 0,0
sprpriority = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 3220
ignorehitpause = 1
;persistent =

[State 0, Infinity FX]
type = Explod
triggerall = !NumExplod(3221)
trigger1 = !time
anim = 3221
id = 3220
pos = 0,0
postype = p1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
supermove = 1
removetime = -2
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 50
ctrl = 0
;ignorehitpause =
;persistent =

;Hit by IB
[Statedef 3231]
type = U
movetype = H
physics = N
ctrl = 0

[State 0, PosSet] ;prevent undersink
type = PosSet
trigger1 = pos y>0
y = 0
ignorehitpause = 1
;persistent =

[State 0, SelfState]
type = SelfState
trigger1 = time=1 ;1
value = 5000+20*(statetype=A)+20*(statetype=L)
ignorehitpause = 1

;LV1 POWER BREAKER Lv1
[Statedef 3300]
type = S
physics = S
movetype = A
anim = 3300
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(!NumHelper(4750),-1000,0)
facep2 = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1
[State 4000, threshold usage]
type = VarAdd
triggerall = NumHelper(4750)
trigger1 = !time
var(52)=-700
ignorehitpause = 1
;persistent =
[State 4900, Projectile] ;EMO Killer
type = Projectile
trigger1 = var(54)>0 ;EMO Exit active
ProjID = 4900
projanim = 9999
projremove = 3;4
projremovetime = 3;4
ignorehitpause = 1
;persistent =
;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State -2, VarSet] ;reset Blitz Deadend cancel
type = VarSet
trigger1 = !time
var(40)=0
ignorehitpause = 1
;persistent =

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 45
color=0
mul=0,0,0

[State 9000, snd] ;attack calling
type = playsnd
triggerall = random<300
trigger1 = time=1
value = 3300,0
channel = 0
volumescale = 300
persistent = 0
[State 9000, snd] ;assorted voices
type = playsnd
triggerall = random<500
trigger1 = time=2
value = 9000,random%6
channel = 0
lowpriority = 1
volumescale = 300
persistent = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = animelemtime(5)<0
flag = noBG
flag2 = noFG

[State 3000, nhb]
type = nothitby
trigger1 = time<=45 ;animelemtime(5)<0
time = 1
value = SCA

[State 3000, superpause]
type = superpause
trigger1 = time=10
time = 40
p2defmul = 1
unhittable = 1
anim = -1
sound = s3000,0 ;s2010,0
darken = 0
movetime = 40

[State 0, Super FX]
type = Explod
trigger1 = time = 10 ;5
anim = 3010
id = 3010
pos = -125,-25
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
removeongethit = 1
persistent = 0

[State 9000, snd] ;charge sound
type = playsnd
trigger1 = time = 10
value = 3350,0
channel = 1
volumescale = 300
persistent = 0

[State 0, FX beam]
type = Explod
trigger1 = time = 10 ;5
anim = 3350
id = 3350
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1 ;-2
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
removeongethit = 1
persistent = 0

[State 1200, No Push Dummy]
type = Helper
triggerall = !NumHelper(3390)
trigger1 = time=10
name = "Breaker - No Push"
id = 3390
stateno = 3190
size.ground.back = Const(size.ground.back) +20
size.ground.front = Const(size.ground.front) +50
size.height = Const(size.height) +60

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 3301
ctrl = 0
;ignorehitpause =
;persistent =

;LV1 PB Launch
[Statedef 3301]
type = S
physics = S
movetype = A
anim = 3301
ctrl = 0
velset = 0,0
sprpriority = -5

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 3350
ignorehitpause = 1
;persistent =

[State 0, VarSet] ;reset buffer variable
type = VarSet
trigger1 = !time
var(3)=0
ignorehitpause = 1
;persistent =

[State 3000, Breaker Beam]
type = helper
trigger1 = !time
helpertype = normal
stateno = 3351
ID = 3351
name = "Breaker Beam"
postype = p1
pos = 0,0
ownpal = 1

[State 1400, VarSet] ;Twin Power Breaker Lv.2
type = VarSet
triggerall = !var(3)
triggerall = AILevel<=0
triggerall = time >0
; Corresponds to command = "2QCF"
triggerall = ifElse(Facing = 1, (NumExplod(90030016) || NumExplod(90030003)),(NumExplod(90030101) || NumExplod(90030114)))
triggerall = (ifElse(NumExplod(90000200), 1, 0) + ifElse(NumExplod(90000210), 1, 0) + ifElse(NumExplod(90000220), 1, 0) >= 2) || (ifElse(NumExplod(90000205), 1, 0) + ifElse(NumExplod(90000215), 1, 0) + ifElse(NumExplod(90000225), 1, 0) >= 2)
trigger1 = power>=2000
var(3) = 3320

[State 0, ChangeState]
type = ChangeState
;trigger1 = time>=90
trigger1 = Time>0
trigger1 = !NumHelper(3351)
value = 3302
ctrl = 0
;ignorehitpause =
;persistent =

;LV1 PB Recovery
[Statedef 3302]
type = S
physics = S
movetype = I
anim = 3302
ctrl = 0
velset = 0,0
sprpriority = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1


[State 1000, To buffered move]
type = Changestate
trigger1 = var(3)!=0
trigger1 = AnimElemTime(4)=0
value = var(3)

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;ignorehitpause =
;persistent =

;LV2 POWER BREAKER Lv2
[Statedef 3320]
type = S
physics = S
movetype = A
anim = 3320
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(!NumHelper(4750),-2000,0)
facep2 = 1


;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1
[State 4000, threshold usage]
type = VarAdd
triggerall = NumHelper(4750)
trigger1 = !time
var(52)=-1400
ignorehitpause = 1
;persistent =
[State 4900, Projectile] ;EMO Killer
type = Projectile
trigger1 = var(54)>0 ;EMO Exit active
ProjID = 4900
projanim = 9999
projremove = 3;4
projremovetime = 3;4
ignorehitpause = 1
;persistent =
;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State -2, VarSet] ;reset Blitz Deadend cancel
type = VarSet
trigger1 = !time
var(40)=0
ignorehitpause = 1
;persistent =

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 45
color=0
mul=0,0,0

[State 9000, snd] ;attack calling
type = playsnd
triggerall = random<300
trigger1 = time=1
value = 3300,0
channel = 0
volumescale = 300
persistent = 0
[State 9000, snd] ;assorted voices
type = playsnd
triggerall = random<500
trigger1 = time=2
value = 9000,random%6
channel = 0
lowpriority = 1
volumescale = 300
persistent = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = animelemtime(5)<0
flag = noBG
flag2 = noFG

[State 3000, nhb]
type = nothitby
trigger1 = time<=60 ;45 ;animelemtime(5)<0
time = 1
value = SCA

[State 3320, superpause]
type = superpause
trigger1 = time = 10
time = 50+10*(prevstateno=220 || prevstateno=250);+10*(prevstateno=3302)
movetime = 50+10*(prevstateno=220 || prevstateno=250);+10*(prevstateno=3302)
p2defmul = 1
unhittable = 1
anim = -1
darken = 0

[State 3320, Hyper Charge FX]
type = Explod
trigger1 = time = 10
anim = 2440
id = 2440
pos = -10,-130 ;17,-90
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = -5
ownpal = 1
bindtime = -1
scale = 1,1
removeongethit = 1
persistent = 0

[State 3320, Superpause charge sound]
type = PlaySnd
trigger1 = time = 10
value = 3600,0


[State 0, FX beam]
type = Explod
trigger1 = time = 10 ;5
anim = 3349
id = 3350
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1 ;-2
sprpriority = 3
ownpal = 1
bindtime = -1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, FX beam 2]
type = Explod
trigger1 = time = 67
anim = 3348
id = 3348
pos = 10,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1 ;-2
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
removeongethit = 1
persistent = 0

[State 9000, snd] ;charge sound
type = playsnd
trigger1 = time = 67
value = 3350,0
channel = 1
volumescale = 300
persistent = 0

[State 1200, No Push Dummy]
type = Helper
triggerall = !NumHelper(3390)
trigger1 = time=10
name = "Breaker - No Push"
id = 3390
stateno = 3190
size.ground.back = Const(size.ground.back) +20
size.ground.front = Const(size.ground.front) +50
size.height = Const(size.height) +60

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 3321
ctrl = 0
;ignorehitpause =
;persistent =

;LV2 PB Launch
[Statedef 3321]
type = S
physics = S
movetype = A
anim = 3321
ctrl = 0
velset = 0,0
sprpriority = 0

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, VarSet] ;reset buffer variable
type = VarSet
trigger1 = !time
var(3)=0
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 3348
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 3350
ignorehitpause = 1
;persistent =

[State 3000, Breaker Beam 1]
type = helper
trigger1 = !time
helpertype = normal
stateno = 3351
ID = 23351
name = "Breaker Beam"
postype = p1
pos = 0,0
ownpal = 1

[State 3000, Breaker Beam 2]
type = helper
trigger1 = !time
helpertype = normal
stateno = 13351
ID = 13351
name = "Breaker Beam 2"
postype = p1
pos = 0,0
ownpal = 1

[State 0, ChangeState]
type = ChangeState
;trigger1 = time>=90
trigger1 = Time>0
trigger1 = !NumHelper(23351)
trigger1 = !NumHelper(13351)
value = 3322
ctrl = 0
;ignorehitpause =
;persistent =

;LV2 PB Recovery
[Statedef 3322]
type = S
physics = S
movetype = I
anim = 3322
ctrl = 0
velset = 0,0
sprpriority = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;ignorehitpause =
;persistent =

; Hit by PB - Air get-hit (shaking)
[Statedef 3370]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 3

[State 5020, 1]
type = ChangeAnim2
trigger1 = !Time
value = 3370 +(BackEdgeDist<=40)
ignorehitpause = 1


[State 0, ChangeState] ;go to cinematic
type = null;ChangeState
;trigger1 = !Time
trigger1 = life<=8
value = 3591
ctrl = 0
ignorehitpause = 1
persistent = 0


[State 0, ChangeAnim2] ; Wall
type = ChangeAnim2
trigger1 = Anim=3520
trigger1 = BackEdgeDist <= 20
value = 3371
;elem = 1
ignorehitpause = 1
;persistent =

[State 0, PosAdd]
type = PosAdd
trigger1 = !animtime
y = 50
ignorehitpause = 1
;persistent =


[State 5020, 5]
type = SelfState
trigger1 = !animtime ;HitShakeOver
value = 5030


;OVERDRIVE DEADLY BREAKER LV3
[Statedef 3500]
type = A
physics = N ;S
movetype = A
anim = 3500
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(!NumHelper(4750),-3000,0)
facep2 = 1

;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State -2, VarSet] ;reset Blitz Deadend cancel
type = VarSet
trigger1 = !time
var(40)=0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1 ;animelemtime(5)<0
flag = noBG
flag2 = noFG

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 45
color=0
mul=0,0,0

[State 3000, nhb]
type = nothitby
trigger1 = time<=45 ;animelemtime(5)<0
time = 1
value = SCA

[State 3000, superpause]
type = superpause
trigger1 = time=10
time = 40
p2defmul = 1
unhittable = 1
anim = -1
sound = s2350,1
darken = 0
movetime = 40

[State 0, Hyper Charge FX L]
type = Explod
trigger1 = time = 10 ;5
anim = 2440
id = 2440
pos = -24,-70
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 3
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0
[State 0, Hyper Charge FX R]
type = Explod
trigger1 = time = 10 ;5
anim = 2440
id = 2440
pos = 24,-70
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 3
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 13000, After image]
type = Helper
trigger1 = Time = 44
name = "Afterimage"
ID = 3590
stateno = 3590
pausemovetime = 50

[State 105, 1]
type = VelSet
trigger1 = time=44
x = -3.5*(backedgedist/80.0)-0.1;*const(velocity.run.fwd.x) ;-1.3*const(velocity.run.fwd.x)

[State 115, dash Sound]
type = PlaySnd
trigger1 = time=44
value = 100,0

[State 3010, ScreenBound]
type = ScreenBound
trigger1 = time>44 ;1
value = 0
movecamera = 0,0
ignorehitpause = 1


[State 0, ChangeState]
type = ChangeState
triggerall = time>=50
triggerall = vel x<0
trigger1 = backedgedist <= 5
value = 3501
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;ODB Bounce
[Statedef 3501]
type = A
physics = N ;S
movetype = A
anim = 3501
ctrl = 0
velset = 0,0
sprpriority = 1
facep2 = 1

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = 1
x = Cond(facing=1,-165,165)
ignorehitpause = 1
;persistent =

[State 0, VarSet]  ;keep buffer
type = VarSet
trigger1 = !time
var(9) = 0
ignorehitpause = 1
;persistent =

[State 0, VarSet]
type = VarSet
triggerall = AILevel<=0 && time>0
trigger1 = 1 && var(9):=0
trigger2 = 1 && var(9):=(NumExplod(90000008) || command="up" || command="holdup")
trigger3 = 1 && var(9):=2*(NumExplod(90000002) || command="down" || command="holddown")
var(9) = var(9)
ignorehitpause = 1
;persistent =

[State 0, VarSet]
type = VarSet
triggerall = AILevel>0 && time>0
trigger1 = 1 && var(9):=0
trigger2 = 1 && var(9):=(P2BodyDist Y<-15)
trigger3 = 1 && var(9):=2*(P2BodyDist Y>15)
var(9) = var(9)
ignorehitpause = 1
;persistent =


[State 0, ChangeState]
type = ChangeState
trigger1 = time=20 ;TEMP
value = 3502
ctrl = 0
anim = 3502+var(9)
;ignorehitpause =
;persistent =

;ODB dash attack
[Statedef 3502]
type = A
physics = N ;S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = 1
facep2 = 1

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 0, VelSet U]
type = VelSet
triggerall = Anim=3503
trigger1 = !time
x = 2*const(velocity.run.fwd.x)
y = -5
;ignorehitpause =
;persistent =

[State 0, VelSet H]
type = VelSet
triggerall = Anim=3502
trigger1 = !time
x = 2*const(velocity.run.fwd.x)
y = 0
;ignorehitpause =
;persistent =

[State 0, VelSet D]
type = VelSet
triggerall = Anim=3504
trigger1 = !time
x = 2*const(velocity.run.fwd.x)
y = 5
;ignorehitpause =
;persistent =

[State 0, VelSet] ;prevent undersink
type = VelSet
triggerall = Anim=3504
trigger1 = pos y>0
y = 0
;ignorehitpause =
;persistent =


[State 0, gotcha!]
type = PlaySnd
trigger1 = !time
value = 3500,0
channel = 0
volumescale = 255
ignorehitpause = 1
persistent = 0

[State 0, woosh!]
type = PlaySnd
trigger1 = !time
value = 3501,0
volumescale = 255
ignorehitpause = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = p2bodydist x<40
value = 3502+var(9)
elem = 3
ignorehitpause = 1
persistent = 0


[State 255, hit]
type = HitDef
trigger1 = time>=0
attr = A, HA
animtype  = Hard
damage = 300,0 ;30
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 4,1 ;13,13
guard.pausetime = 13,13 ;13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = -10-random%20,-50-random%20
hitsound   = s3501,10 ;s5,5
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
ID = 3500
persistent = 0
kill = 0
;guard.kill = 0

[State 0, TargetLifeAdd] ;Chip KO hack
type = TargetLifeAdd
triggerall = numtarget(3500)
triggerall = target(3500),Ishelper=0
trigger1 = moveguarded
value = -30
ID = -1
kill = 1
absolute = 0
ignorehitpause = 1
persistent = 0

[State 0, ChangeState] ; to cinematic
type = ChangeState
triggerall = !Win ;prevent beating a dead horse
triggerall = numtarget(3500)
triggerall = target(3500),Ishelper=0
triggerall = target(3500),alive ;prevent beating a dead horse
trigger1 = movehit
value = 3510
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =


[State 0, ChangeState] ;whiff
type = ChangeState
trigger1 = !animtime
value = 50 + 0*(var(52):=0)
ctrl = 1
;anim =
;ignorehitpause =
;persistent =

;ODB cinematic
[Statedef 3510]
type = A
physics = N ;S
movetype = A
anim = 3510
ctrl = 0
velset = 0,0
sprpriority = 6
facep2 = 1

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, Explod] ;Piccolo Compatibility
type = Explod
trigger1 = !time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 2201, helper]; Background lines
type = Helper
trigger1 = !NumHelper(3580)
trigger1 = !time
pos = -640, -480
postype = back
stateno = 3580
helpertype = normal
name = "horizontal_lines_BG"
id = 3580
ownpal = 1
supermovetime = 9999 ;150
pausemovetime = 9999 ;150
sprpriority = 5
size.xscale = 5
size.yscale= 5

[State 0, TargetState]
type = TargetState
trigger1 = numtarget(3500)
trigger1 = !time
value = 3520
ID = 3500
ignorehitpause =1
persistent = 0

[state 17100, charge Effect]
type = explod
triggerall = Anim=3510
trigger1 = !numexplod(3515)
trigger1 = Animelemtime(4)=0
anim = 3515
id = 3515
pos = -5,-110
postype = P1
sprpriority = 0
ownpal = 1
scale = 1,1
bindtime = -1
supermovetime = -1
removetime = -1
removeongethit = 1

[State 0, PlaySnd]
type = PlaySnd
triggerall = Anim=3510
trigger1 = Animelemtime(4)=0
value = 3515,1;0
volumescale = 255
channel = -1
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
triggerall = Anim=3510
trigger1 = Animelemtime(4)=0
x = 15 ;20
y = 0
;ignorehitpause =
;persistent =

[State 0, Black Curtain]
type = Helper
triggerall = !NumHelper(3516)
trigger1 = pos X !=[-500,500]
helpertype = normal ;player
name = "Black Curtain"
ID = 3516
stateno = 3516
pos = 160,240
postype = left    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[State 0, VelSet]
type = VelSet
triggerall = Anim=3510
trigger1 = pos X !=[-600,600]
x = 0
y = 0
;ignorehitpause =
persistent = 0

[State 0, place offscreen for next cinematic]
type = PosSet
triggerall = Anim=3510
triggerall = time>20
trigger1 = vel X=0 ;stopped
x = -(pos X)
y = -40
;ignorehitpause =
persistent = 0

[State 0, laugh]
type = PlaySnd
triggerall = Anim=3510
triggerall = NumProjID(3516)
triggerall = numtarget(3500)
trigger1 = target(3500), pos X=0
value = 3502,random%5
channel = 0
volumescale = 255
ignorehitpause = 1
persistent = 0

[State 0, VelSet]
type = VelSet
triggerall = Anim=3510
triggerall = NumProjID(3516)
triggerall = numtarget(3500)
trigger1 = target(3500), pos X=0
x = 20
y = 0
;ignorehitpause =
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = Anim=3510
triggerall = numtarget(3500)
trigger1 = target(3500), pos X=0
trigger1 = P2BodyDist X <90
value = 3511
;elem = 1
;ignorehitpause =
;persistent =

[State 38121, Offset]
type = Offset
trigger1 = Anim=3511
y = 1.0*cos(time)

[State 0, VelSet]
type = VelSet
triggerall = Anim=3511
trigger1 = Animelemtime(1)=0
x = 0
;ignorehitpause =
;persistent =

;Time to go to the finishers  (use var(52) to check level)
;Lv0: Breaker (4400)
;Lv1: Death by degrees (4100)
;Lv2: Infinity Engine (4200)
;Lv3: Twin dance (4300)
[State 0, ChangeState] ;Lv0: Breaker (4400)
type = ChangeState
triggerall = var(52)<700 ;TEMP
triggerall = Anim=3511
trigger1 = !animtime
value = 4400
ctrl = 0
;anim =
;ignorehitpause =
;persistent =
[State 0, ChangeState] ;Lv1: Death by degrees (4100)
type = ChangeState
triggerall = var(52)=[700,1400) ;TEMP
triggerall = Anim=3511
trigger1 = !animtime
value = 4100
ctrl = 0
;anim =
;ignorehitpause =
;persistent =
[State 0, ChangeState] ;Lv2: Infinity Engine (4200)
type = ChangeState
triggerall = var(52)=[1400,2100)
triggerall = Anim=3511
trigger1 = !animtime
value = 4200
ctrl = 0
;anim =
;ignorehitpause =
;persistent =
[State 0, ChangeState] ;Lv3: Twin dance (4300)
type = ChangeState
triggerall = var(52)>=2100
triggerall = Anim=3511
trigger1 = !animtime
value = 4300
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = time=200
value = 50
ctrl = 1
;anim =
;ignorehitpause =
;persistent =

;Target - ODB offscreen
[Statedef 3520]
type = A
physics = N ;S
movetype = H
ctrl = 0
velset = -20,0
sprpriority = 1
facep2 = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 3520
;elem = 1
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = pos X !=[-400,400]
x = 0
y = 0
;ignorehitpause =
persistent = 0

[State 0, place offscreen for next cinematic]
type = PosSet
trigger1 = vel X=0 ;stopped
x = -(pos X)
y = -60
;ignorehitpause =
persistent = 0

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = Anim=3520
trigger1 = pos X !=[-400,400]
value = 3521
;elem = 1
;ignorehitpause =
;persistent =

[State 38121, Offset]
type = Offset
trigger1 = Anim=3521
y = 1.0*sin(time)


[State 0, VelSet]
type = null;VelSet
triggerall = Anim=3521
triggerall = pos X !=[-400,400] ;offscreen
trigger1 = vel X=0
trigger1 = enemy,NumProjID(3516)
x = -20
y = 0
;ignorehitpause =
persistent = 0

[State 0, PosSet]
type = PosSet
triggerall = Anim=3521
triggerall = enemy,NumProjID(3516)
trigger1 = pos X !=[-400,400] ;offscreen ;Cond(vel X<0,pos X>-10,pos X<10)
x = 0
;ignorehitpause =
persistent = 0

[State 0, VelSet] ;stop in the middle
type = null;VelSet
triggerall = Anim=3521
triggerall = enemy,NumProjID(3516)
trigger1 = pos X=0 ;vel X!=0
;trigger1 = Cond(vel X<0,pos X>=0,pos X<=0)
x = 0
y = 0
;ignorehitpause =
;persistent =

[State 0, PosSet]
type = null;PosSet
triggerall = Anim=3521
triggerall = enemy,NumProjID(3516)
trigger1 = Cond(vel X<0,pos X>=0,pos X<=0)
x = 0
;ignorehitpause =
persistent = 0


[State 0, SelfState]
type = SelfState
trigger1 = time= 260
value = 50
;anim =
ctrl = 1
;ignorehitpause = 0
;persistent = 1

;Black Curtain
[Statedef 3516]
type = S
movetype = I
physics = N
anim = 3516
ctrl = 0
sprpriority = 20

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
flag2 = noshadow
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = 4320,0
channel = 9

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = 160
y = 27
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = -20
;ignorehitpause =
;persistent =

[State 0, Projectile]
type = Projectile
trigger1 = !NumProjID(3516)
trigger1 = time=30 ;20 ;=[25,40]
ProjID = 3516
projanim = 9999
postype = Left
offset =100,0
projremove = 3;4
projremovetime = 3;4
ignorehitpause = 1
;persistent = 0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time>50
;ignorehitpause =
;persistent =

;Horizontal BG speedlines
[Statedef 3580]
type = A
movetype = I
physics = N
anim = 15999
velset = 0,0

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 =  1
flag = timerfreeze
ignorehitpause = 1

[State 2260, flash]
type = PalFX
trigger1 = TimeMod = 4,0
trigger1 = 1
time = 1
invertall = 1
ignorehitpause = 0

[state 3250, speedlines]
type = explod
trigger1 = time = 0
anim = 2923
ID = 2923
postype = back
pos = 0,10
bindtime = -1
supermove = 0
pausemovetime = 224
sprpriority = -1
ontop = 0
ownpal = 1
ignorehitpause = 1
removetime = -1 ;224

[state 3250, speedlines2]
type = explod
trigger1 = time = 0
anim = 2923
ID = 2923
postype = back
pos = 0,240
bindtime = -1
supermove = 0
pausemovetime = 224
sprpriority = -1
ontop = 0
ownpal = 1
ignorehitpause = 1
removetime = -1 ;224

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = root,Anim=4100
trigger1 = root,movehit ;AnimElemTime(1)=0
id = 2923
;ignorehitpause =
;persistent =


[state 3250, starfield]
type = null;explod
triggerall = !NumExplod(3517)
trigger1 = root,Anim=4100
trigger1 = root,movehit ;AnimElemTime(1)=0
anim = 3517
ID = 3517
postype = back
pos = -50,-10
vel = 0,-0.5
bindtime = 1
supermove = 0
pausemovetime = 224
sprpriority = -10
ontop = 0
ownpal = 1
ignorehitpause = 1
removetime = -1 ;224

[State 0, RemoveExplod]
type = null;RemoveExplod
trigger1 = root,Anim=4101
trigger1 = root,AnimElemTime(2)=0
id = 3517
;ignorehitpause =
;persistent =

[state 3250, speedlines]
type = explod
trigger1 = root,Anim=4101
trigger1 = root,AnimElemTime(2)=0
anim = 12773
ID = 2773
postype = back
pos = 10,0
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
pausemovetime = 0 ;145
removetime = -1

[state 3250, speedlines2]
type = explod
trigger1 = root,Anim=4101
trigger1 = root,AnimElemTime(2)=0
anim = 12773
ID = 2773
postype = back
pos = 240,0
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
pausemovetime = 0 ;145
removetime = -1


[State 2260, destroy horizontal]
type = RemoveExplod
trigger1 = root,stateno!=3510 ;cinematic dash
trigger1 = root,stateno!=[4400,4404] ;Finisher 0
trigger1 = root,stateno!=[4100,4104] ;Finisher 1
;trigger1 = root,stateno!=[4200,4202] ;Finisher 2
trigger1 = root,stateno!=4301 ;Finisher 3
trigger2 = root,NumHelper(19875) ;Hyper BG KO
ID = 2923

[State 2260, destroy starfield]
type = RemoveExplod
trigger1 = root,stateno!=3510 ;cinematic dash
trigger1 = root,stateno!=[4400,4404] ;Finisher 0
trigger1 = root,stateno!=[4100,4104] ;Finisher 1
;trigger1 = root,stateno!=[4200,4202] ;Finisher 2
trigger1 = root,stateno!=4301 ;Finisher 3
trigger2 = root,NumHelper(19875) ;Hyper BG KO
ID = 3517

[State 2260, destroy vertical]
type = RemoveExplod
trigger1 = root,stateno!=3510 ;cinematic dash
trigger1 = root,stateno!=[4400,4404] ;Finisher 0
trigger1 = root,stateno!=[4100,4104] ;Finisher 1
;trigger1 = root,stateno!=[4200,4202] ;Finisher 2
trigger1 = root,stateno!=4301 ;Finisher 3
trigger2 = root,NumHelper(19875) ;Hyper BG KO
ID = 2773

[State 2260, destroy]
type = DestroySelf
trigger1 = root,stateno!=3510 ;cinematic dash
trigger1 = root,stateno!=[4400,4404] ;Finisher 0
trigger1 = root,stateno!=[4100,4104] ;Finisher 1
trigger1 = root,stateno!=[4200,4202] ;Finisher 2
trigger1 = root,stateno!=4301 ;Finisher 3
trigger2 = root,NumHelper(19875) ;Hyper BG KO

;Vertical BG speedlines
[Statedef 3581]
type = A
movetype = I
physics = N
anim = 15999
velset = 0,0

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 =  1
flag = timerfreeze
ignorehitpause = 1

[State 2260, flash]
type = PalFX
trigger1 = TimeMod = 4,0
trigger1 = 1
time = 1
invertall = 1
ignorehitpause = 0

[state 3250, speedlines]
type = explod
trigger1 = !time
anim = 12774 ;12773
ID = 2773
postype = back
pos = 10,0
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
pausemovetime = 0 ;145
removetime = -1

[state 3250, speedlines2]
type = explod
trigger1 = !time
anim = 12774 ;12773
ID = 2773
postype = back
pos = 240,0
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
pausemovetime = 0 ;145
removetime = -1


[State 2260, destroy vertical]
type = RemoveExplod
trigger1 = root,stateno!=4203 ;Finisher 2
trigger1 = root,stateno!=[4302,4303] ;Finisher 3
trigger2 = root,NumHelper(19875) ;Hyper BG KO
ID = 2773

[State 2260, destroy]
type = DestroySelf
trigger1 = root,stateno!=4203 ;Finisher 2
trigger1 = root,stateno!=[4302,4303] ;Finisher 3
trigger2 = root,NumHelper(19875) ;Hyper BG KO

;After image helper
[StateDef 3590]
type = S
movetype = I
physics = N
ctrl = 0

[State 6666, 2] ;this will allow the helper to replicate the same animation than the root
type = ChangeAnim
triggerall = SelfAnimExist(root,Anim) ;prevent debug error on custom anims
trigger1 = Anim != (root, anim)
trigger2 = AnimElemNo(0) > (root, AnimElemNo(0))
value = root, anim
elem = root,AnimElemNo(0)
ignorehitpause = 1

[State 13001, Pos]
type = BindToRoot
trigger1 = time = 0
time = -1
facing = 1
pos = 0,0

[State 13001, NoVis]
type = AssertSpecial
trigger1 = 1
flag = invisible

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG

[State 13001, NoHit]
type = NotHitBy
trigger1 = 1
value = SCA

[State 13001, Aftimg]
type = AfterImage
trigger1 = Time = 0
time = 60 ;900
palbright = 0,-50,-50
palcontrast = 256,256,256
paladd = 100,-50,-50
;color = 0
trans = add1

[State 13001, EndImg]
type = AfterImageTime
trigger1 = Root, Stateno != [3500,3501]
time = 1

[State 13001, End]
type = DestroySelf
trigger1 = Root, StateNo != [3500,3501]

;Killed by BEAM
[Statedef 3591]
type    = L
movetype= H
physics = N
ctrl = 0
sprpriority = 7

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 1

[State 4005, vel Y]
type = posset
trigger1 = !time
x = ifelse(facing=1, -180, 180)

[State 3000, hit anim]
type = ChangeAnim2
trigger1 = Anim!=5943
value = 5943
ignorehitpause = 1

[State 13300, Fadeout]
type = PalFX
trigger1 = Time = [0,30]
time = 1
add = -8*(Time),-8*(Time),-8*(Time)

[State 13300, Fadeout]
type = PalFX
trigger1 = Time >= 30
time = 1
add = -256,-256,-256

[State 3000, shaking]
type = PosAdd
trigger1 = time<30
Y = ifelse(time%4=0,-2,ifelse(time%4=2,2,0))
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

;This prevent freeze game
[State 49999, 5]
type = ChangeState
trigger1 = time >99
value = 5942

;Clockwork Overdrive Lv2
[Statedef 3600]
type    = S
movetype= A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 1 ;-9
facep2 = 1

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1
[State 4000, threshold usage]
type = VarAdd
triggerall = NumHelper(4750)
trigger1 = !time
var(52)=-1400
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 3600
;elem = 1
;ignorehitpause =
;persistent =

[State 0, VarSet] ;reset hitcounter
type = VarSet
trigger1 = !time
var(3) = 0
ignorehitpause = 1
;persistent =

[State -2, VarSet] ;reset Blitz Deadend cancel
type = VarSet
trigger1 = !time
var(40)=0
ignorehitpause = 1
;persistent =

[State 3320, AssertSpecial]
type = AssertSpecial
trigger1 = time = [5,45]
flag = noBG
flag2 = noFG
ignorehitpause = 1

[State 3320, nhb]
type = nothitby
trigger1 = time<45
value = SCA

[State 3320, superpause]
type = superpause
trigger1 = time = 5
time = 40
movetime = 40
p2defmul = 1
unhittable = 1
anim = -1
darken = 0

[State 3320, Hyper Charge FX]
type = Explod
trigger1 = time = 5
anim = 2440
id = 2440
pos = 19,-70 ;17,-90
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 1,1
removeongethit = 1
persistent = 0

[State 3320, Superpause charge sound]
type = PlaySnd
trigger1 = time = 5
value = 3600,0
[State 0, PowerAdd]
type = PowerAdd
trigger1 = time = 5
value = Cond(!NumHelper(4750),-2000,0)
;ignorehitpause =
;persistent =

[State 9000, snd] ;attack calling
type = playsnd
triggerall = random<300
trigger1 = AnimElemTime(4)=0
value = 3610,random%2
channel = 0
volumescale = 300
persistent = 0
[State 9000, snd] ;assorted voices
type = playsnd
triggerall = random<500
trigger1 = AnimElemTime(4)=1
value = 9000,random%6
channel = 0
lowpriority = 1
volumescale = 300
persistent = 0

[State 0, PosAdd] ;kick
type = PosAdd
trigger1 = AnimElemTime(5)=0
x = 34
;ignorehitpause =
;persistent =
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(8)=0
x = -34
;ignorehitpause =
;persistent =

[State 0, VarSet] ;track X position
type = VarSet
trigger1 = AnimElemTime(12)=0 ;!time
var(9) = floor(pos X)
ignorehitpause = 1
;persistent =

[State 3320, Ghost Master]
type = Explod
trigger1 = AnimElemTime(12)=7
anim = 3610
id = 3610
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 3320, Ghost warp sound]
type = PlaySnd
trigger1 = AnimElemTime(12)=7
trigger2 = AnimElemTime(17)=0
trigger3 = AnimElemTime(18)=7
trigger4 = AnimElemTime(23)=0
trigger5 = AnimElemTime(24)=7
trigger6 = AnimElemTime(29)=0
trigger7 = AnimElemTime(30)=7
trigger8 = AnimElemTime(41)=0
trigger9 = AnimElemTime(36)=7
trigger10 = AnimElemTime(35)=0
value = 3600,50

[State 0, VelSet]
type = VelSet
trigger1 = AnimElemTime(13)=0
trigger2 = AnimElemTime(19)=0
trigger3 = AnimElemTime(25)=0
trigger4 = AnimElemTime(31)=0
trigger5 = AnimElemTime(37)=0
x = 20+5*(AnimElemTime(31)=0)
;ignorehitpause =
;persistent =

[State 255, hit]
type = HitDef
trigger1 = AnimElem = 6
trigger2 = AnimElem = 16
trigger3 = AnimElem = 22
trigger4 = AnimElem = 28
trigger5 = AnimElem = 34
trigger6 = AnimElem = 40
attr = S, HA
animtype  = Hard
damage = ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 4-3*(AnimElem = 6),13+9*(AnimElem = 6) ;13,13
guard.pausetime = 13,5 ;13,13
sparkno = s7030 +0*(var(3):=hitcount)
guard.sparkno = s7000
sparkxy = -10-random%20,-50-random%20
hitsound   = s5,5
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9+1.5*(hitcount)
air.velocity = -4+0.5*(hitcount),-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
ID = 3600

[State 0, Projectile]
type = Projectile
trigger1 = MoveHit = 1
ProjID = 3001
projanim = 15999
projremovetime = 1
ignorehitpause=1


[State 0, VelSet]
type = VelSet
trigger1 = AnimElemTime(16)=0
trigger2 = AnimElemTime(22)=0
trigger3 = AnimElemTime(28)=0
trigger4 = AnimElemTime(34)=0
trigger5 = AnimElemTime(40)=0
x = 0
;ignorehitpause =
;persistent =

[State 3320, Ghost 1]
type = Explod
trigger1 = AnimElemTime(17)=0
anim = 3611
id = 3611
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, PosSet] ;reset pos
type = PosSet
trigger1 = AnimElemTime(17)=2
x = var(9)
;ignorehitpause =
;persistent =

[State 3320, Ghost Master]
type = Explod
trigger1 = AnimElemTime(18)=7
anim = 3610
id = 3610
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 3320, Ghost 2]
type = Explod
trigger1 = AnimElemTime(23)=0
anim = 3612
id = 3612
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, PosSet] ;reset pos
type = PosSet
trigger1 = AnimElemTime(23)=2
x = var(9)
;ignorehitpause =
;persistent =

[State 3320, Ghost Master]
type = Explod
trigger1 = AnimElemTime(24)=7
anim = 3610
id = 3610
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 3320, Ghost 3]
type = Explod
trigger1 = AnimElemTime(29)=0
anim = 3613
id = 3613
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, PosSet] ;reset pos
type = PosSet
trigger1 = AnimElemTime(29)=2
x = var(9)
;ignorehitpause =
;persistent =

[State 3320, Ghost Master]
type = Explod
trigger1 = AnimElemTime(30)=7
anim = 3610
id = 3610
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, PosAdd] ;ballistic kiss
type = null;PosAdd
trigger1 = AnimElemTime(32)=0
y = -50
;ignorehitpause =
;persistent =

[State 3320, Ghost 4]
type = Explod
trigger1 = AnimElemTime(35)=0
anim = 3614
id = 3614
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, PosSet] ;reset pos
type = PosSet
trigger1 = AnimElemTime(35)=2
x = var(9)
;ignorehitpause =
;persistent =

[State 0, PosAdd]
type = null;PosAdd
trigger1 = AnimElemTime(36)=0
y = 50
;ignorehitpause =
;persistent =

[State 3320, Ghost Master]
type = Explod
trigger1 = AnimElemTime(36)=7
anim = 3610
id = 3610
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 3320, Ghost 2]
type = Explod
trigger1 = AnimElemTime(41)=0
anim = 3612
id = 3612
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 9000, snd] ;attack calling
type = playsnd
triggerall = var(3)>=4
trigger1 = AnimElemTime(41)=0
value = 3611,random%2
channel = 0
volumescale = 300
persistent = 0


[State 0, PosSet] ;reset pos
type = PosSet
trigger1 = AnimElemTime(41)=2
x = var(9)
;ignorehitpause =
;persistent =

[State 0, ChangeState] ;To blast
type = ChangeState
triggerall = var(3)>=4
trigger1 = !animtime
value = 3601
ctrl = 0
ignorehitpause = 1
;persistent =

[State 0, ChangeState] ;To normal
type = ChangeState
triggerall = var(3)<4
trigger1 = !animtime
value = 0
ctrl = 1
ignorehitpause = 1
;persistent =

;CO Blast
[Statedef 3601]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 3601
velset = 0,0
sprpriority = 1 ;-9

;TEMP EMO
[State 4000, threshold freeze]
type = Explod
triggerall = NumHelper(4750)
trigger1 = !NumExplod(4000)
anim = 9999
ID = 4000
pos = 0,0
postype = p1
removetime = 1

[State 0, ChangeAnim] ;freeze anim until target is on ground
type = ChangeAnim
triggerall = Anim=3601
trigger1 = NumTarget(3600)
trigger1 = target(3600),statetype=A
value = 3601
elem = 1
ignorehitpause = 1
;persistent = 0


[State 0, TargetState]
type = TargetState
triggerall = NumTarget(3600)
;trigger1 = time<15
trigger1 = target(3600),HitOver=1
value = 1412
ID = -1
;ignorehitpause =
persistent = 0

[State 13100, charge sound]
type = playsnd
triggerall = !NumExplod(3605)
trigger1 = Anim=3601
trigger1 = AnimElemTime(3)=0
value = 3606,0
volumescale = 255
persistent = 0

[State 3200, FX charge ball]
type = Helper
trigger1 = Anim=3601
trigger1 = AnimElemTime(3)=0
helpertype = normal
name = "CO Beam Start"
postype = P1
pos = 16,-63
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 9999
id = 3609
stateno = 3609
ignorehitpause = 1
persistent = 0

[State 3320, FX beam charge]
type = Explod
triggerall = !NumExplod(3605)
trigger1 = Anim=3601
trigger1 = AnimElemTime(4)=0
anim = 3605
id = 3605
pos = 0,0
postype = p1
supermovetime = 0 ;9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 3200, Beam]
type = Helper
trigger1 = Anim=3601
trigger1 = AnimElemTime(4)=3
;trigger1 = time%15=11
helpertype = normal
name = "CO Beam"
postype = P1
pos = 93,-47
facing = 1
ownpal = 1
supermovetime = 0 ;9999
pausemovetime = 9999
id = 3606
stateno = 3606
ignorehitpause = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim=3601
trigger1 = time>90;70 ;90
value = 3602
;ignorehitpause =
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = Anim=3602
trigger1 = !animtime
value = 0
ctrl = 1
;anim =
ignorehitpause = 1
;persistent =

;TEMP EMO activation
[Statedef 4000]
type = S
movetype = I
physics = S
anim = 195
velset = 0,0
ctrl = 0
poweradd = -2000

[State 200, BGPalFX]
type = BGPalFX
trigger1 = time=[0,78];[0,97]
time = 1
add	= -100,-100,-100
mul	= 256,100,100
invertall = 0
color = 256

[State 3000, superpause]
type = superpause
trigger1 = time=0
time = 78 ;97
p2defmul = 1
unhittable = 1
anim = -1
sound = s2350,2
darken = 0
movetime = 78 ;97

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 13100, shake]
type = envshake
trigger1 = !(time%12)
time = 12
freq = 130
ampl = 5

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(52) = 0
;ignorehitpause =
;persistent =

[State -2, emoGauge]
type = helper
triggerall = !NumHelper(4750) && teamside = 1
trigger1 = !time
ID = 4750
stateno = 4750
pos = 20, 0
postype = left
helpertype = normal
name = "emo"
pausemovetime = 999999
supermovetime = 999999
sprpriority = 7
ownpal = 1
keyctrl = 0
ignorehitpause = 1
[State -2, emoGauge]
type = helper
triggerall = !NumHelper(4750) && teamside = 2
trigger1 = !time
ID = 4750
stateno = 4760
pos = 20, 0
postype = left
helpertype = normal
name = "emo"
pausemovetime = 999999
supermovetime = 999999
sprpriority = 7
ownpal = 1
keyctrl = 0
ignorehitpause = 1


[State 3000, Buffer var]
type = null;varset
trigger1 = !time
var(53) = 1000

[State 3000, Flame var]
type = null;varset
trigger1 = !time
var(58) = 0

[State 195, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

;Overheat Dizzy
[Statedef 4001]
type = S
movetype = I
physics = S
velset = 0, 0
anim = 5300

[State 0, VarSet] ;reset overheat buffer
type = VarSet
trigger1 = !time
var(52) = 0
ignorehitpause = 1
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = time=168 ;!animtime
value = 0
ctrl = 1
ignorehitpause = 1
;persistent =

;F1_Death by degrees
[Statedef 4100]
type = A
physics = N ;S
movetype = A
anim = 4100
ctrl = 0
velset = 0,0
sprpriority = 6

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 40, 4]; fall
type = Veladd
trigger1 = 1
Y = 0.8 ;0.9

[State 0, VarSet] ;reset overheat buffer
type = VarSet
trigger1 = var(52)>=0
trigger1 = !time
var(52) = 0
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 3515
;ignorehitpause =
;persistent =

[State 0, PlaySnd] ;leap
type = PlaySnd
trigger1 = !time
value = 1200,0
;ignorehitpause =
;persistent =


[State 40, 4]
type = VelSet
trigger1 = !time
x = 5
y = -12
persistent = 0

[State 40, 4]
type = VelSet
trigger1 = AnimElemTime(10)=0
x = 0
y = 10
persistent = 0

[State 255, hit]
type = HitDef
trigger1 = time>=0
attr = A, HA
animtype  = Hard
damage = ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 6,14 ;1,10 ;13,13
guard.pausetime = 13,13 ;13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = 0,-10
hitsound   = s5,5
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
ID = 4100
persistent = 0
kill = 0

[State 3554, Exclamation]
type = Explod
triggerall = !NumExplod(3559)
trigger1 = numtarget(4100)
trigger1 = movehit
anim = 3559
id = 3559
pos = 0,-10
postype = p2 ;back
sprpriority = -5
bindtime = -1
removetime = 20
scale = 1,1 ;.84, 1.07
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1
;ontop = 1

[State 1000, shake]
type = EnvShake
triggerall = NumExplod(3559)
trigger1 = !(time%4)
time=4
freq=80
ampl=20+0.02*time

[State 0, TargetBind]
type = TargetBind
trigger1 = numtarget(4100)
trigger1 = movehit
time = 1
id = 4100
pos = 0,0
ignorehitpause = 1
;persistent =

[State 0, TargetState]
type = TargetState
trigger1 = numtarget(4100)
trigger1 = movehit
value = 4120
ID = 4100
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = numtarget(4100)
trigger1 = movehit
x = 0
y = 0
ignorehitpause = 1
;persistent =


[State 0, ChangeState]
type = ChangeState
trigger1 = numtarget(4100)
trigger1 = movehit
value = 4101
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

;F1_DbD_Bounce
[Statedef 4101]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 4101
velset = 0,0
sprpriority = 6
;hitdefpersist = 1
;movehitpersist = 1

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA


[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, TargetState]
type = TargetState
trigger1 = numtarget(4100)
trigger1 = AnimelemTime(2)<0
value = 4120
ID = 4100
ignorehitpause = 1
;persistent =

[State 1000, shake]
type = EnvShake
triggerall = AnimelemTime(2)<0 ;time=[0,20]
trigger1 = !(time%4)
time=4
freq=80
ampl=5+0.02*time

[State 0, VelSet]
type = VelSet
trigger1 = AnimelemTime(2)=0
x = 6
y = -4
ignorehitpause = 1
persistent = 0

[State 0, VelMul X];slow down
type = VelMul
triggerall = vel x>0
trigger1 = AnimelemTime(4)>=0
x = 0.75
ignorehitpause = 1
[State 0, VelMul Y];slow down
type = VelMul
triggerall = vel y<0
trigger1 = AnimelemTime(4)>=0
y = 0.5
ignorehitpause = 1

[State 0, VelSet X]
type = VelSet
trigger1 = vel x<=0
x = 0
ignorehitpause = 1
[State 0, VelSet Y]
type = VelSet
trigger1 = vel y>=0
y = 0
ignorehitpause = 1

[State 2201, Destructo Disc A]; Destructo Disc
type = Helper
trigger1 = !NumHelper(4150)
trigger1 = AnimelemTime(4)=0
pos = 0,0
postype = p1
stateno = 4150
helpertype = normal
name = "Destructo Disc 1"
id = 4150
ownpal = 1
supermovetime = 9999 ;150
pausemovetime = 9999 ;150
sprpriority = 5
[State 2201, Destructo Disc B]; Destructo Disc
type = Helper
trigger1 = !NumHelper(4151)
trigger1 = AnimelemTime(4)=0
pos = 0,0
postype = p1
stateno = 4150
helpertype = normal
name = "Destructo Disc 2"
id = 4151
ownpal = 1
supermovetime = 9999 ;150
pausemovetime = 9999 ;150
sprpriority = 5

[State 9000, snd] ;assorted voices
type = playsnd
;triggerall = random<500
trigger1 = AnimelemTime(4)=0
value = 9000,random%6
channel = 0
lowpriority = 1
volumescale = 300
persistent = 0


[State 0, ChangeState]
type = ChangeState
trigger1 = time=60 ;100
value = 4102
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;F1_Dbd_Launch
[Statedef 4102]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 4102
velset = 0,0
sprpriority = 6
;hitdefpersist = 1
;movehitpersist = 1

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA


[State 0, Black Curtain]
type = Helper
triggerall = !NumHelper(3516)
trigger1 = Anim=4102
trigger1 = AnimElemTime(12)=12
helpertype = normal ;player
name = "Black Curtain"
ID = 3516
stateno = 3516
pos = 160,240
postype = left    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[State 0, Turn]
type = Turn
trigger1 = !animtime
;ignorehitpause =
;persistent =

[State 0, PosAdd]
type = PosAdd
trigger1 = !animtime
x = 5
y = 36
;ignorehitpause =
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 4103
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;F1_Dbd_end
[Statedef 4103]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 4103
velset = 0,0
sprpriority = 6
;hitdefpersist = 1
;movehitpersist = 1

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA


[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = -500
;ignorehitpause =
;persistent =

[State 0, ChangeState] ;Go to Wait
type = ChangeState
trigger1 = time=100 ;!animtime
value = 4104
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;FAKE WAIT
[Statedef 4104]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 4103
velset = 0,0
sprpriority = 6
;hitdefpersist = 1
;movehitpersist = 1

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1


[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =


[State 0, PosSet]
type = PosSet
trigger1 = !time
y = -500
;ignorehitpause =
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = time=40 ;80;100 ;!animtime
value = 50
ctrl = 1
;anim =
;ignorehitpause =
;persistent =

;Destructo Disc
[Statedef 4150]
type = A
movetype = A
physics = N
anim = 4150
ctrl = 0
sprpriority = 20

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =


[State 0, BindToParent]
type = BindToParent
trigger1 = IsHelper(4150)
time = 1
;facing = 0
pos = -27,-103
;ignorehitpause =
;persistent =
[State 0, BindToParent]
type = BindToParent
trigger1 = IsHelper(4151)
time = 1
;facing = 0
pos = 42,-73
;ignorehitpause =
;persistent =

[State 38121, Offset]
type = Offset
trigger1 = IsHelper(4150)
y = 1.0*cos(time)
ignorehitpause = 1
[State 38121, Offset]
type = Offset
trigger1 = IsHelper(4151)
y = 1.0*sin(time)
ignorehitpause = 1

[State 0, charge]
type = PlaySnd
trigger1 = !time
value = 4150,0
channel = 9

[State 0, ChangeState] ;to launch
type = ChangeState
trigger1 = root,stateno=4102
value = 4151
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno!=[4101,4102]
;ignorehitpause =
;persistent =

;DD - Launch
[Statedef 4151]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 20
facep2 = Cond(IsHelper(4150),1,0)

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 4151, Disc 1]
type = ChangeAnim
trigger1 = !time
trigger1 = IsHelper(4150)
value = 4151
;ignorehitpause =
;persistent =
[State 4151, Disc 2]
type = ChangeAnim
trigger1 = !time
trigger1 = IsHelper(4151)
value = 4155
;ignorehitpause =
;persistent =

[State 4151, Disc 1]
type = Offset
trigger1 = IsHelper(4150)
y = 1.0*cos(time)
ignorehitpause = 1
[State 4151, Disc 2]
type = Offset
trigger1 = IsHelper(4151)
y = 1.0*sin(time)
ignorehitpause = 1


[State 4151, Disc 1]
type = BindToParent
trigger1 = IsHelper(4150)
trigger1 = root,Anim=4102
trigger1 = root,AnimElemtime(1)>=0 && root,AnimElemtime(2)<0
time = 1
;facing = 0
pos = -12,-115
;ignorehitpause =
;persistent =
[State 4151, Disc 1]
type = BindToParent
trigger1 = IsHelper(4150)
trigger1 = root,Anim=4102
trigger1 = root,AnimElemtime(2)>=0 && root,AnimElemtime(3)<0
time = 1
;facing = 0
pos = 25,-115
;ignorehitpause =
;persistent =
[State 4151, Disc 2]
type = BindToParent
trigger1 = IsHelper(4151)
trigger1 = root,Anim=4102
trigger1 = root,AnimElemtime(1)>=0 && root,AnimElemtime(2)<0
time = 1
;facing = 0
pos = 57,-50
;ignorehitpause =
;persistent =
[State 4151, Disc 2]
type = BindToParent
trigger1 = IsHelper(4151)
trigger1 = root,Anim=4102
trigger1 = root,AnimElemtime(2)>=0 && root,AnimElemtime(3)<0
time = 1
;facing = 0
pos = 63,-40
;ignorehitpause =
;persistent =
[State 4151, Disc 2]
type = BindToParent
trigger1 = IsHelper(4151)
trigger1 = root,Anim=4102
trigger1 = root,AnimElemtime(3)>=0 && root,AnimElemtime(5)<0
time = 1
;facing = 0
pos = 24,-90
;ignorehitpause =
;persistent =
[State 4151, Disc 2]
type = BindToParent
trigger1 = IsHelper(4151)
trigger1 = root,Anim=4102
trigger1 = root,AnimElemtime(5)>=0 && root,AnimElemtime(6)<0
time = 1
;facing = 0
pos = 22,-93
;ignorehitpause =
;persistent =
[State 4151, Disc 2]
type = BindToParent
trigger1 = IsHelper(4151)
trigger1 = root,Anim=4102
trigger1 = root,AnimElemtime(6)>=0 && root,AnimElemtime(7)<0
time = 1
;facing = 0
pos = 29,-77
;ignorehitpause =
;persistent =
[State 4151, Disc 2]
type = BindToParent
trigger1 = IsHelper(4151)
trigger1 = root,Anim=4102
trigger1 = root,AnimElemtime(7)>=0 && root,AnimElemtime(8)<0
time = 1
;facing = 0
pos = 20,-27
;ignorehitpause =
;persistent =


[State 0, Disc 1 launch]
type = PlaySnd
;trigger1 = !time
trigger1 = IsHelper(4150)
trigger1 = Anim=4151
trigger1 = !animtime
value = 4150,3
channel = 9

[State 4151, Disc 1];go to launch
type = ChangeAnim
trigger1 = IsHelper(4150)
trigger1 = Anim=4151
trigger1 = !animtime
value = 4152
;ignorehitpause =
;persistent =
[State 4151, Disc 1] ;reposition
type = PosAdd
trigger1 = IsHelper(4150)
trigger1 = Anim=4152
trigger1 = AnimElemTime(1)=0
x = 80
y = 90
;ignorehitpause =
;persistent =
[State 0, Disc 2 launch]
type = PlaySnd
trigger1 = IsHelper(4151)
trigger1 = Anim=4155
trigger1 = !animtime
value = 4150,3
channel = 9
[State 4151, Disc 2];go to launch
type = ChangeAnim
trigger1 = IsHelper(4151)
trigger1 = Anim=4155
trigger1 = !animtime
value = 4156
;ignorehitpause =
;persistent =
[State 4151, Disc 2]
type = Turn
trigger1 = IsHelper(4151)
trigger1 = Anim=4156
trigger1 = AnimElemTime(1)=0
;ignorehitpause =
;persistent =
[State 4151, Disc 2] ;reposition
type = PosAdd
trigger1 = IsHelper(4151)
trigger1 = Anim=4156
trigger1 = AnimElemTime(1)=0
x = 40
y = 70
;ignorehitpause =
;persistent =
[State 4151, Disc 1]
type = VelSet
trigger1 = IsHelper(4150)
trigger1 = Anim=4152
trigger1 = AnimElemTime(1)>=0
;x = 2
;y = 1
X = 20*sin(time/10.0); 20*cos(time/5.0)
Y = -15*cos(time/10.0) ;20*sin(time/10.0)
;ignorehitpause =
;persistent = 0
[State 4151, Disc 2]
type = VelSet
trigger1 = IsHelper(4151)
trigger1 = Anim=4156
trigger1 = AnimElemTime(1)>=0
;x = 6
;y = -0.5
X = -25*cos(time/10.0)
Y = 20*sin(time/10.0)
;ignorehitpause =
;persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = IsHelper(4150)
trigger1 = Anim=4152
trigger1 = pos Y>100
value = 9999
ignorehitpause = 1
;persistent =
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = IsHelper(4151)
trigger1 = Anim=4156
trigger1 = pos X!=[-180,180]
value = 9999
ignorehitpause = 1
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno=4103
value = 4152
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;DD - Hit
[Statedef 4152]
type = A
movetype = A
physics = N
ctrl = 0
anim = 4157
velset = 0,0
sprpriority = 20
;facep2 = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = null;PosSet
trigger1 = !time
x = Cond(IsHelper(4150),-250*facing,500*facing)
y = Cond(IsHelper(4150),-300,-600)
;ignorehitpause =
;persistent =
[State 0, PosSet] ;TEMP
type = PosSet
trigger1 = !time
;x = Cond(IsHelper(4150),-150*facing,150*facing)
;y = Cond(IsHelper(4150),-270,-270)
x = Cond(IsHelper(4150),-200*facing,200*facing)
y = Cond(IsHelper(4150),-290,-290)
;ignorehitpause =
;persistent =

[State 0, damage]
type = PlaySnd
trigger1 = !time
value = 4150,4
channel = 8
lowpriority = 1


[State 0, Turn];wrong side
type = Turn
triggerall = pos x<0
trigger1 = time=1
trigger1 = facing=-1 ;=enemy,facing
;ignorehitpause =
persistent = 0
[State 0, Turn];wrong side
type = Turn
triggerall = pos x>0
trigger1 = time=1
trigger1 = facing=1 ;=enemy,facing
;ignorehitpause =
persistent = 0


[State 0, VelSet]
type = null;VelSet
trigger1 = time=15
x = 8;*facing ;Cond(IsHelper(4151),8,-8)
y = 8
;ignorehitpause =
;persistent =

[State 4151, Disc 2]
type = VelSet
trigger1 = time>=10
;X = 17*sin((time-10)/10.0)
X = Cond(movehit=0,17*sin((time-10)/10.0),20*cos((time-10)/10.0))
;Y = -17*cos((time-10)/10.0)
Y = Cond(movehit=0,-17*cos((time-10)/10.0),17*cos((time-10)/10.0));*-1*(movehit)

[State 3005, hit]
type = hitdef
trigger1 = time%10 ;5
attr = A,HP
hitflag = MAFD
guardflag = MA
priority = 7,Hit
;damage = ceil(20*root,fvar(15)), ceil(5*root,fvar(15))
;damage = ceil(ifElse(root,fvar(11) * 20 < 7, 7, root,fvar(11) *20)),5
damage = 4,4 ;10,10
getpower = 0,0
givepower = 35,35
pausetime = 0,10 ;5
guard.pausetime = 0,8
animtype = Low
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 1 ;13
airguard.ctrltime = 16
ground.velocity= -3,-7
guard.velocity = -0.75
air.velocity= 0,0 ;-1,-3 ;-0.3
airguard.velocity = -1.625, -0.75
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
sparkno = -1
guard.sparkno = -1 ;s7000
hitsound   = -1 ;s4150,5
guardsound = S6,0
envshake.time = 8
envshake.ampl = 3
envshake.freq = 100
palfx.add=256,256,256
palfx.mul=256,256,256
palfx.time=16 ;32
p1sprpriority = -5
p2stateno = 4123
ID = 4152

[State 0, EnvColor]
type = null;EnvColor
trigger1 = movehit
value = 255,255,255
time = 1
;under = 0
ignorehitpause = 1
;persistent =

[State 0, Pause]
type = Pause
triggerall = NumTarget(4152)
trigger1 = gametime%3=0
trigger1 = movehit>3
time = 2
movetime = 0
;endcmdbuftime = 0
;pausebg = 1
ignorehitpause = 1
;persistent =



[State 0, VelMul]
type = VelMul
triggerall = movehit
trigger1 = IsHelper(4150)
trigger2 = IsHelper(4151)
x = 1.1
y = 0.7
;ignorehitpause =
;persistent =

[State 0, damage]
type = PlaySnd
trigger1 = movehit
value = 4150,5
channel = 9
lowpriority = 1

[State 0, Explod]
type = Explod
triggerall = !NumExplod(4153)
trigger1 = IsHelper(4150)
trigger1 = Anim=4157
trigger1 = movehit
;trigger1 = hitcount>3
anim = 4153
ID = 4153
pos = 0,-50
postype = p2  ;p2,front,back,left,right
facing = -1
vfacing = 1
bindtime = -1
removetime = -1
pausemovetime = 999
scale = 1,1
sprpriority = 10
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
;ignorehitpause =
;trans =
persistent = 0
;supermove = 0
;pausemove = 0
[State 0, Explod]
type = Explod
triggerall = !NumExplod(4157)
trigger1 = IsHelper(4151)
trigger1 = Anim=4157
trigger1 = movehit
;trigger1 = hitcount>3
anim = 4153
ID = 4157
pos = 0,-50
postype = p2  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
pausemovetime = 9999
scale = 1,1
sprpriority = 10
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
;ignorehitpause =
;trans =
persistent = 0
;supermove = 0
;pausemove = 0


[State 0, ChangeAnim]
type = null;ChangeAnim
trigger1 = IsHelper(4150)
trigger1 = Anim=4157
trigger1 = hitcount>3
value = 9999
ignorehitpause = 1
;persistent =
[State 0, ChangeAnim]
type = null;ChangeAnim
trigger1 = IsHelper(4151)
trigger1 = Anim=4157
trigger1 = hitcount>3
value = 9999
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = IsHelper(4150)
;trigger1 = root,Anim=4102
;trigger1 = root,AnimElemtime(12)>=10
trigger1 = root,stateno!=[4101,4103]
id = 4153
;ignorehitpause =
;persistent =
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = IsHelper(4151)
;trigger1 = root,Anim=4102
;trigger1 = root,AnimElemtime(12)>=10
trigger1 = root,stateno!=[4101,4103]
id = 4157
;ignorehitpause =
;persistent =

[State 0, StopSnd]
type = StopSnd
trigger1 = movehit ;Anim=9999
channel = 8
;ignorehitpause =
;persistent =

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno!=[4101,4103]
;ignorehitpause =
;persistent =

;Target - going down
[Statedef 4120]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 3020, 2]
type = changeanim2
trigger1 = !time && anim !=4120
value = 4120

[State 4005, vel Y]
type = velset
trigger1 = time=6 ;animelemtime(2)=0
y = 8
;x = -4
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = pos Y>=300
x = 0
y = 0
;ignorehitpause =
persistent = 0

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = enemy,stateno=4103
value = 4121
;elem = 1
;ignorehitpause =
persistent = 0
[State 0, PosSet]
type = PosSet
trigger1 = enemy,stateno=4103
y = -400
;ignorehitpause =
persistent = 0
[State 4005, vel Y]
type = velset
trigger1 = enemy,stateno=4103
y = 8
persistent = 0

[State 0, VelSet]
type = VelSet
triggerall = enemy,stateno=4103
trigger1 = Anim=4121
trigger1 = pos Y>-90
y = 0
;ignorehitpause =
;persistent =

[State 4005, vel Y] ;just in case the discs fail...
type = velset
trigger1 = enemy,stateno=50
y = 8
persistent = 0

[State 3052, Land];just in case the discs fail...
type = changestate
trigger1 = enemy,stateno=50
trigger1 = Pos Y >= 0
trigger1 = Vel Y > 0
value = 4121

;Target - Bounce
[Statedef 4121]
type    = L
movetype= H
physics = N
velset = 0,0

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = AnimTime = 0
y = -10 ;-7

[State 111, 1]
type = StateTypeSet
trigger1 = AnimTime = 0
physics = A

[State 5100, 12]
type = null;SelfState
trigger1 = AnimTime = 0
value = 5050

[State 0, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 4122
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;Target - Going up
[Statedef 4122]
type    = A
movetype= H
physics = N

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= IfElse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, 3] ;Gravity
type = VelAdd
trigger1 = time > 0  ;Vans Fix !!!
y = GetHitVar(yaccel)

[State 5050, 6]
type = Selfstate ;ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, Const(movement.air.gethit.groundlevel))
value = 5100 ;Downed get-hit (hit ground from fall)

;Target - hit by disc
[Statedef 4123]
type    = A
movetype= H
physics = N
;velset = 0,0

[State 0, PalFX]
type = null;PalFX
trigger1 = !time
time = 1
add = 256,256,256
mul = 256,256,256
;sinadd = 0,0,0,10
invertall = 0
color = 256
ignorehitpause = 1
;persistent =



[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= IfElse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, 3] ;Gravity
type = null;VelAdd
trigger1 = time > 0  ;Vans Fix !!!
y = GetHitVar(yaccel)

[State 0, VelMul]
type = VelMul
trigger1 = !time
y = 0.5
ignorehitpause = 1
;persistent =

[State 0, PosAdd]
type = null;PosAdd
trigger1 = enemy,stateno=4104 ;fake wait
y = -3
;ignorehitpause =
;persistent =


[State 4005, vel Y] ;just in case the discs fail...
type = velset
trigger1 = enemy,stateno=50
y = 16 ;8
persistent = 0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = enemy,stateno=50
value = 1
movecamera = 1,1
ignorehitpause = 1
;persistent =

[State 3052, Land];just in case the discs fail...
type = changestate
trigger1 = enemy,stateno=50
trigger1 = Pos Y >= 0
trigger1 = Vel Y > 0
value = 4124 ;4121


[State 5050, 6]
type = null;Selfstate ;ChangeState
;trigger1 = enemy,NumHelper(4150)=0
trigger1 = enemy,stateno=50 ; pos Y>-200
value = 5020 ;5100 ;Downed get-hit (hit ground from fall)

;Target - Stay on ground
[Statedef 4124]
type    = L
movetype= H
physics = N
velset = 0,0

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0
;ignorehitpause =
;persistent =

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 1412
;elem = 1
;ignorehitpause =
;persistent =

[State 5100] ;Dead
type = SelfState
triggerall = !Alive
trigger1 = Time=30
value = 5150

[State 5100]
type = SelfState
triggerall = Alive
trigger1 = Time=30
value = 5120

;F2_Infinity Engine
[Statedef 4200]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 9999
velset = 0,0
sprpriority = 10

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, VarSet] ;reset overheat buffer
type = VarSet
trigger1 = var(52)>=0
trigger1 = !time
var(52) = 0
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 3515
;ignorehitpause =
;persistent =

[State 801, teleport sound]
type = PlaySnd
trigger1 = !time
value = 810,0

[State 801, MJ] ;"Beat it loser!"
type = PlaySnd
trigger1 = !time
value = 4200,50+random%3
channel = 0

[State 0, Turn]
type = Turn
trigger1 = Anim=4322
trigger1 = AnimElemTime(2)=0
;ignorehitpause =
persistent = 0


[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 4200
;ignorehitpause =
;persistent =

[State 0, PosAdd]
type = PosAdd
trigger1 = Anim=4200
trigger1 = AnimElemTime(4)=0
x = 200
;ignorehitpause =
persistent = 0

[State 0, PosSet]
type = PosSet
trigger1 = Anim=4200
trigger1 = AnimElemTime(4)=0
y = 0
;ignorehitpause =
;persistent =

[State 0, Turn]
type = Turn
trigger1 = Anim=4200
trigger1 = AnimElemTime(4)=0
;ignorehitpause =
persistent = 0

[State 801, teleport sound]
type = PlaySnd
trigger1 = Anim=4200
trigger1 = AnimElemTime(5)=0
value = 810,0

[State 40, 4]
type = VelSet
trigger1 = Anim=4200
trigger1 = AnimElemTime(10)=0
x = 4.5
y = -10
persistent = 0

[State 40, 4]; fall
type = Veladd
trigger1 = Anim=4200
trigger1 = AnimElemTime(10)>0
Y = 0.8 ;0.9

[State 255, hit]
type = HitDef
trigger1 = Anim=4200
trigger1 = AnimElem = 10
attr = S, HA
animtype  = Hard
damage = ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 13,13
guard.pausetime = 13,13
sparkno = -1 ;s7030
guard.sparkno = -1 ;s7000
sparkxy = -10-random%20,-50-random%20
hitsound   = s4200,10 ;s5,2
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
p2facing = -1
ID = 4200
fall = 1
fall.recover = 0
kill = 0

[State 1000, shake]
type = EnvShake
trigger1 = Anim=4200
trigger1 = AnimElem = 10
time=13
freq=80
ampl=20+0.02*time
ignorehitpause = 1

[State 3554, Exclamation]
type = Explod
triggerall = !NumExplod(3559)
trigger1 = numtarget(4200)
trigger1 = movehit
anim = 3559
id = 3559
pos = 30,-138
postype = p1 ;back
sprpriority = -5
bindtime = 1
removetime = -2
scale = 1,1 ;.84, 1.07
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
persistent = 0
;ontop = 1

[State 0, TargetState]
type = TargetState
trigger1 = numtarget(4200)
trigger1 = target,hitshakeover=1 ;movehit
value = 4250
ID = 4200
ignorehitpause = 1
;persistent =

[State 1600, Return&Landing]
type = ChangeAnim
trigger1 = Anim = 4200
trigger1 = AnimElemTime(15)>0
trigger1 = Pos Y >= -10
value = 4201

[State 1600, Stop]
type = VelSet
trigger1 = Anim = 4201
trigger1 = Vel Y > abs(Pos Y)
X = 0
Y = 0

[State 1600, Replace]
type = PosSet
triggerall = Anim = 4201
trigger1 = Vel Y = 0
trigger2 = pos Y > 10
Y = 0

[State 241, 1]  ;land sound
type = PlaySnd
trigger1 = Anim = 4201
trigger1 = AnimElemTime(2)=0
value = 40, 0
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = Anim = 4201
trigger1 = !animtime
value = 4201
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;F2_IE Charge Beam
[Statedef 4201]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 4202
velset = 0,0
sprpriority = 8

[State 9000, snd] ;attack calling
type = playsnd
trigger1 = AnimElemTime(4)=0
value = 3200,random%2
channel = 0
volumescale = 300
persistent = 0

[State 241, 1]  ;FX beam charge
type = PlaySnd
trigger1 = AnimElemTime(4)=0
value = 4270, 0
channel = 1
persistent = 0

[State 3320, FX beam charge]
type = Explod
triggerall = !NumExplod(4270)
trigger1 = AnimElemTime(4)=0
anim = 4270
id = 4270
pos = -5,-158
postype = p1
supermovetime = 0 ;9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 10
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = time=90 ;250
value = 4202
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;F2_IE Launch Beam
[Statedef 4202]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 4203
velset = 0,0
sprpriority = 8

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 4270
;ignorehitpause =
;persistent =

[State 241, 1]  ;FX beam launch
type = PlaySnd
trigger1 = !time
value = 3150, 0
channel = 1
persistent = 0

[State 9000, snd] ;attack calling
type = playsnd
trigger1 = !time
value = 4200,random%2
channel = 0
volumescale = 300
persistent = 0

[State 3320, FX ball aura]
type = Explod
triggerall = !NumExplod(4275)
trigger1 = !time
anim = 4275
id = 4275
pos = 10,-138
postype = p1
supermovetime = 0 ;9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 10
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 3320, FX beam aura]
type = Explod
triggerall = !NumExplod(4271)
trigger1 = !time
anim = 4271
id = 4271
pos = 10,-115 ;-108
postype = p1
supermovetime = 0 ;9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 9
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 1000, shake]
type = EnvShake
trigger1 = !time
time=5
freq=100
ampl=-10
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = time=60 ;200
value = 4203
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;F2_IE Offscren
[Statedef 4203]
type = A
physics = N
movetype = A
ctrl = 0
anim = 9999
velset = 0,0
sprpriority = 5

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, TargetState]
type = TargetState
trigger1 = !time
value = 4251
ID = -1
;ignorehitpause =
;persistent =


[State 2201, helper]; Background lines
type = Helper
trigger1 = !NumHelper(3581)
trigger1 = !time
pos = -640, -480
postype = back
stateno = 3581
helpertype = normal
name = "vertical_lines_BG"
id = 3581
ownpal = 1
supermovetime = 9999 ;150
pausemovetime = 9999 ;150
sprpriority = 5
size.xscale = 5
size.yscale= 5

[State 241, 1]  ;FX beam launch
type = PlaySnd
trigger1 = !time
value = 4270, 1
channel = 1
persistent = 0


[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 4271
;ignorehitpause =
;persistent =
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 4275
;ignorehitpause =
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = -350
ignorehitpause = 1
;persistent =

[State 2201, helper]; Beam
type = Helper
trigger1 = !NumHelper(4270)
trigger1 = time=30
pos = -640, -480
postype = back
stateno = 4270
helpertype = normal
name = "F2 Beam"
id = 4270
ownpal = 1
supermovetime = 9999 ;150
pausemovetime = 9999 ;150
sprpriority = 5

[State 0, Explod]
type = Explod
trigger1 = numtarget
trigger1 = time>40
trigger1 = time%5=0
anim = 7020+10*random%2
ID = 7010
pos = 0,-80
postype = p2
facing = IfElse(random<500,1,-1)
vfacing = IfElse(random<500,1,-1)
bindtime = 1
random = 30,30
removetime = -2
pausemovetime = 9999
sprpriority = 10
ontop = 1
shadow = 0,0,0
ownpal = 0
ignorehitpause = 1


[State 1000, shake]
type = EnvShake
trigger1 = numtarget
trigger1 = time>40
trigger1 = time%5=0
time=5
freq=80
ampl=20+0.02*time
ignorehitpause = 1

[State 0, HitAdd]
type = HitAdd
trigger1 = numtarget
trigger1 = time>40
trigger1 = time%5=0
value = 1
;ignorehitpause =
;persistent =

[State 241, 1]  ;FX beam hit
type = PlaySnd
trigger1 = numtarget
trigger1 = time>40
trigger1 = time%5=0
value = 3150,1

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = numtarget
trigger1 = time>40
trigger1 = time%5=0
value = -3
ID = -1
kill = 1
absolute = 0
;ignorehitpause =
;persistent =

[State 0, TargetState]
type = TargetState
trigger1 = time=210
value = 4252
ID = -1
;ignorehitpause =
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = time=210
value = 4204
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;F2_IE Stretch
[Statedef 4204]
type = A
physics = N
movetype = A
ctrl = 0
anim = 4204
velset = 0,0
sprpriority = 1


[State 0, Width]
type = Width
trigger1 = 1
value = 30,30
;ignorehitpause =
;persistent =

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = -80*facing
y = 0
;ignorehitpause =
;persistent =

[State 2201, helper]; Camera
type = Helper
trigger1 = !NumHelper(4280)
trigger1 = !time
pos = 0, 0
postype = p1
stateno = 4280
helpertype = normal
name = "F2 Camera"
id = 4280
ownpal = 1
supermovetime = 9999 ;150
pausemovetime = 9999 ;150
sprpriority = 5

[State 241, 1]  ;"aff... all right!"
type = PlaySnd
trigger1 = time=24
value = 4204,0
channel = 0

[State 241, 1]  ;ground cracking
type = PlaySnd
triggerall = NumTarget
trigger1 = target,pos Y>=0
value = 15000,10
channel = -1
persistent = 0

[State 3078, Debris Generator]
type = Helper
triggerall = NumTarget
trigger1 = target,pos Y>=0
helpertype = normal
name = "Debris Generator"
ID = 66853
stateno = 66853
pos = -10,0
postype = p2    ;p2,front,back,left,right
facing = 1
keyctrl = 0
persistent = 0
ownpal = 1
size.xscale = .5
size.yscale = .5
supermovetime = 0
pausemovetime = 0

[State -2, cracked ground front]
type = Explod
triggerall = NumTarget
trigger1 = target,pos Y>=0
trigger1 = !NumExplod(8451)
ID = 8451
anim = 8450; 859
postype	= p2
pos = 0,-2
sprpriority = 10
removetime = -2
ignorehitpause = 1
persistent = 0
[State -2, cracked ground back]
type = Explod
triggerall = NumTarget
trigger1 = target,pos Y>=0
trigger1 = !NumExplod(8450)
ID = 8450
anim = 8450
postype	= p2
pos = 0,-2
sprpriority = -10
removetime = -2
ignorehitpause = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim=4204
trigger1 = time=132
value = 4205
;ignorehitpause =
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = Anim=4205
trigger1 = !Animtime
value = 0
ctrl = 1
;anim =
;ignorehitpause =
;persistent =

;Finisher2 CAMERA
[Statedef 4280]
type    = S
movetype= I
physics = N
anim = 9999
sprpriority = -10

[State 19705, 1]
type = screenbound
trigger1 = 1
movecamera = 1,1
value = 1

[State 19705, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 1
ignorehitpause = 1
;persistent =

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
time = 1
;facing = 0
pos = 0,0
;ignorehitpause =
;persistent =


[State 19705, PosSet]
type = null;PosSet
trigger1 = 1
x = 0
y = 0
;ignorehitpause =
;persistent =

[State 19705, DestroySelf]
type = DestroySelf
trigger1 = root,stateno!=4204



;F2_IE Beam
[Statedef 4270]
type = A
physics = N
movetype = A
ctrl = 0
anim = 4272
velset = 0,0
sprpriority = 8

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = 0
y = 150
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = !time
y = -10
;ignorehitpause =
;persistent =

[State 3320, FX beam head]
type = Explod
triggerall = !NumExplod(4273)
trigger1 = !time
anim = 4273
id = 4273
pos = 0,-20
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 10
ownpal = 1
bindtime = -1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time<=80
scale = 1,1+(time/2.0)
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = time=80
x = 0
y = 0
;ignorehitpause =
;persistent =

[State 0, ChangeAnim] ;freeze anim for X scale
type = ChangeAnim
trigger1 = time>80
value = 4272
elem = 1
;ignorehitpause =
;persistent =

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time>80
scale = 1+((time-80)/10.0),40
;ignorehitpause =
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
;trigger1 = root,stateno!=4203
trigger1 = root,stateno=4204
trigger1 = root,time=12
id =  4273
;ignorehitpause =
;persistent =

[State 0, DestroySelf]
type = DestroySelf
;trigger1 = root,stateno!=4203
trigger1 = root,stateno=4204
trigger1 = root,time=12
;ignorehitpause =
;persistent =



;Target - OFFscreen
[Statedef 4250]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 0
y = -10
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = pos Y<=-400
x = 0
y = 0
;ignorehitpause =
;persistent =

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 4121
;elem = 1
;ignorehitpause =
persistent = 0

;Target - Going up
[Statedef 4251]
type    = A
movetype= H
physics = N

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = 0
y = -50
;ignorehitpause =
;persistent =

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = 1 ;!time
value = Cond(SelfAnimExist(5051),5051,5050)
;elem = 2

;Target - Return
[Statedef 4252]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = !time
value = Cond(SelfAnimExist(5061),5061,5060)

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = 80*facing
y = -1200
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = time=10
x = 0
y = 8
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = pos y >-400
x = 1
y = 12
;ignorehitpause =
persistent = 0


[State 0, SelfState]
type = SelfState
trigger1 = Pos Y >= 0
trigger1 = Vel Y > 0
value = 5100 ;5102 ;5100
;anim =
;ctrl =
;ignorehitpause = 0
;persistent = 1


;F3_Demonic Twin Dance
[Statedef 4300]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 9999
velset = 0,0
sprpriority = -5

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, VarSet] ;reset overheat buffer
type = VarSet
trigger1 = var(52)>=0
trigger1 = !time
var(52) = 0
ignorehitpause = 1
;persistent =

[State 0, PlaySnd] ;"hey bro"
type = PlaySnd
trigger1 = !time ;92
value = 4300,random%3
volumescale = 255
channel = 0
;ignorehitpause =
;persistent =

[State 0, PlaySnd] ;BGM Face
type = PlaySnd
trigger1 = !time
value = 4300,51
volumescale = 255
;ignorehitpause =
;persistent =

[State 0, AssertSpecial];BGM RAW
type = AssertSpecial
trigger1 = 1
flag = nomusic
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = 0
y = 10
;ignorehitpause =
;persistent =


[State 0, TargetState]
type = TargetState
trigger1 = !time
value = 4350
ID = -1
;ignorehitpause =
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 3515
;ignorehitpause =
;persistent =

[State 0, ChangeAnim] ;1st anim
type = ChangeAnim
trigger1 = !time
value = 4310
;ignorehitpause =
;persistent =

[State 0, Yakon BG]
type = Helper
triggerall = !NumHelper(4390)
trigger1 = !time ;time = 60
helpertype = normal ;player
name = "Yakon BG"
ID = 4390
stateno = 4390
pos = 160,-120
postype = back    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 0, 17]
type = Helper
triggerall = !NumHelper(4320)
trigger1 = !time ;time = 92
helpertype = normal ;player
name = "17"
ID = 4320
stateno = 4320
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 0, PlaySnd] ;BGM RAW
type = PlaySnd
trigger1 = !time
value = 4300,99
volumescale = 255
channel = 10
;ignorehitpause =
;persistent =

[State 0, ChangeAnim] ;sync anims
type = null;ChangeAnim
trigger1 = time = 92
value = 4310
;elem = 1
;ignorehitpause =
;persistent =

[State 0, PlaySnd];face warp
type = PlaySnd
trigger1 = time=64 ;time = 156
value = 4300,50
volumescale = 255
channel = 0
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = time=64 ; time = 156
x = 1.5
y = -1
;ignorehitpause =
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 =  time=180 ;200 ;time = 250
value = 4301
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;F3_DTD Mashup
[Statedef 4301]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 4300
velset = 0,0
sprpriority = 5

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 0, AssertSpecial];BGM RAW
type = AssertSpecial
trigger1 = 1
flag = nomusic
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 2201, helper]; Background lines
type = Helper
trigger1 = !NumHelper(3580)
trigger1 = !time
pos = -640, -480
postype = back
stateno = 3580
helpertype = normal
name = "horizontal_lines_BG"
id = 3580
ownpal = 1
supermovetime = 9999 ;150
pausemovetime = 9999 ;150
sprpriority = 5
size.xscale = 5
size.yscale= 5

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = -90*facing
y = -30
;ignorehitpause =
;persistent =

[State 0, TargetState]
type = TargetState
trigger1 = !time
value = 4351
ID = -1
;ignorehitpause =
;persistent =

[State 38121, Offset]
type = Offset
trigger1 = Anim=4300
x = 1.0*cos(time)


[State 0, PosSet]
type = PosSet
triggerall = NumHelper(4320)
trigger1 = Helper(4320),Anim=4322
trigger1 = Helper(4320),AnimElemTime(2)=0
x = -300*facing
y = 0
;ignorehitpause =
;persistent =

[State 0, TargetState] ;mashup
type = TargetState
triggerall = NumHelper(4320)
trigger1 = Helper(4320),Anim=4322
trigger1 = Helper(4320),AnimElemTime(2)=0
value = 4352
ID = -1
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = time=65
x = 10
;ignorehitpause =
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim=4300
trigger1 = time=80
value = 4301
;elem = 1
;ignorehitpause =
;persistent =


[State 255, hit]
type = HitDef
trigger1 = Anim=4301
trigger1 = AnimElem = 2
attr = S, HA
animtype  = Hard
damage = 30,3 ;ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 4-3*(AnimElem = 6),13+9*(AnimElem = 6) ;13,13
guard.pausetime = 13,5 ;13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = -10-random%20,-50-random%20
hitsound   = s5,2
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
p2facing = 1
p2stateno = 4353
ID = 4301
fall = 1
fall.recover = 0
kill = 0

[State 801, EnvShake]
type = EnvShake
trigger1 = movehit=1
time = 6
ampl = -10
freq = 120
;persistent = 0

[State 0, TargetFacing]
type = null;TargetFacing
trigger1 = Anim=4301
trigger1 = movehit
value = -1
ID = 4301
ignorehitpause = 1
persistent = 0

[State 0, TargetState]
type = null;TargetState
trigger1 = Anim=4301
trigger1 = movehit
value = 4353
ID = 4301
ignorehitpause = 1
persistent = 0

[State 0, VelSet]
type = VelSet
trigger1 = Anim=4301
trigger1 = movehit
x = 0
y = 0
;ignorehitpause =
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim=4301
trigger1 = time=85
value = 4302
ignorehitpause = 1
;persistent =

[State 0, PosAdd]
type = PosAdd
trigger1 = Anim=4302
trigger1 = time=[85,100]
y = -1
;ignorehitpause =
;persistent =

[State 255, hit]
type = HitDef
trigger1 = Anim=4302
trigger1 = AnimElem = 5
attr = S, HA
animtype  = Hard
damage = 20,2 ;ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 4-3*(AnimElem = 6),13+9*(AnimElem = 6) ;13,13
guard.pausetime = 13,5 ;13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = -10-random%20,-50-random%20
hitsound   = s5,2
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
p2stateno = 651
ID = 4302
fall = 1
fall.recover = 0
kill = 0

[State 0, TargetFacing]
type = TargetFacing
trigger1 = Anim=4302
trigger1 = movehit
value = -1
ID = 4302
ignorehitpause = 1
persistent = 0

[State 0, TargetState]
type = null;TargetState
trigger1 = Anim=4302
trigger1 = movehit
value = 651
ID = 4302
ignorehitpause = 1
persistent = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = pos Y<0
trigger1 = Anim=4302
trigger1 = time>=110
y = 1
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim=4302
trigger1 = pos Y=0
value = 4303
ignorehitpause = 1
;persistent =

[State 255, hit]
type = HitDef
trigger1 = Anim=4303
trigger1 = AnimElem = 5
attr = S, HA
animtype  = Hard
damage = 20,2 ;ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 4-3*(AnimElem = 6),13+9*(AnimElem = 6) ;13,13
guard.pausetime = 13,5 ;13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = -10-random%20,-50-random%20
hitsound   = s5,5
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-11
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
p2stateno = 4354
ID = 4302
fall = 1
fall.recover = 0
kill = 0

[State 0, ChangeAnim] ;to flip
type = ChangeAnim
trigger1 = Anim=4303
trigger1 = !Animtime
value = 4304
;elem = 1
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = Anim=4304
trigger1 = AnimElemTime(4)=0
x = 3
y = -8
ignorehitpause = 1
;persistent =

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Anim=4304
trigger1 = AnimElemTime(4)=1
physics = A         ;A,C,S,N
ignorehitpause = 1
;persistent =

[State 255, hit]
type = HitDef
trigger1 = Anim=4304
trigger1 = AnimElem = 8
attr = S, HA
animtype  = Hard
damage = 20,2 ;ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 0,13;13,13
guard.pausetime = 13,5 ;13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = 0,-100
hitsound   = s5,5
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
p2facing = 1
p2stateno = 4355
ID = 4304
fall = 1
fall.recover = 0
kill = 0

[State 0, VelSet]
type = VelSet
trigger1 = Anim=4304
trigger1 = AnimelemTime(8)=0
x = 0
ignorehitpause = 1
persistent = 0

[State 0, VelSet]
type = VelSet
trigger1 = Anim=4304
trigger1 = AnimelemTime(15)=0
y = 0
ignorehitpause = 1
persistent = 0

[State 0, PlaySnd] ;"give them hell 17!"
type = PlaySnd
trigger1 = Anim=4304
trigger1 = AnimelemTime(15)=0
value = 4302,random%2
volumescale = 255
channel = 0
;ignorehitpause =
;persistent =

[State 801, teleport sound]
type = PlaySnd
trigger1 = Anim=4304
trigger1 = AnimelemTime(16)=0
value = 810,0

[State 0, Yakon BG]
type = Helper
trigger1 = Anim=4304
trigger1 = !Animtime
helpertype = normal ;player
name = "Yakon BG"
ID = 4390
stateno = 4390
pos = 160,-120
postype = back    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 0, ChangeState]
type = ChangeState
trigger1 = Anim=4304
trigger1 = !Animtime
value = 4302
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;F3_DTD Blast charge
[Statedef 4302]
type = A
physics = N
movetype = A
ctrl = 0
anim = 4305
velset = 0,0
sprpriority = 5

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 0, AssertSpecial];BGM RAW
type = AssertSpecial
trigger1 = 1
flag = nomusic
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 2201, helper]; Background lines
type = Helper
trigger1 = !NumHelper(3581)
trigger1 = !time
pos = -640, -480
postype = back
stateno = 3581
helpertype = normal
name = "vertical_lines_BG"
id = 3580
ownpal = 1
supermovetime = 9999 ;150
pausemovetime = 9999 ;150
sprpriority = 5
size.xscale = 5
size.yscale= 5

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = -40*facing
y = -100
;ignorehitpause =
;persistent =

[State 801, charge sound]
type = PlaySnd
trigger1 = time=41
value = 4331,10 ;1450,0
volumescale = 255

[State 3320, FX beam charge]
type = Explod
trigger1 = time=41
anim = 4330
id = 4330
pos = -10,-47
postype = p1
supermovetime = 0 ;9999
pausemovetime = 9999
supermove = 1
removetime = 56
sprpriority = 6
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0
[State 3320, FX beam charge]
type = Explod
trigger1 = time=41
anim = 4330
id = 4331
pos = 10,-47
postype = p1
supermovetime = 0 ;9999
pausemovetime = 9999
supermove = 1
removetime = 56
sprpriority = 6
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, ChangeAnim];to launch
type = ChangeAnim
trigger1 = Anim=4305
trigger1 = time=96
value = 4306
;elem = 1
;ignorehitpause =
persistent = 0

[State 801, buildup discharge sound]
type = PlaySnd
trigger1 = time=96
value = 4331,11 ;4302,50
volumescale = 255

[State 1000, DTD balls]
type = Helper
triggerall = time>=96
trigger1 = time%16=0
helpertype = normal
name = "DTD fireball"
postype = P1
pos = -10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4331
;persistent = 0
[State 1000, DTD balls]
type = Helper
triggerall = time>=96
trigger1 = time%16=0
helpertype = normal
name = "DTD fireball"
postype = P1
pos = 10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4332
;persistent = 0

[State 0, Yakon BG]
type = Helper
trigger1 = time=300
helpertype = normal ;player
name = "Yakon BG"
ID = 4390
stateno = 4390
pos = 160,-120
postype = back    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 0, ChangeState]
type = ChangeState
trigger1 = time=300
value = 4303
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;F3_DTD Offscren blasts
[Statedef 4303]
type = A
physics = N
movetype = A
ctrl = 0
anim = 4305
velset = 0,0
sprpriority = 5

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 0, AssertSpecial];BGM RAW
type = AssertSpecial
trigger1 = 1
flag = nomusic
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = -350
ignorehitpause = 1
;persistent =

[State 0, TargetState]
type = TargetState
trigger1 = !time
value = 4356
ID = -1
ignorehitpause = 1
persistent = 0

[State 1000, DTD balls]
type = Helper
triggerall = time>=16
;triggerall = time<210
trigger1 = time%16=8
helpertype = normal
name = "DTD fireball"
postype = P1
pos = -10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4333
;persistent = 0
[State 1000, DTD balls]
type = Helper
triggerall = time>=16
;triggerall = time<210
trigger1 = time%16=8
helpertype = normal
name = "DTD fireball"
postype = P1
pos = 10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4334
;persistent = 0

[State 0, PlaySnd] ;horror
type = PlaySnd
trigger1 =  NumHelper(4333)
trigger1 = Helper(4333),movecontact
trigger2 =  NumHelper(4334)
trigger2 = Helper(4334),movecontact
value = 4331, 20
volumescale = 255
channel = -1
ignorehitpause = 1
persistent = 0


[State 0, Yakon BG]
type = Helper
trigger1 = time=251
helpertype = normal ;player
name = "Yakon BG"
ID = 4390
stateno = 4390
pos = 160,-120
postype = back    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 0, ChangeState]
type = ChangeState
trigger1 = time=251
value = 4304
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

;F3_DTD Offscren 2 blasts
[Statedef 4304]
type = A
physics = N
movetype = A
ctrl = 0
anim = 4305
velset = 0,0
sprpriority = 5

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = nobardisplay
ignorehitpause = 1

[State 0, AssertSpecial];BGM RAW
type = AssertSpecial
trigger1 = 1
flag = nomusic
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = -450
ignorehitpause = 1
;persistent =

[State 0, TargetState]
type = TargetState
trigger1 = !time
value = 4357
ID = -1
ignorehitpause = 1
persistent = 0

[State 1000, DTD balls]
type = Helper
trigger1 = time%16=8
helpertype = normal
name = "DTD fireball"
postype = P1
pos = -10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4335
;persistent = 0
[State 1000, DTD balls]
type = Helper
trigger1 = time%16=8
helpertype = normal
name = "DTD fireball"
postype = P1
pos = 10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4336
;persistent = 0

[State 0, laugh]
type = PlaySnd
trigger1 = time=160 ;320
value = 3502,random%5
channel = 0
volumescale = 255
ignorehitpause = 1
persistent = 0

[State 0, AntiYakon BG]
type = Helper
trigger1 = time=200 ;330
helpertype = normal ;player
name = "AntiYakon BG"
ID = 4391
stateno = 4391
pos = 160,-120
postype = back    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 0, ChangeState]
type = ChangeState
trigger1 = time=230 ;360
value = 4305
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

;F3_DTD End
[Statedef 4305]
type = A
physics = N
movetype = A
ctrl = 0
anim = 9999
velset = 0,0
sprpriority = 5

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, TargetState]
type = TargetState
trigger1 = !time
value = 4358
ID = -1
ignorehitpause = 1
;persistent =

[State 0, PlaySnd] ;big explosion
type = PlaySnd
trigger1 = !Time
value = 4305,0
volumescale = 255
channel = -1
ignorehitpause = 1
;persistent =


[State 0, PosSet]
type = PosSet
triggerall = time>0
trigger1 = numtarget
trigger1 = target,stateno!=4358 ;652
x = -70*facing
y = 0
ignorehitpause = 1
persistent =  0

[State 0, ChangeState] ;to special win
type = ChangeState
trigger1 = numtarget
trigger1 = target,alive=0
value = 4309
ctrl = 0
;anim =
ignorehitpause = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time>=40
trigger1 = pos y=0
value = 4307
;elem = 1
ignorehitpause = 1
persistent =  0

[State 801, teleport sound]
type = PlaySnd
trigger1 = Anim=4307
trigger1 = AnimelemTime(2)=0
value = 810,0

[State 0, ChangeState]
type = ChangeState
trigger1 = Anim=4307
trigger1 = !animtime
value = 0
ctrl = 1
;anim =
ignorehitpause = 1
;persistent =

;F3_DTD Winpose
[Statedef 4309]
type = A
physics = N
movetype = A
ctrl = 0
anim = 9999
velset = 0,0
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible
;flag3 = roundnotover
ignorehitpause = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
;ignorehitpause =
;persistent =

[State 0, C17]
type = Helper
triggerall = !NumHelper(6183)
trigger1 = !time
helpertype = normal
name = "C17"
ID = 4325
stateno = 4325
pos = Cond(frontedgedist<90,-65,70),0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 0
pausemovetime = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !time
value = 0
ctrl = 1
;anim =
;ignorehitpause =
;persistent =



;F3_17 face
[Statedef 4320]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 9999
velset = 0,0
sprpriority = -7

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 4320
;elem = 1
;ignorehitpause =
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = time = 64
x = -1.5
y = 1
;ignorehitpause =
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno!=4300
value = 4321
ctrl = 0
;anim =
;ignorehitpause =
;persistent =


[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno!=[4300,4309]
;ignorehitpause =
;persistent =

;F3_17 mashup
[Statedef 4321]
type = A
physics = N ;S
movetype = A
ctrl = 0
anim = 4321
velset = 0,0
sprpriority = 7

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = -90*root,facing
y = 0
;ignorehitpause =
;persistent =

[State 38121, Offset]
type = Offset
trigger1 = Anim=4321
x = 1.0*sin(time)


[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 30
value = 4322
;elem = 1
;ignorehitpause =
;persistent =

[State 0, PosSet] ;teleport
type = PosSet
trigger1 = Anim=4322
trigger1 = AnimElemTime(2)=0
x = 90*root,facing
y = -25 ;-50
;ignorehitpause =
;persistent =

[State 801, teleport sound]
type = PlaySnd
trigger1 = Anim=4322
trigger1 = AnimElemTime(2)=0
value = 810,0

[State 0, Turn]
type = Turn
trigger1 = Anim=4322
trigger1 = AnimElemTime(2)=0
;ignorehitpause =
persistent = 0

[State 255, hit]
type = HitDef
trigger1 = Anim=4322
trigger1 = AnimElem = 6
attr = S, HA
animtype  = Hard
damage = 20,2 ;ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 4-3*(AnimElem = 6),13+9*(AnimElem = 6) ;13,13
guard.pausetime = 13,5 ;13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = -10-random%20,-50-random%20
hitsound   = s5,5
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
ID = 4322
fall = 1
fall.recover = 0
kill = 0

[State 801, EnvShake]
type = EnvShake
trigger1 = movehit=1
time = 6
ampl = -10
freq = 120
;persistent = 0

[State 0, TargetFacing]
type = TargetFacing
trigger1 = Anim=4322
trigger1 = movehit
value = -1
ID = 4322
ignorehitpause = 1
persistent = 0


[State 0, TargetState]
type = TargetState
trigger1 = Anim=4322
trigger1 = movehit
value = 651
ID = 4322
ignorehitpause = 1
persistent = 0


[State 0, PosAdd]
type = PosAdd
trigger1 = Anim=4322
trigger1 = AnimElemTime(9)=0
x = -25
y = 25
;ignorehitpause =
;persistent =



[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time=85
value = 4323
;elem = 1
ignorehitpause = 1
;persistent =

[State 255, hit]
type = HitDef
trigger1 = Anim=4323
trigger1 = AnimElem = 5
attr = S, HA
animtype  = Hard
damage = 20,2 ;ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 4-3*(AnimElem = 6),13+9*(AnimElem = 6) ;13,13
guard.pausetime = 13,5 ;13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = -10-random%20,-50-random%20
hitsound   = s5,2
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
p2facing = -1
p2stateno = 4353
ID = 4323
fall = 1
fall.recover = 0
kill = 0

[State 0, TargetFacing]
type = TargetFacing
trigger1 = Anim=4323
trigger1 = movehit
value = -1
ID = 4323
ignorehitpause = 1
persistent = 0

[State 0, TargetState]
type = null;TargetState
trigger1 = Anim=4323
trigger1 = movehit
value = 4353
ID = 4323
ignorehitpause = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time=110
value = 4324
;elem = 1
ignorehitpause = 1
;persistent =

[State 255, hit]
type = HitDef
trigger1 = Anim=4324
trigger1 = AnimElem = 7
attr = S, HA
animtype  = Hard
damage = 20,2 ;ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 4-3*(AnimElem = 6),13+9*(AnimElem = 6) ;13,13
guard.pausetime = 13,5 ;13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = -10-random%20,-50-random%20
hitsound   = s5,2
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
p2facing = -1
p2stateno = 4353
ID = 4324
fall = 1
fall.recover = 0
kill = 0

[State 0, ChangeAnim] ;to flip
type = ChangeAnim
trigger1 = Anim=4324
trigger1 = time=181
value = 4325
;elem = 1
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = Anim=4325
trigger1 = AnimElemTime(4)=0
x = 3
y = -8
ignorehitpause = 1
;persistent =

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Anim=4325
trigger1 = AnimElemTime(4)=1
physics = A         ;A,C,S,N
ignorehitpause = 1
;persistent =

[State 255, hit]
type = HitDef
trigger1 = Anim=4325
trigger1 = AnimElem = 8
attr = S, HA
animtype  = Hard
damage = 20,2 ;ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)), 4
priority = 4, Hit
hitflag = MAFD
guardflag = MA
pausetime = 0,13;13,13
guard.pausetime = 13,5 ;13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = 0,-100
hitsound   = s5,5
guardsound = S6,1
ground.type = Low ;High
air.type = Low
ground.slidetime = 15
ground.hittime = 18 ;15
ground.velocity = -9
air.velocity = -4,-4
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
p2facing = 0
p2stateno = 4355
ID = 4325
fall = 1
fall.recover = 0
kill = 0

[State 0, VelSet]
type = VelSet
trigger1 = Anim=4325
trigger1 = AnimelemTime(8)=0
x = 0
ignorehitpause = 1
persistent = 0

[State 0, VelSet]
type = VelSet
trigger1 = Anim=4325
trigger1 = AnimelemTime(15)=0
y = 0
ignorehitpause = 1
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = Anim=4325
trigger1 = !animtime
value = 4322
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

[State 0, DestroySelf]
type = null;DestroySelf
trigger1 = root,stateno!=4301
;ignorehitpause =
;persistent =

;F3_17 Blast charge
[Statedef 4322]
type = A
physics = N
movetype = A
ctrl = 0
anim = 4326
velset = 0,0
sprpriority = 5

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = 40*root,facing
y = -100
;ignorehitpause =
;persistent =

[State 3320, FX beam charge]
type = Explod
trigger1 = time=41
anim = 4330
id = 4330
pos = -10,-47
postype = p1
supermovetime = 0 ;9999
pausemovetime = 9999
supermove = 1
removetime = 48;56
sprpriority = 6
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0
[State 3320, FX beam charge]
type = Explod
trigger1 = time=41
anim = 4330
id = 4331
pos = 10,-47
postype = p1
supermovetime = 0 ;9999
pausemovetime = 9999
supermove = 1
removetime = 48;56
sprpriority = 6
ownpal = 1
bindtime = 1
scale = 1,1
removeongethit = 1
persistent = 0

[State 0, ChangeAnim];to launch
type = ChangeAnim
trigger1 = Anim=4326
trigger1 = time=88;96
value = 4327
;elem = 1
;ignorehitpause =
persistent = 0

[State 1000, DTD balls]
type = Helper
triggerall = time>=88;96
trigger1 = time%16=8
helpertype = normal
name = "DTD fireball"
postype = P1
pos = -10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4331
;persistent = 0
[State 1000, DTD balls]
type = Helper
triggerall = time>=88;96
trigger1 = time%16=8
helpertype = normal
name = "DTD fireball"
postype = P1
pos = 10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4332
;persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = time=300
value = 4323
ctrl = 0
;anim =
;ignorehitpause =
;persistent =


;F3_17 Offscreen blast
[Statedef 4323]
type = A
physics = N
movetype = A
ctrl = 0
anim = 4327
velset = 0,0
sprpriority = 5

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = -350
ignorehitpause = 1
;persistent =

[State 1000, DTD balls]
type = Helper
triggerall = time>=16
;triggerall = time<210
trigger1 = time%16=0
helpertype = normal
name = "DTD fireball"
postype = P1
pos = -10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4333
;persistent = 0
[State 1000, DTD balls]
type = Helper
triggerall = time>=16
;triggerall = time<210
trigger1 = time%16=0
helpertype = normal
name = "DTD fireball"
postype = P1
pos = 10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4334
;persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = time=251
value = 4324
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

;F3_17 Offscreen 2 blast
[Statedef 4324]
type = A
physics = N
movetype = A
ctrl = 0
anim = 4327
velset = 0,0
sprpriority = 5

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = -450
ignorehitpause = 1
;persistent =

[State 1000, DTD balls]
type = Helper
trigger1 = time%16=0
helpertype = normal
name = "DTD fireball"
postype = P1
pos = -10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4335
;persistent = 0
[State 1000, DTD balls]
type = Helper
trigger1 = time%16=0
helpertype = normal
name = "DTD fireball"
postype = P1
pos = 10,-47
facing = 1
ownpal = 1
stateno = 4331
id = 4336
;persistent = 0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno!=4304
;ignorehitpause =
;persistent =

;F3_17_Winpose
[Statedef 4325]
type = A
physics = N
movetype = I
ctrl = 0
anim = 9999
velset = 0,0
sprpriority = 5

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0
;ignorehitpause =
;persistent =


[State 0, ChangeAnim]
type = ChangeAnim
triggerall = Anim=9999
trigger1 = root,stateno=4383
value = 4329
;elem = 1
;ignorehitpause =
persistent = 0


;Target - OFFscreen
[Statedef 4350]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = -400
;ignorehitpause =
persistent = 0

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 4121
;elem = 1
;ignorehitpause =
persistent = 0

;Target - ONScreen
[Statedef 4351]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = 0
y = -30
;ignorehitpause =
persistent = 0

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 4121
;elem = 1
;ignorehitpause =
persistent = 0

[State 38121, Offset]
type = Offset
trigger1 = Anim=4121
y = 1.0*sin(time)

;Target - Mashup
[Statedef 4352]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = 240*facing
y = -30
;ignorehitpause =
persistent = 0

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 4121
;elem = 1
;ignorehitpause =
persistent = 0

[State 38121, Offset]
type = Offset
trigger1 = Anim=4121
y = 1.0*sin(time)


[State 0, VelSet]
type = VelSet
trigger1 = !time
x = -10
;ignorehitpause =
;persistent =

;Target - Mashup ping pong
[Statedef 4353]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 5051
;elem = 1
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 6
y = 0
;ignorehitpause =
;persistent =


[State 0, SelfState]
type = SelfState
trigger1 = time=100
value = 0
;anim =
ctrl = 1
;ignorehitpause = 0
;persistent = 1

;Target - Going up
[Statedef 4354]
type    = A
movetype= H
physics = A ;N

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = -1.2 ;-3
y = -23 ;-15
ignorehitpause = 1
;persistent =

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= IfElse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, 3] ;Gravity
type = VelAdd
trigger1 = time > 0  ;Vans Fix !!!
y = GetHitVar(yaccel)

[State 5050, 6]
type = Selfstate ;ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, Const(movement.air.gethit.groundlevel))
value = 5100 ;Downed get-hit (hit ground from fall)

;Target - OFFscreen
[Statedef 4355]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 0
y = -10
ignorehitpause = 1
;persistent =

[State 0, VelSet]
type = VelSet
trigger1 = pos Y<=-400
x = 0
y = 0
;ignorehitpause =
;persistent =

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 4121
;elem = 1
;ignorehitpause =
persistent = 0

;Target - Blasted
[Statedef 4356]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
triggerall = prevstateno=4355
trigger1 = !time
x = 0
y = -50
;ignorehitpause =
persistent = 0

[State 0, PosAdd]
type = PosAdd
triggerall = prevstateno!=4355
trigger1 = time>0
trigger1 = time%2=0
y = 2
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 4356
;elem = 1
;ignorehitpause =
persistent = 0

;Target - Blasted 2
[Statedef 4357]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
triggerall = prevstateno=4356
trigger1 = !time
x = 0
y = -300
;ignorehitpause =
persistent = 0

[State 0, PosAdd]
type = PosAdd
triggerall = prevstateno!=4356
trigger1 = time>0
trigger1 = time%2=0
y = 3 ;2
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 4356
;elem = 1
;ignorehitpause =
persistent = 0

;Target - Blasted end
[Statedef 4358]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,1
ignorehitpause = 1
;persistent =

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = null;PosSet
trigger1 = !time
y = -350
;ignorehitpause =
persistent = 0

[State 3020, 2]
type = changeanim2
trigger1 = !time && anim !=652
value = 652

[State 4005, vel Y]
type = velset
trigger1 = !time
y = 8
ignorehitpause = 1

[State 0, LifeAdd]
type = LifeAdd
trigger1 = Pos Y >= 0
trigger1 = Vel Y > 0
value = -20
kill = 1
absolute = 0
ignorehitpause = 1
persistent = 0


[State 3052, Land]
type = changestate
trigger1 = Pos Y >= 0
trigger1 = Vel Y > 0
value = 4359

;Target - Blasted end
[Statedef 4359]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
;anim = 5150
velset = 0,0

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = -70*facing
y = 0
ignorehitpause = 1
;persistent =

[State 0, ChangeAnim] ;freeze liedead anim
type = ChangeAnim
trigger1 = 1
value = 5120;+30*(alive=0)
elem = 1
ignorehitpause = 1
;persistent =


[State 0, SelfState]
type = SelfState
trigger1 = time=30+15*(alive)
value = 5150-30*(alive) ;5120
;anim =
;ctrl =
ignorehitpause = 1
persistent = 0

;F0_Breaker
[Statedef 4400]
type = A
physics = N ;S
movetype = A
anim = 4400
ctrl = 0
velset = 0,0
sprpriority = 6

[State 4100, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, VarSet] ;reset overheat buffer
type = VarSet
trigger1 = var(52)>=0
trigger1 = !time
var(52) = 0
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 3515
;ignorehitpause =
;persistent =

[State 0, PlaySnd] ;leap
type = PlaySnd
trigger1 = !time
value = 1200,0
;ignorehitpause =
;persistent =

[State 40, 4]
type = VelSet
trigger1 = !time
x = 8
y = -11
persistent = 0

[State 40, 4]; fall
type = Veladd
trigger1 = AnimElemTime(9)<0
Y = 0.8 ;0.9

[State 40, 4]
type = VelSet
trigger1 = AnimElemTime(9)=0
x = 0
y = 0
persistent = 0

[State 0, FX beam]
type = Explod
triggerall = !NumExplod(4420)
trigger1 = AnimElemTime(9)=0
anim = 4420
id = 4420
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 241, 1]  ;FX beam charge
type = PlaySnd
trigger1 = AnimElemTime(9)=0
value = 4270, 0
channel = 1
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = time = 70
value = 4401
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

;F0_B Launch
[Statedef 4401]
type = A
physics = N
movetype = A
anim = 4401
ctrl = 0
velset = 0,0
sprpriority = -5

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time
id = 4420
ignorehitpause = 1
;persistent =

[State 0, FX beam]
type = Explod
triggerall = !NumExplod(4421)
trigger1 = !time
anim = 4421
id = 4421
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 3000, Breaker Beam]
type = helper
trigger1 = time=8
helpertype = normal
stateno = 4451
ID = 4451
name = "F0 Breaker Beam"
postype = p1
facing = -facing
pos = 0,0
ownpal = 1

[State 0, VelSet]
type = VelSet
trigger1 = time=8
x = 3
;ignorehitpause =
;persistent =
[State 0, ScreenBound]
type = ScreenBound
trigger1 = time>8
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, ChangeState]
type = ChangeState
trigger1 = Time>10
trigger1 = !NumHelper(4451)
value = 4402
ctrl = 0
;ignorehitpause =
;persistent =

;F0_B End
[Statedef 4402]
type = A
physics = N
movetype = I
anim = 4401
ctrl = 0
velset = 0,0
sprpriority = -5
facep2 = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = time = 10
x = -200*facing
y = -10
;ignorehitpause =
;persistent =

[State 40, 4]; fall
type = Veladd
trigger1 = time > 40
Y = 0.8 ;0.9

[State 10232, Superjump Sound]
type = null;PlaySnd
trigger1 = time = 40
value = 0,24


[State 10232, 11]
type = VelSet
trigger1 = time = 40
x = Const(velocity.jump.fwd.x)+2.2
y = Const(velocity.jump.y) - 3.2

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 40
value = 45
;elem = 1
;ignorehitpause =
;persistent =

[State 10232, 13]
type = ChangeState
trigger1 = Anim=45
trigger1 = pos Y>=-5
value = 52
ctrl = 1


; Hit by F0_B - Air get-hit (shaking)
[Statedef 4470]
type    = A
movetype= H
physics = N
velset = -1,0
sprpriority = 3
facep2 = 1

[State 5020, 1]
type = ChangeAnim2
trigger1 = !Time
value = 3370 +(BackEdgeDist<=40)
ignorehitpause = 1


[State 0, ChangeState] ;go to cinematic
type = ChangeState
triggerall = Matchover
;trigger1 = !Time
trigger1 = !alive ;life<=8
value = 3591
ctrl = 0
ignorehitpause = 1
persistent = 0


[State 0, ChangeAnim2] ; Wall
type = ChangeAnim2
trigger1 = Anim=3520
trigger1 = BackEdgeDist <= 20
value = 3371
;elem = 1
ignorehitpause = 1
;persistent =


[State 5020, 5]
type = SelfState
trigger1 = !animtime ;HitShakeOver
value = 5030


; EMO EXIT Activation
[Statedef 4900]
type = S
movetype = I
physics = S
anim = 4900
velset = 0,0
ctrl = 0

;Reset Emo
[State -4, VarSet]
type = VarSet
trigger1 = !time
var(54)=0
ignorehitpause = 1
;persistent =

[State 4900, face]
type = Explod
triggerall = !IsHelper
trigger1 = !NumExplod(4910)
trigger1 = !time
anim =  4910
ID =  4910
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
facing = 1
vfacing = 1
bindtime = -1
removetime = 90 ;120 ;-2
scale = 1,1
sprpriority = 2
ownpal = 1
removeongethit = 1
ignorehitpause = 1

[State 200, BGPalFX]
type = BGPalFX
triggerall = !IsHelper
trigger1 = time=[5,50]
time = 1
add	= -100,-100,-100
mul	= 256,100,100
invertall = 0
color = 256

[State 3000, superpause]
type = superpause
triggerall = !IsHelper
trigger1 = AnimElemTime(2)=0
time = 95
p2defmul = 1
unhittable = 1
anim = -1
sound = s2350,2
darken = 0
movetime = 95

[State 13100, shake]
type = envshake
triggerall = !IsHelper
trigger1 = !(time%12)
time = 6
freq = 30
ampl = 2

[State 0, PlaySnd];"are you ready for a perfect storm?"
type = PlaySnd
triggerall = !IsHelper
trigger1 = AnimElemTime(2)=0
value = 4900,random%3
channel = 0
volumescale = 255
;ignorehitpause =
persistent = 0

[State 195, ChangeState] ;Fake stance
type = ChangeState
trigger1 = time=100 ;130
value = 4901
ctrl = 0

;fake stance
[Statedef 4901]
type = S
physics = S
sprpriority = 0
facep2 = 1

[State 3302, Helper Limiter]
type = null;Helper
triggerall = !IsHelper
triggerall = var(54)=1
triggerall = !NumHelper(9998)
trigger1= !Time
helpertype = normal
name = "VISM TEMP OFF"
ID = 9998
stateno = 9997
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
persistent = 0

[State 3302, Helper Limiter]
type = Helper
triggerall = !IsHelper
triggerall = var(54)=0
triggerall = !NumHelper(9998)
trigger1= !Time
helpertype = normal
name = "VISM TEMP ON"
ID = 9998
stateno = 9998
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
persistent = 0

[State 3302, Helper Limiter]
type = Helper
triggerall = !IsHelper
triggerall = !NumHelper(500)
trigger1= !Time
helpertype = normal
name = "VISM recorder"
ID = 500
stateno = 500
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
persistent = 0

[State 3302, Helper Limiter 2]
type = Helper
triggerall = !IsHelper
triggerall = !NumHelper(550)
trigger1= !Time
helpertype = normal
name = "VISM recorder 2"
ID = 550
stateno = 550
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
persistent = 0


[State 0, RemoveExplod]  ;Piccolo's clones
type = RemoveExplod
trigger1 = !Time
id = 991901

[State 0, VarSet]  ;capture Y pos
type = VarSet
trigger1 = !time
fvar(15) = ScreenPos Y
ignorehitpause = 1
;persistent =


;BEGIN Shadow Clone
[State -4, SprPriority]
type = SprPriority
trigger1 = IsHelper
value = IfElse(IsHelper(666),-1,-2)
ignorehitpause = 1
;persistent =
[State -4] ;State
type     = changestate
triggerall = NumHelper(500) && NumHelper(504)
trigger1 = ishelper(666)
trigger1 = helper(666), stateno != helper(504), var(( helper(500), var(2) ))
;trigger1 = helper(504), var(( helper(500), var(2) )) != [0, 110)
value    = helper(504), var(( helper(500), var(2) ))
[State -4] ;Anim/AnimElemno
type     = ChangeAnim
triggerall = NumHelper(500) && NumHelper(503) && NumHelper(505)
trigger1 = ishelper(666)
value    = helper(503), var(( helper(500), var(2) ))
elem = helper(505), var(( helper(500), var(2) ))
ignorehitpause = 1
[State -4] ;State
type     = changestate
triggerall = NumHelper(550) && NumHelper(554)
trigger1 = ishelper(667)
trigger1 = helper(667), stateno != helper(554), var(( helper(550), var(2) ))
;trigger1 = helper(554), var(( helper(550), var(2) )) != [0, 110)
value    = helper(554), var(( helper(550), var(2) ))
[State -4] ;Anim/AnimElemno
type     = ChangeAnim
triggerall = NumHelper(550) && NumHelper(553) && NumHelper(555)
trigger1 = ishelper(667)
value    = helper(553), var(( helper(550), var(2) ))
elem = helper(555), var(( helper(550), var(2) ))
ignorehitpause = 1
[State -4, Turn] ;Special hack for turning animation
type = Turn
trigger1 = ishelper
trigger1 = Anim = 5
trigger1 = facing!=root,facing
ignorehitpause = 1
;persistent =
[State -4, BindToRoot]
type = BindToRoot
triggerall = ishelper
trigger1 = root,statetype!=A  ;root in aerial
trigger1 = root,stateno!=20   ;root walking
time = 1
facing = 0 ;root,facing
pos = 0,0
ignorehitpause = 1
;persistent =
[State -4, BindToRoot] ;walk hack
type = BindToRoot
triggerall = ishelper(666)
trigger1 = root,stateno=20   ;root walking
;trigger1 = root,time<5 ;root walking
time = 1
facing = 0 ;root,facing
;pos = -10,0
pos = IfElse((root,vel X>0),-(root,var(51)),(root,var(51))),0
ignorehitpause = 1
;persistent =
[State -4, BindToRoot] ;walk hack
type = BindToRoot
triggerall = ishelper(667)
trigger1 = root,stateno=20   ;root walking
;trigger1 = root,time<10 ;root walking
time = 1
facing = 0 ;root,facing
;pos = -20,0
pos = IfElse((root,vel X>0),-(root,var(50)),(root,var(50))),0
ignorehitpause = 1
;persistent =

[State -4]
type     = assertspecial
trigger1 = ishelper
flag     = invisible
ignorehitpause = 1
[State -4] ;Shadow Late
type     = afterimage
trigger1 = ishelper(667)
time     = 999999
length   = 2
timegap  = 1
framegap = 1
palcontrast = 96, 96, 256
ignorehitpause = 1
[State -4] ;Shadow Soon
type     = afterimage
trigger1 = ishelper(666)
time     = 999999
length   = 2
timegap  = 1
framegap = 1
palcontrast = 96, 96, 128
ignorehitpause = 1
[State -4]
type     = nothitby
trigger1 = ishelper
time     = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
ignorehitpause = 1
;END Shadow Clone

[State 0, 1]
type = ChangeAnim
trigger1 = Anim != 0 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0 ;Turn anim over
value = 0

[State 0, 2]
type = VelSet
trigger1 = Time = 0
y = 0

[State 0, 3] ;Stop moving if low velocity or 4 ticks pass
type = VelSet
trigger1 = abs(vel x) < Const(movement.stand.friction.threshold)
trigger2 = Time = 4
x = 0

[State 0, CtrlSet]
type = CtrlSet
triggerall = !IsHelper
trigger1 = !ctrl
trigger1 = time>10
value = 1
ignorehitpause = 1

[State -4, X_X] ;Kill helper if root gets hit
type     = destroyself
triggerall = Ishelper
trigger1 = root,var(54)=0
trigger2 = root, movetype = H
trigger3 = root,stateno=[120,155]
ignorehitpause = 1

[State 0, 4] ;idle too much?
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
