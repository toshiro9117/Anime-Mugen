;==============================================================
; CNS File for TenShinHan by Team Z2
; Super moves
;==============================================================

;---------------------------------------------------------------------------
; Kikoho (Lvl 1) 1
; Floating
[Statedef 2000]
type    = A
movetype= A
physics = N
juggle  = 4
velset = 0,0
;poweradd = -1000
anim = 2000
ctrl = 0
sprpriority = 2


[State 2000, Voice]		;Tien: "Kikoho"
type = PlaySnd
trigger1 = AnimElemTime (1) = 0
value = s85,3103;80,2000
volumescale = 255
channel = 0



;[State 2000, VarSet]; light = 0; medium = 1; heavy = 2
;type      = VarSet
;trigger1  = Time = 0 && !AILevel
;var(6)    = IfElse(Command = "QCB,F+ x", 0, IfElse(Command = "QCB,F+ y", 1, 2))
;
;
;[State 2000, VarSet]; for the AI (this may have to be removed or fixed)
;type      = VarSet
;trigger1  = Time = 0 && AILevel
;var(6)    = IfElse(random<100, 0, IfElse(random<350, 1, 2))





;This variable decides the strength.
[State 2000, VarSet]; light = 0
type      = VarSet
trigger1  = Time = 0 && !AILevel
trigger1  = IfElse(Facing = 1,(NumExplod(90032506)),NumExplod(90032404)) && NumExplod(90000200)
var(6)    = 0
[State 2000, VarSet]; medium = 1
type      = VarSet
trigger1  = Time = 0 && !AILevel
trigger1  = IfElse(Facing = 1,(NumExplod(90032506)),NumExplod(90032404)) && NumExplod(90000210)
var(6)    = 1
[State 2000, VarSet]; heavy = 2
type      = VarSet
trigger1  = Time = 0 && !AILevel
trigger1  = IfElse(Facing = 1,(NumExplod(90032506)),NumExplod(90032404)) && NumExplod(90000220)
var(6)    = 2



[State 2000, VarSet]; for the AI (this may have to be removed or fixed)
type      = VarSet
trigger1  = Time = 0 && AILevel
var(6)    = IfElse(random<100, 0, IfElse(random<350, 1, 2))





[State 2000, VarSet]; no stun
type      = VarSet
trigger1  = Time = 0
SysFVar(4) = 0

[State 2000, VarAdd]
type = VarSet
trigger1 = Time = 0
var(26) = 0




[State 3000, width]
type = width
trigger1 = 1
value = 30,0

[State 2000, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,51]
flag = NoFG	;No Foreground

[State 2000, SuperPause]
type = SuperPause
trigger1 = !Time
time = 51
p2defmul = 1
unhittable = 1
anim = -1
sound = s2000,0
darken = 0
movetime = 51

[State 2000, BG Pal FX - Dark]
type = BGPalFX
trigger1 = !time
time = 51
color = 0
mul = 0,0,0

[State 2500, Super FX LVL 1]
type		= Explod
trigger1		= Time = 5
anim		= 10200
id		= 10200
pos		= 16,-96
postype		= p1
supermovetime	= 9999
pausemovetime	= 9999
supermove		= 1
removetime	= -2
sprpriority	= 8
ownpal		= 1
bindtime		= -1
scale		= 1,1
persistent	= 0

[State 2000, Hand effects]
type = Explod
trigger1 = AnimElem = 3
anim = 2101
ID = 2000
pos = 16,-96
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = 43
scale = 1,1
sprpriority = 3
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999


[State 2000, Jump movement]
type = VelSet
trigger1 = Time = 0
x = -15
y = IfElse(Pos y<0,-5,-10)

[State 2000, Velocity Multiplier]
type = VelMul
trigger1 = Time = [1,11]
x = 0.65
y = 0.88
;ignorehitpause = 
;persistent = 


[State 2000, Stop movement]
type = VelSet
trigger1 = Time =11
x = 0
y = 0



;[State 2000, Air physics]
;type = StateTypeSet
;trigger1 = AnimElem = 20
;physics = A
;ignorehitpause = 1
;;persistent = 



;[State 2000, Kikoho helper]
;type = helper
;trigger1 = AnimElem = 4
;helpertype = normal
;stateno = 2102
;ID = 2102
;name = "Kikoho lvl 1"
;postype = p1
;pos = 16,-96
;ownpal = 1



[State 2000, ChangeState]
type = ChangeState
trigger1 = Time = 51
value = 2001
ctrl = 0
ignorehitpause = 1


;---------------------------------------------------------------------------
; Kikoho (Lvl 1) 2
; Shooting
[Statedef 2001]
type    = A
movetype= A
physics = N
juggle  = 4
velset = 0,0
poweradd = IfElse(PrevStateNo = 2001, -500,-1000)
anim = 2001
ctrl = 0
sprpriority = 2



;[State 900, Voice]	;Tien: "Ha!"
;type = PlaySnd
;trigger1 = AnimElemTime (1) = 0
;value = s85,15+random%2;85,3108		80,2010
;volumescale = 100
;channel = 0




;[State 3000, width]
;type = width
;trigger1 = 1
;value = 30,0
;
;[State 2000, AssertSpecial]
;type = AssertSpecial
;trigger1 = time = [0,51]
;flag = NoFG	;No Foreground

;[State 2000, SuperPause]
;type = SuperPause
;trigger1 = !Time
;time = 51
;p2defmul = 1
;unhittable = 1
;anim = -1
;sound = s2000,0
;darken = 0
;movetime = 51
;
;[State 2000, BG Pal FX - Dark]
;type = BGPalFX
;trigger1 = !time
;time = 51
;color = 0
;mul = 0,0,0
;
;[State 2500, Super FX LVL 1]
;type		= Explod
;trigger1		= Time = 5
;anim		= 10200
;id		= 10200
;pos		= 16,-96
;postype		= p1
;supermovetime	= 9999
;pausemovetime	= 9999
;supermove		= 1
;removetime	= -2
;sprpriority	= 8
;ownpal		= 1
;bindtime		= -1
;scale		= 1,1
;persistent	= 0
;
;[State 2000, Hand effects]
;type = Explod
;trigger1 = AnimElem = 3
;anim = 2101
;ID = 2000
;pos = 16,-96
;postype = p1  ;p2,front,back,left,right
;bindtime = -1
;removetime = 43
;scale = 1,1
;sprpriority = 3
;ownpal = 1
;removeongethit = 1
;ignorehitpause = 1
;supermovetime = 999
;pausemovetime = 999
;
;
;[State 2000, Jump movement]
;type = VelSet
;trigger1 = Time = 0
;x = -15
;y = IfElse(Pos y<0,-5,-10)
;
;[State 2000, Velocity Multiplier]
;type = VelMul
;trigger1 = Time = [1,11]
;x = 0.65
;y = 0.88
;;ignorehitpause = 
;;persistent = 
;
;
;[State 2000, Stop movement]
;type = VelSet
;trigger1 = Time =11
;x = 0
;y = 0



;[State 2000, Air physics]
;type = StateTypeSet
;trigger1 = AnimElem = 20
;physics = A
;ignorehitpause = 1
;;persistent = 





[State 2001, Kikoho helper]
type = helper
trigger1 = AnimElem = 1
helpertype = normal
stateno = 2102
ID = 2102
name = "Kikoho lvl 1"
postype = p1
pos = 16,-96
ownpal = 1


;STUN
[State 2001, VarAdd]
type = VarAdd
triggerall = Power = 0
triggerall = Var(26) = 1
trigger1 = Time = 1
SysFVar(4) = 80
ignorehitpause = 1

[State 2001, VarAdd]
type = VarAdd
triggerall = Power = 0
triggerall = Var(26) = 2
trigger1 = Time = 1
SysFVar(4) = 80
ignorehitpause = 1

[State 2001, VarAdd]
type = VarAdd
triggerall = Power = 0
triggerall = Var(26) = 3
trigger1 = Time = 1
SysFVar(4) = 80
ignorehitpause = 1

[State 2001, VarAdd]
type = VarAdd
triggerall = Power = 0
triggerall = Var(26) = 4
trigger1 = Time = 1
SysFVar(4) = 80
ignorehitpause = 1



[State 2001, VarAdd]
type = VarAdd
trigger1 = Time = 0
triggerall = PrevStateNo != 2000
var(26) = 1
ignorehitpause = 1


;LIFE
[State 2001, LifeAdd]
type = LifeAdd
triggerall = Power = 0
trigger1 = AnimElemTime(1) = 11;Time = 1
trigger1 = Life > 75
value = -75
kill = 1
absolute = 1
ignorehitpause = 1

[State 2001, LifeAdd]
type = LifeAdd
triggerall = Power = 0
trigger1 = AnimElemTime(1) = 30;Time = 1
trigger1 = Life <= 75
value = -75
kill = 1
absolute = 1
ignorehitpause = 1





[State 2001, ChangeState]
type = ChangeState
trigger1 =  AnimElemTime(16) >= 3
value = 2002
ctrl = 0
ignorehitpause = 1
persistent = 0

[State 1110, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = IfElse(alive,2002,5030)
ctrl = IfElse(alive,1,0)







;---------------------------------------------------------------------------
; Kikoho (Lvl 1) 3
; Descending
[Statedef 2002]
type    = A
movetype= A
physics = N
juggle  = 4
velset = 0,0
;poweradd = -1000
anim = 2002
ctrl = 0
sprpriority = 2

[State 2002, Null]
type = Null
trigger1 = 0

[State 2002, Gravity]
type = Gravity
trigger1 = 1
ignorehitpause = 1
;persistent =

[State 2002, State End]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = IfElse(SysFVar(4)=0,52,1110052) 









;---------------------------------------------------------------------------
; Kikoho (Lvl 1) 3 (dead)
; Descending 
[Statedef 2003]
type    = A
movetype= A
physics = N
juggle  = 4
velset = 0,0
;poweradd = -1000
anim = 2003
ctrl = 0
sprpriority = 2

[State 2003, Voice]
type = PlaySnd
trigger1 = Time = 0;AnimElemTime (1) = 0
value = 85,5007+random%2;80,5300+random%2
volumescale = 100
channel = 0


[State 2003, Gravity]
type = Gravity
trigger1 = AnimElemTime(8) >= 0
ignorehitpause = 1
;persistent =

[State 2003, State End]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5110

;To know how to get to this state, check state-2-3.cns, more precisely [State -3].






;---------------------------------------------------------------------------
; Kikoho (Lvl 1) 4
; Shooting again
[Statedef 2004]
type    = A
movetype= A
physics = N
juggle  = 4
velset = 0,0
poweradd = -500
anim = 2001
ctrl = 0
sprpriority = 2

;[State 2004, VarSet]; light = 0; medium = 1; heavy = 2
;type      = VarSet
;trigger1  = Time = 0 && !AILevel
;var(6)    = IfElse(Command = "x", 0, IfElse(Command = "y", 1, 2))
;[State 2004, VarSet]; for the AI (this may have to be removed or fixed)
;type      = VarSet
;trigger1  = Time = 0 && AILevel
;var(6)    = IfElse(random<100, 0, IfElse(random<350, 1, 2))


[State 2000, VarSet]; light = 0
type      = VarSet
trigger1  = Time = 0 && !AILevel
trigger1  = NumExplod(90000200)
var(6)    = 0
[State 2000, VarSet]; medium = 1
type      = VarSet
trigger1  = Time = 0 && !AILevel
trigger1  = NumExplod(90000210)
var(6)    = 1
[State 2000, VarSet]; heavy = 2
type      = VarSet
trigger1  = Time = 0 && !AILevel
trigger1  = NumExplod(90000220)
var(6)    = 2
[State 2004, VarSet]; for the AI (this may have to be removed or fixed)
type      = VarSet
trigger1  = Time = 0 && AILevel
var(6)    = IfElse(random<100, 0, IfElse(random<350, 1, 2))






[State 2004, Voice]	;Tien: "Ha!"
type = PlaySnd
trigger1 = AnimElemTime (1) = 0
value = s85,15+random%2;85,3108		80,2010
volumescale = 255
channel = 0




[State 2004, Kikoho helper]
type = helper
trigger1 = AnimElem = 1
helpertype = normal
stateno = 2102
ID = 2102
name = "Kikoho lvl 1"
postype = p1
pos = 16,-96
ownpal = 1


;STUN
[State 2004, VarAdd]
type = VarAdd
triggerall = Power = 0
triggerall = Var(26) = 1
trigger1 = Time = 1
SysFVar(4) = 80
ignorehitpause = 1

[State 2004, VarAdd]
type = VarAdd
triggerall = Power = 0
triggerall = Var(26) = 2
trigger1 = Time = 1
SysFVar(4) = 80
ignorehitpause = 1

[State 2004, VarAdd]
type = VarAdd
triggerall = Power = 0
triggerall = Var(26) = 3
trigger1 = Time = 1
SysFVar(4) = 80
ignorehitpause = 1

[State 2004, VarAdd]
type = VarAdd
triggerall = Power = 0
triggerall = Var(26) = 4
trigger1 = Time = 1
SysFVar(4) = 80
ignorehitpause = 1



[State 2004, VarAdd]
type = VarAdd
trigger1 = Time = 0
triggerall = PrevStateNo != 2000
var(26) = 1
ignorehitpause = 1


;LIFE
[State 2004, LifeAdd]
type = LifeAdd
triggerall = Power = 0
trigger1 = AnimElemTime(1) = 11;Time = 1
trigger1 = Life > 75
value = -75
kill = 1
absolute = 1
ignorehitpause = 1

[State 2004, LifeAdd]
type = LifeAdd
triggerall = Power = 0
trigger1 = AnimElemTime(1) = 30;Time = 1
trigger1 = Life <= 75
value = -75
kill = 1
absolute = 1
ignorehitpause = 1





[State 2004, ChangeState]
type = ChangeState
trigger1 =  AnimElemTime(16) >= 3
value = 2002
ctrl = 0
ignorehitpause = 1
persistent = 0

[State 2004, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = IfElse(alive,2002,5030)
ctrl = IfElse(alive,1,0)


;---------------------------------------------------------------------------
;Custom state - P2 going to the ground
[Statedef 2010]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 2010, 2]
type = changeanim2
trigger1 = !time && anim !=1125
value = 1125

[State 2010, vel Y]
type = velset
trigger1 = animelemtime(2)=0
y = 8
x = -7

[State 2010, Land]
type = changestate
trigger1 = Pos Y >= 0
trigger1 = Vel Y > 0
value = 2011
persistent = 0

;---------------------------------------------------------------------------
;Custom state - P2 hitting ground
[Statedef 2011]
type    = L
movetype= H
physics = N
velset = 0,0

[State 2011, 1]
type = VelSet
trigger1 = Time = 0
x = -15



[State 2011, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 2011, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 2011, 2] ;Hit ground anim (normal)
type = ChangeAnim
trigger1 = time = 0
value = 5170


[State 2011, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 2011, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 2011, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.5


[State 2011, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 2012


;---------------------------------------------------------------------------
;Custom state - Downed get-hit (hit ground from fall)
[Statedef 2012]
type    = L
movetype= H
physics = N
velset = 0,0

[State 2012, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 2012, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 2012, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 2012, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 2012, 6] ;Reduce speed
type = VelMul
trigger1 = 1
x = 0.75


[State 2012, 2] ;Hit ground anim
type = ChangeAnim
trigger1 = time = 0
value = 5170

[State 2012, 2] ;Lying on the floor
type = ChangeAnim
trigger1 = time = 35
value = 5110









;
;[State 2011, 12]
;type = ChangeState
;triggerall = Time >= 2
;trigger1 = Pos Y >= 0
;trigger1 = Vel Y > 0 ;AnimTime = 0
;value = 2013	;2012
;
;[State 2011, Bounce velset]
;type = VelSet
;trigger1 = Time = 1
;y = -9
;ignorehitpause = 1
;
;[State 2011, Gravity]
;type = Gravity
;trigger1 = Time > 2
;ignorehitpause = 0




[State 2012, 12]
type = SelfState		;in case something happens, like Tien not hitting the enemy.
trigger1 = Time >= 75
value = IfElse(Alive,5120,5150)	;Alive = he gets up; dead = he lies down.







;---------------------------------------------------------------------------
; Downed get-hit (lying down)
[Statedef 2013]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

;[State 5110, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = 15000,0


[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14] ;Friction
type = VelSet
trigger1 = abs(Vel x) < Const(movement.down.friction.threshold)
persistent = 0
x = 0

[State 5110, 15]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 16]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine



[State 2012, 12]
type = SelfState		;in case something happens, like Tien not hitting the enemy.
trigger1 = Time >= 75
value = IfElse(Alive,5120,5150)	;Alive = he gets up; dead = he lies down.










;---------------------------------------------------------------------------
; LVL1 Dodonpa 1
; Charging
[Statedef 2200]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
poweradd = -1000
anim = 2200
ctrl = 0
sprpriority = 2




[State 2200, width]
type = width
trigger1 = 1
value = 30,0

[State 2200, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,51]
flag = NoFG	;No Foreground

[State 2200, SuperPause]
type = SuperPause
trigger1 = !Time
time = 51
p2defmul = 1
unhittable = 1
anim = -1
;sound = s2000,10
darken = 0
movetime = 51



[State 2200, BG Pal FX - Dark]
type = BGPalFX
trigger1 = !time
time = 51
color = 0
mul = 0,0,0

[State 2200, Super FX LVL 1]
type = Explod
trigger1 = AnimElem = 5
anim = 10200
id = 10200
pos = -47,-43
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 2200, Hand effects]
type = Explod
trigger1 = AnimElem = 5
anim = 2205
ID = 2205
pos = -47,-43
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = 43
scale = 1,1
sprpriority = 1
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999


[State 2200, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = !Time
value = s2000,0
volumescale = 80
[State 2200, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = !Time
value = s2200,11
volumescale = 65
[State 2200, PlaySnd]	;Dodonpa charge 1
type = PlaySnd
trigger1 = Time = 16
value = s2200,0
volumescale = 125
[State 2200, PlaySnd]	;Dodonpa charge 2
type = PlaySnd
trigger1 = Time = 25
value = s2200,1
volumescale = 125
[State 2200, PlaySnd]	;Dodonpa charge 3
type = PlaySnd
trigger1 = Time = 34
value = s2200,2
volumescale = 125
[State 2200, PlaySnd]	;Dodonpa charge 4
type = PlaySnd
trigger1 = Time = 43
value = s2200,3
volumescale = 125




[State 2200, ChangeState]
type = ChangeState
trigger1 = Time = 51
value = 2201
ctrl = 0
ignorehitpause = 1


;---------------------------------------------------------------------------
; LVL1 Dodonpa 2
; Shooting
[Statedef 2201]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
poweradd = 0
anim = 2201
ctrl = 0
sprpriority = 2


[State 2201, width]
type = width
trigger1 = 1
value = 35,0

[State 2201, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id = 2205
ignorehitpause = 1
;persistent = 

[State 2201, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent = 







[State 2201, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 2
value = s2200,10
volumescale = 60

[State 2201, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 2
value = s2200,12
volumescale = 60




[State 2201, Voice]
type = PlaySnd
trigger1 = Time = 1
value = 85,2200+random%6;80,2200+(random%2)
volumescale = 255
channel = 0







[State 2201, Dodonpa helper]
type = Helper
trigger1 = AnimElem = 2
helpertype = normal
stateno = 2207
ID = 2207
name = "Dodonpa"
postype = p1
pos = 100,-60;0,0	;BindToParent in Helper.cns
ownpal = 1
sprpriority = 5

[State 2201, Helper - FX 1 Start]
type = Helper
trigger1 = AnimElem = 2
helpertype = normal ;player
name = "Dodonpa FX 1 Start"
ID = 2208
stateno = 2208
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0
ignorehitpause = 1
sprpriority = 5



[State 2201, Player helper]
type = Helper
trigger1 = !Time
helpertype = normal
stateno = 2216
name = "Tien"
postype = p1
pos = 0,0;0,0	;BindToParent in Helper.cns
ownpal = 1
sprpriority = 5





[State 2201, ChangeState]
type = ChangeState
trigger1 =  Time >= 45
value = 2202
ctrl = 0
ignorehitpause = 1
persistent = 0



;
;[State -1, Dodonpa lvl 2]
;type = ChangeState
;value = 2230
;triggerall = RoundState = 2
;triggerall = Command = "QCFx2, 2p"
;triggerall = Power >= 2000
;triggerall = !NumHelper(2207)
;trigger1 = StateNo = 2201 && Time >=20  ; && (NumHelper(2207) || Helper(2207),MoveHit)
;
;
;[State -1, Dodonpa lvl 2]
;type = ChangeState
;value = 2230
;triggerall = RoundState = 2
;triggerall = Command = "QCFx2, 2p"
;triggerall = Power >= 2000
;triggerall = NumHelper(2207)
;triggerall = (Helper(2207),MoveHit)
;triggerall = !NumHelper(2207)
;trigger1 = StateNo = 2201 ; && (NumHelper(2207) || Helper(2207),MoveHit)








[State -1, Dodonpa lvl 2]
type = ChangeState
value = 2230
triggerall = RoundState = 2
triggerall = IfElse(Facing = -1,(NumExplod(90030016)),NumExplod(90030114))
triggerall = NumExplod(90000200) && NumExplod(90000210)
triggerall = NumExplod(90000210) && NumExplod(90000220)
triggerall = NumExplod(90000220) && NumExplod(90000200)
triggerall = Power >= 2000
triggerall = !NumHelper(2207)
trigger1 = StateNo = 2201 && Time >=20  ; && (NumHelper(2207) || Helper(2207),MoveHit)


[State -1, Dodonpa lvl 2]
type = ChangeState
value = 2230
triggerall = RoundState = 2
triggerall = IfElse(Facing = -1,(NumExplod(90030016)),NumExplod(90030114))
triggerall = NumExplod(90000200) && NumExplod(90000210)
triggerall = NumExplod(90000210) && NumExplod(90000220)
triggerall = NumExplod(90000220) && NumExplod(90000200)
triggerall = Power >= 2000
triggerall = NumHelper(2207)
triggerall = (Helper(2207),MoveHit)
triggerall = !NumHelper(2207)
trigger1 = StateNo = 2201 ; && (NumHelper(2207) || Helper(2207),MoveHit)





;Since Mugen is very stupid, if I put the changestage trigger in the .cmd it will cause debug messages.
;So I must put this here.



;---------------------------------------------------------------------------
; LVL1 Dodonpa 3
; Recover
[Statedef 2202]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
anim = 2202
ctrl = 0
sprpriority = 2


[State 2202, ChangeState]
type = ChangeState
trigger1 =  AnimTime = 0
value = 0
ctrl = 1
ignorehitpause = 1
persistent = 0







;---------------------------------------------------------------------------
; LVL2 Dodonpa 1
; Charging
[Statedef 2230]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
poweradd = -2000
anim = 2203;2200
ctrl = 0
sprpriority = 2


[State 2200, width]
type = width
trigger1 = 1
value = 50,0

[State 2200, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,60]
flag = NoFG	;No Foreground

[State 2200, SuperPause]
type = SuperPause
trigger1 = !Time
time = 60
p2defmul = 1
unhittable = 1
anim = -1
;sound = s2000,10
darken = 0
movetime = 60



[State 2200, BG Pal FX - Dark]
type = BGPalFX
trigger1 = !time
time = 60
color = 0
mul = 0,0,0

[State 2200, Super FX LVL 2]
type = Explod
trigger1 = AnimElem = 5
anim = 10201
id = 10201
pos = -47,-43
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 2200, Hand effects]
type = Explod
trigger1 = AnimElem = 5
anim = 2205
ID = 2205
pos = -47,-43
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = 43
scale = 1,1
sprpriority = 1
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999


[State 2200, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = !Time
value = s2350,0
;volumescale = 80
[State 2200, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = !Time
value = s2200,11
volumescale = 65
[State 2200, PlaySnd]	;Dodonpa charge 1
type = PlaySnd
trigger1 = Time = 16
value = s2200,0
volumescale = 125
[State 2200, PlaySnd]	;Dodonpa charge 2
type = PlaySnd
trigger1 = Time = 25
value = s2200,1
volumescale = 125
[State 2200, PlaySnd]	;Dodonpa charge 3
type = PlaySnd
trigger1 = Time = 34
value = s2200,2
volumescale = 125
[State 2200, PlaySnd]	;Dodonpa charge 4
type = PlaySnd
trigger1 = Time = 43
value = s2200,3
volumescale = 125




[State 2200, ChangeState]
type = ChangeState
trigger1 = Time = 60
value = 2231
ctrl = 0
ignorehitpause = 1


;---------------------------------------------------------------------------
; LVL2 Dodonpa 2
; Shooting
[Statedef 2231]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
poweradd = 0
anim = 2201
ctrl = 0
sprpriority = 2

[State 2231, width]
type = width
trigger1 = 1
value = 35,0

[State 2231, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id = 2205
ignorehitpause = 1
;persistent = 

[State 2231, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent = 






[State 2231, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 2
value = s2200,20
;volumescale = 65

;[State 2231, PlaySnd]
;type = PlaySnd
;trigger1 = AnimElem = 2
;value = s2200,12
;volumescale = 65




[State 2201, Voice]
type = PlaySnd
trigger1 = Time = 1
value = 85,2200+random%6;80,2200+(random%2)
channel = 0






[State 2231, Dodonpa helper]
type = helper
trigger1 = AnimElem = 2
helpertype = normal
stateno = 2237
ID = 2237
name = "Dodonpa"
postype = p1
pos = 100,-60;0,0	;BindToParent in Helper.cns
ownpal = 1
sprpriority = 5

[State 2231, Helper - FX 1 Start]
type = Helper
trigger1 = AnimElem = 2
helpertype = normal ;player
name = "Dodonpa FX 1 Start"
ID = 2238
stateno = 2238
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0
ignorehitpause = 1
sprpriority = 5

[State 2231, Player helper]
type = Helper
trigger1 = !Time
helpertype = normal
stateno = 2216
name = "Tien"
postype = p1
pos = 0,0;0,0	;BindToParent in Helper.cns
ownpal = 1
sprpriority = 5





[State 2231, ChangeState]
type = ChangeState
trigger1 =  Time >= 70
value = 2232
ctrl = 0
ignorehitpause = 1
persistent = 0



;---------------------------------------------------------------------------
; LVL2 Dodonpa 3
; Recover
[Statedef 2232]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
anim = 2202
ctrl = 0
sprpriority = 2


[State 2202, ChangeState]
type = ChangeState
trigger1 =  AnimTime = 0
value = 0
ctrl = 1
ignorehitpause = 1
persistent = 0












;---------------------------------------------------------------------------
; Super Wing Attack
[Statedef 2300]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
poweradd = -1000
anim = 2300
ctrl = 0
sprpriority = 2


[State 2300, StateTypeSet]
type = StateTypeSet
trigger1 = Animelemtime(5)>=0
statetype = A       
physics = N       
ignorehitpause = 1

[State 2300, PosAdd]
type     = PosAdd
trigger1 = Animelem = 5
x        = 20


[State 2300, width]
type = width
trigger1 = 1
value = 30,0

[State 2300, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,51]
flag = NoFG	;No Foreground

[State 2200, SuperPause]
type = SuperPause
trigger1 = !Time
time = 51
p2defmul = 1
unhittable = 1
anim = -1
;sound = s2000,10
darken = 0
movetime = 51



[State 2300, BG Pal FX - Dark]
type = BGPalFX
trigger1 = !time
time = 51
color = 0
mul = 0,0,0

[State 2300, Super FX LVL 1]
type = Explod
trigger1 = AnimElem = 2
anim = 10200
id = 10200
pos = 0,-50
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0





[state 2300, Dust]
type = Explod
trigger1 = animelemtime(5)=0
anim = 1207
id = 1207
pos = -30,4
postype = P1
sprpriority = -3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1


[State 2300, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = !Time
value = s2000,0
volumescale = 80



[State 2300, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 5  || AnimElem = 11 || AnimElem = 17 || AnimElem = 23 
trigger2 = AnimElem = 29 || AnimElem = 35 || AnimElem = 41 || AnimElem = 47
value = 1400, 0

[State 2300, VelSet]
type = VelSet
trigger1 = Animelemtime(5)=0
x = 2.25
y = -2
ignorehitpause = 0


[State 2300, VelSet]
type = VelSet
trigger1 = Animelemtime(53)=0
x = 1
y = -2
ignorehitpause = 0 

[State 2300, Gravity]
type = Gravity
trigger1 = Animelemtime(55)>=0
ignorehitpause = 0
persistent = 1



[State 2300, NotHitBy]
type = NotHitBy
trigger1 = Time < 70;79
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1






[State 2300, Hitdef] ;frame 1400,2  1400,4    1400,22
type = HitDef
trigger1 = AnimElem = 5
trigger2 = AnimElem = 6 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 7
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 2,4
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 1
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-10
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
forcestand = 1
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 11
trigger2 = AnimElem = 12 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 7
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 2,5
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 1
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-10
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 17
trigger2 = AnimElem = 18 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 7
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 2,4
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 1
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-12
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 23
trigger2 = AnimElem = 24 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 7
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 2,4
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 1
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-12
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 29
trigger2 = AnimElem = 30 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 7
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 3,5
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 2
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-12
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 35
trigger2 = AnimElem = 36 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 5
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 3,5
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 2
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-12
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 41
trigger2 = AnimElem = 42 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 5
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 3,5
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 2
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-12
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 47
trigger2 = AnimElem = 48 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 5
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 4,5
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 5
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-12
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -4
id = 1415





[State 2300, Hitdef] ;frame 1400,6  1400,8
type = HitDef
trigger1 = AnimElem = 7
trigger2 = AnimElem = 8 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 4
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 2,4
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 1
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-10
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 13
trigger2 = AnimElem = 14 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 4
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 2,4
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 1
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-10
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 19
trigger2 = AnimElem = 20 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 4
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 2,4
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 1
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-10
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 25
trigger2 = AnimElem = 26 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 4
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 2,4
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 1
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-10
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415


[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 31
trigger2 = AnimElem = 32 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 4
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 3,5
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 2
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-10
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 37
trigger2 = AnimElem = 38 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 4
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 3,5
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 2
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-10
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415

[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 43
trigger2 = AnimElem = 44 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 4
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 3,5
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 2
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-10
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -3
id = 1415


[State 2300, Hitdef]
type = HitDef
trigger1 = AnimElem = 49
trigger2 = AnimElem = 50 && !MoveContact
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 10, 10, fvar(11) * 15)), 4
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 4,5
guard.pausetime = 5,5
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12,-75
hitsound = s5, 5
guardsound = S6,0
ground.type = High
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = -1,-10
guard.velocity = -6
airguard.velocity = -2,-3
air.type = High	
air.velocity = -3,-4.55
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0
fall.recovertime = 999
envshake.time = 7
envshake.freq = 80
envshake.ampl = -4
id = 2300

[State 2300, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = Numtarget(2300)
trigger1 = !(target, ishelper)
value = 755 ;763
ignorehitpause = 1
persistent = 0
id = 2300



[State 2300, 5]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -12
value = 1325;52





[State 2300, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit; = 1
ProjID = 3001	;Physical attack
projanim = 15999
projremovetime = 1
ignorehitpause=1





;---------------------------------------------------------------------------
; Shiyoken - start up
;(four arms attack)
[Statedef 2400]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
poweradd = -1000;-2000
anim = 2410	;2400
ctrl = 0
sprpriority = 2




[State 2400, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,110]		;time = [0,176]
flag = NoFG	;No Foreground

[State 2400, SuperPause]
type = SuperPause
trigger1 = !Time
time = 110	;176
p2defmul = 1
unhittable = 1
anim = -1
;sound = s2000,10
darken = 0
movetime = 110	;176



[State 2400, BG Pal FX - Dark]
type = BGPalFX
trigger1 = !time
time = 110	;176
color = 0
mul = 0,0,0

[State 2400, Super FX LVL 1]		;Super FX LVL 2
type = Explod
trigger1 = AnimElem = 1
anim = 10200		;10201
id = 10200		;10201
pos = 15,-85		;15,-55
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0




[State 2400, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = !Time
value = s2000,0		;s2350,0
;volumescale = 80

[State 2400, PlaySnd]	;Arms - rising
type = PlaySnd
trigger1 = AnimElem = 4
value = s2400,0
volumescale = 150
channel = 20

[State 2400, PlaySnd]	;Arms - formed
type = PlaySnd
trigger1 = AnimElem = 15
value = s2400,1
persistent = 0
volumescale = 150
channel = 20


[State 2400, Voice]	;Tien: "Four arms, all punches!"
type = PlaySnd
trigger1 = AnimElemTime (1) = 0
value = 85,2400
volumescale = 150
channel = 0



[State 2400, 5]
type = ChangeState
trigger1 = Time >= 	110	;176
value = 2401










;---------------------------------------------------------------------------
; Shiyoken - attacks
[Statedef 2401]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
poweradd = 0
anim = 2401
ctrl = 0
sprpriority = 2

[State 2401, PosAdd]
type = PosAdd
trigger1 = AnimElem = 2
x = 16
ignorehitpause = 1
persistent = 0

[State 2401, VelSet]
type = VelSet
trigger1 = AnimElem = 3
x = 2
ignorehitpause = 1


[state 1400, Dust]
type = Explod
trigger1 = animelemtime(3)=0
anim = 1216
id = 1216
facing = -1
pos = -35,4
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
ignorehitpause = 1
persistent = 0


[State 2400, Voice]	;Tien: "Ora ora ora ora ora!"
type = PlaySnd
trigger1 = AnimElemTime (1) = 0
value = s85,2405+random%2
volumescale = 255
channel = 0



[State 2401, PlaySND]
type = PlaySND
trigger1 = AnimElem = 3
trigger2 = AnimElem = 4
trigger3 = AnimElem = 5
value = 0, 0;+random%3
ignorehitpause = 1
volumescale = 40



[State 2401, Hitdef]
type = HitDef
trigger1 = AnimElem = 3
attr = S, HA
damage = Ceil(IfElse(fvar(11) * 16 < 7, 7, fvar(11) * 16)), 0	;25
animtype = Hard
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 3, 7
guard.pausetime = 4, 4
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12-random%40,-95+random%30
hitsound = s5,0+random%3
guardsound = S6,0
ground.type = High
ground.slidetime = 16;8
ground.hittime  = 22;8
ground.velocity = -2   ;-3
ground.cornerpush.veloff = -1;-1.5
guard.velocity = -2.5    ;-4.5
airguard.velocity = -4.5,-1
air.type = High	
air.velocity = -2,-1.5
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 10,10
yaccel = 0.5
p2facing = 1
envshake.time = 4
envshake.freq = 45
envshake.ampl = 2
forcestand = 1



[State 2401, Hitdef]
type = HitDef
trigger1 = AnimElem = 4
attr = S, HA
damage = Ceil(IfElse(fvar(11) * 16 < 7, 7, fvar(11) * 16)), 0	;25
animtype = Hard
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 3, 7
guard.pausetime = 4, 4
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12-random%40,-95+random%30
hitsound = s5,0+random%3
guardsound = S6,0
ground.type = High
ground.slidetime = 16;8
ground.hittime  = 22;8
ground.velocity = -2   ;-3
ground.cornerpush.veloff = -1;-1.5
guard.velocity = -2.5  ;-4.5
airguard.velocity = -4.5,-1
air.type = High	
air.velocity = -2,-1.5
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 0,0
yaccel = 0.5
p2facing = 1
envshake.time = 4
envshake.freq = 45
envshake.ampl = 2



[State 2401, Hitdef]
type = HitDef
trigger1 = AnimElem = 5
attr = S, HA
damage = Ceil(IfElse(fvar(11) * 16 < 7, 7, fvar(11) * 16)), 0	;25
getpower = 0,0
givepower = 35,35
animtype = Hard
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 3, 7
guard.pausetime = 4, 4
sparkno = s7030
guard.sparkno = s7000
sparkxy = -12-random%40,-95+random%30
hitsound = s5,0+random%3
guardsound = S6,0
ground.type = Low
ground.slidetime = 16;8
ground.hittime  = 22;8
ground.velocity = -2   ;-3
ground.cornerpush.veloff = -1;-1.5
guard.velocity = -2.5 ;-4.5
airguard.velocity = -4.5,-1
air.type = High	
air.velocity = -2,-1.5
air.hittime = 12
air.animtype = back
getpower = 0,0
givepower = 5,5
yaccel = 0.5
p2facing = 1
envshake.time = 4
envshake.freq = 45
envshake.ampl = 2


[State 2401, 5]
type = ChangeState
trigger1 = Time >= 51
value = 2402



[State 2401, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit = 1
ProjID = 3001	;Physical attack
projanim = 15999
projremovetime = 1
ignorehitpause=1





;---------------------------------------------------------------------------
; Shiyoken - uppercut
[Statedef 2402]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
anim = 2402
ctrl = 0
sprpriority = 2


[State 2402, PosAdd]
type = PosAdd
trigger1 = AnimElem = 4
x = 11
ignorehitpause = 1


[State 2402, 1]
type = HitDef
trigger1 = AnimElem = 6
attr = S, HA
damage = ceil(IfElse(fvar(11) * 41 < 7, 7, fvar(11) * 41)), 0
hitflag = MAF
guardflag = MA
priority = 4, Hit
pausetime = 24,25
guard.pausetime = 15,15
sparkno = s7030
guard.sparkno = s7000
sparkxy = -20,-85
hitsound   = s5,12
guardsound = S6,0
animtype = Hard;Up
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -1,-11.5
guard.velocity = -9
air.velocity = IfElse(p2movetype=H,-3,-1),IfElse(p2movetype=H,-5,-10)
fall = 0	;1
air.animtype = Hard
getpower= 0,0
givepower = 35,35
yaccel = 0.45
fall.recover = 0
envshake.time = 25
envshake.freq = 90
envshake.ampl = 8
numhits = 2
id = 2402



[State 2402, TargetBind]
type = TargetBind
trigger1 = movehit
trigger1 = numtarget(2402)
trigger1 = !(target, ishelper)
trigger1 = P2MoveType = H
time = 1
pos = p2bodydist x+60,-20
ignorehitpause = 1
persistent = 0

[State 2402, TargetState]	;Flip KO
type = TargetState
trigger1 = movehit = 1
trigger1 = numtarget(2402)
trigger1 = !(target, ishelper)
value = 1264 ;651
ignorehitpause = 0
persistent = 0
id = 2402




[State 2402, 2]
type = HitDef
trigger1 = AnimElem = 8 && !MoveContact
trigger2 = AnimElem = 9 && !MoveContact
attr = S, HA
damage = ceil(IfElse(fvar(11) * 20 < 7, 7, fvar(11) * 20)), 0
hitflag = MAF
guardflag = MA
priority = 4, Hit
pausetime = 14,15
guard.pausetime = 15,15
sparkno = s7030
guard.sparkno = s7000
sparkxy = -20,-85
hitsound   = s5,2
guardsound = S6,0
animtype = Hard;Up
ground.type = High
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -1,-11.5
guard.velocity = -9
air.velocity = IfElse(p2movetype=H,-3,-1),IfElse(p2movetype=H,-5,-10)
fall = 1
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.45
fall.recover = 0
id = 240299





[State 2402, PlaySND]
type = PlaySND
trigger1 = AnimElem = 5
value = 0, 2

[State 2400, Voice]
type = PlaySnd
trigger1 = AnimElemTime (5) = 0
value = 85,9 ;80,1100
volumescale = 150
channel = 0






[State 2400, No Attack Distance]
type = AttackDist
trigger1 = AnimElemTime(9)>=0
value = 0



[State 2402, Super BG Proj]
type = Projectile
triggerall = RoundState != 2
trigger1 = MoveHit = 1
ProjID = 3001	;Physical attack
projanim = 15999
projremovetime = 1
ignorehitpause=1




[State 2402, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1










;---------------------------------------------------------------------------
; Shiva's Cage - 1
; attack
[Statedef 2500]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
anim = IfElse(PrevStateNo = 2401, 2506, 2500)
ctrl = 0
sprpriority = 5
poweradd = -1000

[State 2500, StopSnd]
type = StopSnd
trigger1 = !Time
channel = 0



[State 2500, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,50]		;time = [0,176]
flag = NoFG	;No Foreground

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 2500, SuperPause]
type = SuperPause
trigger1 = !Time
time = 50	;176
p2defmul = 1
unhittable = 1
anim = -1
;sound = s2000,10
darken = 0
movetime = 50	;176

[State 2500, BG Pal FX - Dark]
type = BGPalFX
trigger1 = !time
time = 50	;176
color = 0
mul = 0,0,0

[State 2500, Super FX LVL 1]		;Super FX LVL 2
type = Explod
trigger1 = AnimElem = 1
anim = 10200		;10201
id = 10200		;10201
pos = -27,-103		;15,-55
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 2500, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = !Time
value = s2000,0		;s2350,0
;volumescale = 80

[State 2500, PlaySND]
type = PlaySND
trigger1 = AnimElem = 5
value = 0, 2

[State 2500, Voice]
type = PlaySnd
trigger1 = AnimElemTime (5) = 0
value = 85,9 ;80,1100
volumescale = 150
channel = 0










[State 2500, PosAdd]
type = PosAdd
trigger1 = AnimElem = 4
x = 11
ignorehitpause = 1


[State 2500, 1]
type = HitDef
trigger1 = AnimElem = 6
attr = S, HA
damage = ceil(IfElse(fvar(11) * 75 < 7, 7, fvar(11) * 75)), 0
;ceil(IfElse(fvar(11) * 41 < 7, 7, fvar(11) * 41)), 0
hitflag = MAF
guardflag = MA
priority = 4, Hit
pausetime = 24,25
guard.pausetime = 15,15
sparkno = s7030
guard.sparkno = s7000
sparkxy = -20,-85
hitsound   = s5,12
guardsound = S6,0
animtype = Hard;Up
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -1,-11.5
guard.velocity = -9
air.velocity = IfElse(p2movetype=H,-3,-1),IfElse(p2movetype=H,-5,-10)
fall = 0	;1
air.animtype = Hard
getpower= 0,0
givepower = 35,35
yaccel = 0.45
fall.recover = 0
envshake.time = 20
envshake.freq = 90
envshake.ampl = 6
numhits = 1 + IfElse (Anim = 2506,1,0)
id = 2500
kill = 0
p2facing = 1
p2sprpriority = 2



[State 2500, TargetBind]
type = TargetBind
trigger1 = movehit
trigger1 = numtarget(2500)
trigger1 = !(target, ishelper)
trigger1 = P2MoveType = H
time = 1
pos = p2bodydist x+60,-20
ignorehitpause = 1
persistent = 0

[State 2500, TargetState]	;Backbreaker
type = TargetState
trigger1 = movehit = 1
trigger1 = numtarget(2500)
trigger1 = !(target, ishelper)
value = 2510
ignorehitpause = 0
persistent = 0
id = 2500





[State 2500, No Attack Distance]
type = AttackDist
trigger1 = AnimElemTime(9)>=0
value = 0


[State 2500, 5]
type = ChangeState
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 = AnimTime = 0
value = 2501
ctrl = 0

[State 2500, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Shiva's Cage - 2
; jump off-screen
[Statedef 2501]
type = S
movetype = A
physics = N
ctrl = 0
anim = 2501
VelSet = 0,0
sprpriority = 2

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 2501, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[State 2501, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1
ignorehitpause = 1


;[State 2501, Teleport sound]
;type = PlaySnd
;trigger1 = AnimElem = 3
;value = s2500,0
;ignorehitpause = 1

[State 2502, VelSet]
type = VelSet
trigger1 = AnimElem = 3
x = 0;p2dist x/15
y = p2dist y/28
;ignorehitpause = 
;persistent = 



[State 55, Dash Effects]
type = Explod
trigger1 = AnimElem = 3
Anim = 8051
postype = P1
pos = 0,-20
bindtime = 15
sprpriority = 2
ownpal = 1
removetime = -2
removeongethit = 1

[State 55, SND Super jump]
type = PlaySND
trigger1 = AnimElem = 3
value = 0,24

[State 55, Trail]
type = AfterImage
trigger1 = AnimElem = 3
time= 30
timegap= 1
framegap= 3
length= 12
palbright= 0,0,0
paladd= 0,0,0
palmul= .9,.9,.9
palcontrast= 120,120,120
palpostbright= 0,0,0
trans= add1





[State 2502, Grab sound]
type = PlaySnd
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 =  Time = 55
value = S800,1
ignorehitpause = 1


[State 2500, ChangeState]
type = ChangeState
trigger1 = Time = 90
value = 2502
ctrl = 0




;---------------------------------------------------------------------------
; Shiva's Cage - 3
; falling down with enemy
[Statedef 2502]
type = A
movetype = A
physics = N
ctrl = 0
anim = 2502
sprpriority = -3

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze


[State 2502, Explod]	;arms
type = Explod
trigger1 = Time = 0
anim = 2503
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 2
ownpal = 0
ontop = 0
removeongethit = 1
ignorehitpause =1
id = 2502

[State 2502, Explod]	;face
type = Explod
trigger1 = Time = 0
anim = 2508
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 0
ontop = 0
removeongethit = 1
ignorehitpause =1
id = 2502



[State 2502, Width]
type = Width
trigger1 = 1
value = 50,50
;ignorehitpause = 
;persistent = 



[State 2502, TargetBind]
type = TargetBind
trigger1 = NumTarget
trigger1 = Target, StateNo = 2511
trigger1 = P2MoveType = H
time = 1
pos = 20,-120
ignorehitpause = 1

[State 2502, TargetState]	;Backbreaker
type = TargetState
trigger1 = Time = 0
value = 2511
ignorehitpause = 0
persistent = 0


[State 2502, PosSet]
type = PosSet
trigger1 = !Time
y = -150
ignorehitpause = 1

[State 2502, VelSet]
type = VelSet
trigger1 = !Time
y = 15
ignorehitpause = 1

[State 2502, Gravity]
type = Gravity
trigger1 = Time >= 0
ignorehitpause = 1




[State 2502, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1


[State 2502, ChangeState]
type = ChangeState
trigger1 = Pos Y >= 0
value = 2503
ctrl = 0





;---------------------------------------------------------------------------
; Shiva's Cage - 4
; crack!!
[Statedef 2503]
type = S
movetype = A
physics = N
ctrl = 0
anim = 2504
sprpriority = -3
velset = 0,0

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 2503, RemoveExplod]
type = RemoveExplod
trigger1 = !Time
id = 2502
;ignorehitpause = 
;persistent = 

[State 2503, EnvColor - white]
type = EnvColor
trigger1 = AnimElemTime(2) = 0
value = 255,255,255
time = 2
under = 1
ignorehitpause = 1 
persistent = 1
[State 2503, EnvColor - dark grey]
type = EnvColor
trigger1 = AnimElemTime(2) = 2
value = 56,56,56
time = 1
under = 1
ignorehitpause = 1 
persistent = 1

[State 2503, HitSpark]
type = Explod
triggerall = P2MoveType = H
trigger1 = AnimElemTime(2) = 0
anim = 7030
pos = 0+random%25,-75+random%5
postype = p1
removetime = -2
sprpriority = -3
ownpal = 1
removeongethit = 1
ignorehitpause = 1
persistent = 0

[State 2503, HitSpark]
type = Explod
triggerall = P2MoveType = H
trigger1 = Time = 5
anim = 7030
pos = 30-random%25,-75+random%5
postype = p1
removetime = -2
sprpriority = 5
ownpal = 1
removeongethit = 1
ignorehitpause = 1
persistent = 0

[State 2503, HitSpark]
type = Explod
triggerall = P2MoveType = H
trigger1 = Time = 8
anim = 7030
pos = -20+random%25,-75+random%5
postype = p1
removetime = -2
sprpriority = -1
ownpal = 1
removeongethit = 1
ignorehitpause = 1
persistent = 0


[State 2503, Explod]	;arms
type = Explod
trigger1 = Time = 0
anim = 2505
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 2
ownpal = 0
ontop = 0
removeongethit = 1
ignorehitpause =1

[State 2503, Explod]	;face
type = Explod
trigger1 = Time = 0
anim = 2507
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 0
ontop = 0
removeongethit = 1
ignorehitpause =1


[State 2503, PosSet]
type = PosSet
trigger1 = !Time
y = 0

[State 2503, Turn]
type = Turn
trigger1 = AnimElem = 6


[State 2503, Bones breaking sound]
type = PlaySnd
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 =  AnimElem = 2
value = S800,3
ignorehitpause = 1

[State 2503, Bones breaking sound]
type = PlaySnd
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 =  AnimElem = 2
value = S5,11
ignorehitpause = 1

[State 2503, Landing Sound]
type = PlaySnd
trigger1 = Time = 0
value = 800,2

[State 2503, Throwing Sound]
type = PlaySnd
trigger1 = AnimElem = 9
value = 0,2

[State 2503, Voice]
type = PlaySnd
trigger1 = AnimElem = 8
value = s85,310


[State 2503, EnvShake]
type = EnvShake
trigger1 = Time = 0
time = 5
freq = 120
ampl = 6








[State 2503, TargetBind]
type = TargetBind
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 = AnimElem = 1
time = 1
pos = 2,-105;10,-105
ignorehitpause = 1

[State 2503, TargetBind]
type = TargetBind
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 = AnimElem = 2
time = 1
pos = 2,-100;10,-100
ignorehitpause = 1

[State 2503, TargetBind]
type = TargetBind
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 = AnimElem = 3
time = 1
pos = 2,-90;10,-90
ignorehitpause = 1

[State 2503, TargetBind]
type = TargetBind
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 = AnimElem = 4
time = 1
pos = 2,-100;10,-100
ignorehitpause = 1

[State 2503, TargetBind]
type = TargetBind
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 = AnimElem = 5
time = 1
pos = -8,-105;0,-105
ignorehitpause = 1

[State 2503, TargetBind]
type = TargetBind
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 = AnimElem = 6
time = 1
pos = -8,-140;0,-140
ignorehitpause = 1

[State 2503, TargetBind]
type = TargetBind
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 = AnimElem = 7
time = 1
pos = -8,-142;0,-142
ignorehitpause = 1

[State 2503, TargetBind]
type = TargetBind
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 = AnimElem = 8
time = 1
pos = 17,-130;;25,-130
ignorehitpause = 1

[State 2503, TargetBind]
type = TargetBind
triggerall = NumTarget(2500)
triggerall = Target, StateNo = [2510,2515]
trigger1 = AnimElem = 9
time = 1
pos = 42,-80;50,-80
ignorehitpause = 1








[State 2503, TargetState]	;Backbreaker
type = TargetState
trigger1 = NumTarget
trigger1 = Target, StateNo = 2511
trigger1 = Time = 0
value = 2512
ignorehitpause = 0
persistent = 0

[State 2503, TargetState]	;Backbreaker
type = TargetState
trigger1 = NumTarget
trigger1 = Target, StateNo = 2512
trigger1 = AnimElem = 9
value = 2513
ignorehitpause = 0
persistent = 0

[State 2503, SprPriority]
type = SprPriority
trigger1 = AnimElemTime(9) >= 0
value = 4
ignorehitpause = 1







[State 2503, VarAdd - for 'dmg dampening']
type = VarAdd
triggerall = P2MoveType = H
trigger1 = AnimElem = 2
fvar(13) = 1		;1 hit so 1 point; try to consider this as a normal attack.
ignorehitpause = 1

[State 2503, TargetLifeAdd]
type = TargetLifeAdd
triggerall = P2MoveType = H
trigger1 = AnimElem = 2
value = -1* Ceil(IfElse(fvar(11) * 130 < 25, 25, fvar(11) * 130))  ;-25
kill = 1
absolute = 0
ignorehitpause = 1

[State 2503, HitAdd]
type = HitAdd
trigger1 = AnimElem = 3
value = 1


[State 2503, Super BG Proj]
type = Projectile
triggerall = RoundState != 2
trigger1 = Enemy, Alive = 0
ProjID = 3001	;Physical attack
projanim = 15999
projremovetime = 1
ignorehitpause=1



[State 2503, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1




;---------------------------------------------------------------------------
; SC - Custom state 1
[Statedef 2510]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = 3
velset = 0,-25


;Remember: if you're coding a custom state, be sure to use ChangeAnim2!!
[State 2510, ChangeAnim2]
type = ChangeAnim2
trigger1 = Time = 0
value = 2510
ignorehitpause = 1


[State 2510, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 2510, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[State 2510, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 2511

;From now on, the custom state will be directed by the attacker.
;What I mean is I used TargetState state controllers to make the enemy (in custom state) change states.



;---------------------------------------------------------------------------
; SC - Custom state 2
[Statedef 2511]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = 3
velset = 0,0

[State 2511, ChangeAnim2]
type = ChangeAnim2
trigger1 = Time = 0
value = 2511
ignorehitpause = 1

[State 2511, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 2511, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1






;---------------------------------------------------------------------------
; SC - Custom state 3
[Statedef 2512]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = 3
velset = 0,0

[State 2512, ChangeAnim2]
type = ChangeAnim2
triggerall = !SelfAnimExist(5946) && !SelfAnimExist(5947)
trigger1 = Time = 0
value = 2512
ignorehitpause = 1

[State 2512, ChangeAnim2]
type = ChangeAnim2
triggerall = SelfAnimExist(5946) && SelfAnimExist(5947)
trigger1 = Time = 0
value = 5946
ignorehitpause = 1

;[State 1000, Broken Back - Arm helper]
;type = Helper
;helpertype = normal
;triggerall = SelfAnimExist(5946) && SelfAnimExist(5947)
;trigger1 = Time = 0
;name = "broken_arm"
;postype = P1
;pos = 0,0
;ownpal = 0
;stateno = 245947
;sprpriority = -3


[State 3020, Dirty Hack]	;XGargoyle is dirty
type = AssertSpecial
triggerall = SelfAnimExist(5946) && SelfAnimExist(5947)
trigger1 = Time <= 43
flag = Invisible


[State 3550, Broken Back - Body Overlay]
type = Explod
trigger1 = !Time
trigger1 = SelfAnimExist(5946) && SelfAnimExist(5947) ;Anim=5946
anim = 5946
id = 5946
pos = 0,0
postype = p1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
supermove = 1
removetime = 44 ;20
sprpriority = 4
ownpal = 1
bindtime = -1
scale = 1,1
ignorehitpause = 1
persistent = 0

[State 3550, Broken Back - Arm Underlay]
type = Explod
trigger1 = !Time
trigger1 = SelfAnimExist(5946) && SelfAnimExist(5947) ;Anim=5946
anim = 5947
id = 5947
pos = 0,0
postype = p1
supermovetime = 0 ;9999
pausemovetime = 0 ;9999
supermove = 1
removetime = 44 ;20
;sprpriority = 9
ownpal = 1
bindtime = -1
scale = 1,1
ignorehitpause = 1
persistent = 0







[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = Time = 44
value = 2512
elem = 2
ignorehitpause = 1
persistent = 1


[State 2512, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 2512, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1






;---------------------------------------------------------------------------
; SC - Custom state 4
[Statedef 2513]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = 3

[State 2513, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 2513, VelSet]
type = VelSet
trigger1 = Time = 0
x = 7
y = 1.23
ignorehitpause = 1

[State 2513, Gravity]
type = Gravity
trigger1 = 1
ignorehitpause = 1

[State 2512, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[State 2513, ChangeState]
type = SelfState
trigger1 = Pos Y >= -20
value = 5100





;---------------------------------------------------------------------------
; OM MODE
[Statedef 2800]
type    = S
movetype= I
physics = S
juggle  = 4
velset = 0,0
poweradd = 0
anim = 2800	;2400
ctrl = 0
sprpriority = 2

[State 2800, PowerAdd]
type = PowerAdd
trigger1 = animelemtime(3)=0
value = -2000




[State 2400, SuperPause]
type = SuperPause
trigger1 = AnimElemTime(3)=0
time = 140
p2defmul = 1
unhittable = 1
anim = -1
;sound = s2000,10
darken = 0;1
movetime = 140	;176

[State 2800, BGPalFX]
type = BGPalFX
trigger1 = animelemtime(3)>=0 && time<140
time = 1
add	= -100,-100,-100
mul	= 100,100,256
invertall = 0
color = 256



[State 3000, nhb]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA




[State 2400, PlaySnd]	;Sound
type = PlaySnd
trigger1 = AnimElem = 3
value = 0,4
volumescale = 150







[State 1700, Voice]
type = PlaySnd
trigger1 = AnimElem = 7
value = S85,2801
volumescale = 100
channel = 0




;[State 2800, VarAdd]
;type = VarSet
;trigger1 = AnimElem = 3
;var(41) = 1
;
;[State 2800, VarAdd]
;type = VarSet
;trigger1 = AnimElem = 3
;var(40) = 1






[State 3000, OM MODE was performed]
type = VarSet
trigger1 = AnimElem = 3
fvar(27) = 1
[State 2700, Emotion bar PowerSet 0]
type = VarSet
trigger1 = !Time
fvar(28) = 0














[State 2400, 5]
type = ChangeState
trigger1 = AnimTime = 0;Time >= 120	;176
value = 0
ctrl = 1





;---------------------------------------------------------------------------
; Ungrounded - LVL 3
[Statedef 3000]
type    = A
movetype= A
physics = N
juggle  = 7
VelSet = 0,0
ctrl = 0
anim = 3000
poweradd = IfElse(fvar(27) = 0,-3000,-2000) ;IfElse(var(40)=0,-3000,-2000)
sprpriority = 2
facep2 = 1




[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze



;[State 3000, VarSet]
;type = VarSet
;trigger1 = AnimElemTime(7) >= 0;!Time
;var(40) = 0
;ignorehitpause = 1




; In case the move doesn't connect, this var goes to 1 and in state -2 it will remove the OM system.
[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
var(40) = 1





[State 3000, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,60]		;time = [0,176]
flag = NoFG	;No Foreground

[State 3000, SuperPause]
type = SuperPause
trigger1 = !Time
time = 60	;176
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 60	;176

[State 3000, BG Pal FX - Dark]
type = BGPalFX
trigger1 = !time
time = 60	;176
color = 0
mul = 0,0,0

[State 3000, Super FX LVL 2]
type = Explod
trigger1 = AnimElem = 1
anim = 10201
id = 10201
pos = 08,-85
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 3000, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = !Time
value = s2350,0		;s2350,0
;volumescale = 80

[State 3000, PlaySnd]	;Clones
type = PlaySnd
trigger1 = AnimElemTime(6) = 56;61
value = s3000,0





[State 2004, Voice]	
type = PlaySnd
trigger1 = AnimElemTime (6) = 0
value = 85,3000;80,3000
volumescale = 255
channel = 0






[State 3000, Jump movement]
type = VelSet
trigger1 = AnimElemTime(4)>= 0 && AnimElemTime(6)< 0
y = IfElse(Pos y<0,-5,-10)

[State 3000, Velocity Multiplier]
type = VelMul
trigger1 = AnimElemTime(4)>= 0 && AnimElemTime(6)< 0
y = 0.88
;ignorehitpause = 
;persistent = 


[State 3000, Stop movement]
type = VelSet
trigger1 = AnimElemTime(6)= 0
y = 0



[State 3037, PalFX]
type = PalFX
trigger1 = Time%3 = 0 && AnimElemTime(6) >= 30 && AnimElemTime(6) <= 90
time = 2
add = 128,128,128


[State 2001, Helper]	;F
type = helper
trigger1 = AnimElemTime(6) = 56;61
helpertype = normal
stateno = 3001
ID = 3001
name = "Tien 1"
postype = p1
pos = 0,0
ownpal = 1
facing = 1

[State 2001, Helper]	;B
type = helper
trigger1 = AnimElemTime(6) = 56;61
helpertype = normal
stateno = 3003
ID = 3003
name = "Tien 2"
postype = p1
pos = 0,0
ownpal = 1
facing = 1

[State 2001, Helper]	;UF
type = helper
trigger1 = AnimElemTime(6) = 56;61
helpertype = normal
stateno = 3005
ID = 3005
name = "Tien 3"
postype = p1
pos = 0,0
ownpal = 1
facing = 1

[State 2001, Helper]	;UB
type = helper
trigger1 = AnimElemTime(6) = 56;61
helpertype = normal
stateno = 3007
ID = 3007
name = "Tien 4"
postype = p1
pos = 0,0
ownpal = 1
facing = 1





;You need all of these.
[State 3000, 3]
type = ChangeState
;triggerall = NumHelper(3001)
;triggerall = Helper(3001), MoveHit = 1
triggerall = P2StateNo = [3010,3017]
trigger1 = Time > 0
value = 3009	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
;triggerall = NumHelper(3003)
;triggerall = Helper(3003), MoveHit = 1
triggerall = P2StateNo = [3010,3017]
trigger1 = Time > 0
value = 3009	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
;triggerall = NumHelper(3005)
;triggerall = Helper(3005), MoveHit = 1
triggerall = P2StateNo = [3010,3017]
trigger1 = Time > 0
value = 3009	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
;triggerall = NumHelper(3007)
;triggerall = Helper(3007), MoveHit = 1
triggerall = P2StateNo = [3010,3017]
trigger1 = Time > 0
value = 3009	;45
ctrl = 0









[State 3000, 3]
type = ChangeState
triggerall = NumHelper(3001)
triggerall = Helper(3001), MoveHit = 0
trigger1 = AnimTime = 0
value = 51	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
triggerall = NumHelper(3003)
triggerall = Helper(3003), MoveHit = 0
trigger1 = AnimTime = 0
value = 51	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
triggerall = NumHelper(3005)
triggerall = Helper(3005), MoveHit = 0
trigger1 = AnimTime = 0
value = 51	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
triggerall = NumHelper(3007)
triggerall = Helper(3007), MoveHit = 0
trigger1 = AnimTime = 0
value = 51	;45
ctrl = 0



[State 3000, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(7) <= 0
value = SCA,AA
time = 1
ignorehitpause = 1
persistent = 1

[State 3000, Gravity]
type = Gravity
trigger1 = AnimElemTime(7) >= 0
ignorehitpause = 1
;persistent = 



[State 3000, Land]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52
ctrl = 0




;---------------------------------------------------------------------------
; Ungrounded - LVL 3 air
[Statedef 3018]
type    = A
movetype= A
physics = N
juggle  = 7
VelSet = 0,0
ctrl = 0
anim = 3018
poweradd = IfElse(fvar(27) = 0,-3000,-2000) ;IfElse(var(40)=0,-3000,-2000)
sprpriority = 2
facep2 = 1




[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze



;[State 3000, VarSet]
;type = VarSet
;trigger1 = AnimElemTime(7) >= 0;!Time
;var(40) = 0
;ignorehitpause = 1




; In case the move doesn't connect, this var goes to 1 and in state -2 it will remove the Emotion system.
[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
var(40) = 1




[State 3000, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,60]		;time = [0,176]
flag = NoFG	;No Foreground

[State 3000, SuperPause]
type = SuperPause
trigger1 = !Time
time = 60	;176
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 60	;176

[State 3000, BG Pal FX - Dark]
type = BGPalFX
trigger1 = !time
time = 60	;176
color = 0
mul = 0,0,0

[State 3000, Super FX LVL 2]
type = Explod
trigger1 = AnimElem = 1
anim = 10201
id = 10201
pos = 08,-85
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 3000, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = !Time
value = s2350,0		;s2350,0
;volumescale = 80

[State 3000, PlaySnd]	;Clones
type = PlaySnd
trigger1 = AnimElemTime(6) = 56;61
value = s3000,0




[State 2004, Voice]  
type = PlaySnd
trigger1 = AnimElemTime (6) = 0
value = 85,3000;80,3000
volumescale = 255
channel = 0






[State 3000, Stop movement]
type = VelSet
trigger1 = AnimElemTime(6)= 0
y = 0



[State 3037, PalFX]
type = PalFX
trigger1 = Time%3 = 0 && AnimElemTime(6) >= 30 && AnimElemTime(6) <= 90
time = 2
add = 128,128,128


[State 2001, Helper]	;F
type = helper
trigger1 = AnimElemTime(6) = 56;61
helpertype = normal
stateno = 3001
ID = 3001
name = "Tien 1"
postype = p1
pos = 0,0
ownpal = 1
facing = 1

[State 2001, Helper]	;B
type = helper
trigger1 = AnimElemTime(6) = 56;61
helpertype = normal
stateno = 3003
ID = 3003
name = "Tien 2"
postype = p1
pos = 0,0
ownpal = 1
facing = 1

[State 2001, Helper]	;UF
type = helper
trigger1 = AnimElemTime(6) = 56;61
helpertype = normal
stateno = 3005
ID = 3005
name = "Tien 3"
postype = p1
pos = 0,0
ownpal = 1
facing = 1

[State 2001, Helper]	;UB
type = helper
trigger1 = AnimElemTime(6) = 56;61
helpertype = normal
stateno = 3007
ID = 3007
name = "Tien 4"
postype = p1
pos = 0,0
ownpal = 1
facing = 1





;You need all of these.
[State 3000, 3]
type = ChangeState
;triggerall = NumHelper(3001)
;triggerall = Helper(3001), MoveHit = 1
triggerall = P2StateNo = [3010,3017]
trigger1 = Time > 0
value = 3009	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
;triggerall = NumHelper(3003)
;triggerall = Helper(3003), MoveHit = 1
triggerall = P2StateNo = [3010,3017]
trigger1 = Time > 0
value = 3009	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
;triggerall = NumHelper(3005)
;triggerall = Helper(3005), MoveHit = 1
triggerall = P2StateNo = [3010,3017]
trigger1 = Time > 0
value = 3009	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
;triggerall = NumHelper(3007)
;triggerall = Helper(3007), MoveHit = 1
triggerall = P2StateNo = [3010,3017]
trigger1 = Time > 0
value = 3009	;45
ctrl = 0









[State 3000, 3]
type = ChangeState
triggerall = NumHelper(3001)
triggerall = Helper(3001), MoveHit = 0
trigger1 = AnimTime = 0
value = 51	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
triggerall = NumHelper(3003)
triggerall = Helper(3003), MoveHit = 0
trigger1 = AnimTime = 0
value = 51	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
triggerall = NumHelper(3005)
triggerall = Helper(3005), MoveHit = 0
trigger1 = AnimTime = 0
value = 51	;45
ctrl = 0

[State 3000, 3]
type = ChangeState
triggerall = NumHelper(3007)
triggerall = Helper(3007), MoveHit = 0
trigger1 = AnimTime = 0
value = 51	;45
ctrl = 0



[State 3000, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(7) < 0
value = SCA,AA
time = 1
ignorehitpause = 1
persistent = 1

[State 3000, Gravity]
type = Gravity
trigger1 = AnimElemTime(7) >= 0
ignorehitpause = 1
;persistent = 


[State 3000, Land]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52
ctrl = 0









; Teleport out
[Statedef 3009]
type = S
movetype = I
physics = S
ctrl = 0
anim = 3009
VelSet = 0,0
sprpriority = 2
facep2 = 1 ;FIX




[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = 
;value2 = S,NA
time = 1
;ignorehitpause = 
;persistent = 

[State 3009, PosSet]
type = PosSet
trigger1 = Time < 50 && Time > 10
x = -50*facing;0;P2BodyDist x;-30
y = 0
ignorehitpause = 1
;persistent = 




;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
[State 0, Explod];for cinematic
type = Explod
trigger1 = !NumExplod(991901)
trigger1 = Time >= 3
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1


;[State 0, RemoveExplod];Put this when tien finishes or fails the technique
;type = RemoveExplod
;trigger1 = !Time
;id = 991901
;
;[State -2, RemoveExplod];put this in state-2
;type = RemoveExplod
;trigger1 = Ctrl
;id = 991901





;
;[State 99999999, Stupid Explod used to see where Tien is];TEST with anvil
;type = Explod
;trigger1 = Time > 0
;anim = 19000
;id = 19000	
;pos = 0,-20	
;postype = p1
;supermovetime = 9999
;pausemovetime = 9999
;supermove = 1
;removetime = 500
;sprpriority = 8
;ownpal = 1
;bindtime = -1
;scale = 1.5,1.5
;persistent = 0







;Attack 1
[State 2001, Helper]
type = helper
triggerall = Facing = 1
trigger1 = Time = 40	;50
helpertype = normal
stateno = 3020
ID = 3020
name = "Tien 1"
postype = Left;p1
pos = 100,0
ownpal = 1
facing = 1
sprpriority = 3

[State 2001, Helper]
type = helper
triggerall = Facing = -1
trigger1 = Time = 40
helpertype = normal
stateno = 3020
ID = 3020
name = "Tien 1"
postype = Right;p1
pos = -100,0
ownpal = 1
facing = -1
sprpriority = 3



;Fake, meaning he does the same thing as the other one but you won't hear hitsounds, or see another hitspark.
;As far as attacks go, he does the same as the other one.
[State 2001, Helper]
type = helper
triggerall = Facing = 1
trigger1 = Time = 40
helpertype = normal
stateno = 3021
ID = 3021
name = "Tien 1 fake"
postype = Right;p1
pos = -100,0
ownpal = 1
facing = -1
sprpriority = 3

[State 2001, Helper]
type = helper
triggerall = Facing = -1
trigger1 = Time = 40
helpertype = normal
stateno = 3021
ID = 3021
name = "Tien 1 fake"
postype = Left;p1
pos = 100,0
ownpal = 1
facing = 1
sprpriority = 3











;Attack 2
[State 2001, Helper]
type = helper
triggerall = Facing = 1
trigger1 = Time = 40
helpertype = normal
stateno = 3022
ID = 3022
name = "Tien 2"
postype = Left;p1
pos = 100,0
ownpal = 1
facing = 1
sprpriority = 3

[State 2001, Helper]
type = helper
triggerall = Facing = -1
trigger1 = Time = 40
helpertype = normal
stateno = 3022
ID = 3022
name = "Tien 2"
postype = Right;p1
pos = -100,0
ownpal = 1
facing = -1
sprpriority = 3






[State 2001, Helper]
type = helper
triggerall = Facing = 1
trigger1 = Time = 40
helpertype = normal
stateno = 3023
ID = 3023
name = "Tien 2 fake"
postype = Right;p1
pos = -100,0
ownpal = 1
facing = -1
sprpriority = 3

[State 2001, Helper]
type = helper
triggerall = Facing = -1
trigger1 = Time = 40
helpertype = normal
stateno = 3023
ID = 3023
name = "Tien 2 fake"
postype = Left;p1
pos = 100,0
ownpal = 1
facing = 1
sprpriority = 3















;Attack 3
[State 2001, Helper]
type = helper
triggerall = Facing = 1
trigger1 = Time = 110;120	;130
helpertype = normal
stateno = 3030
ID = 3030
name = "Tien 3"
postype = Left;p1
pos = 100,-70
ownpal = 1
facing = 1
sprpriority = 3

[State 2001, Helper]
type = helper
triggerall = Facing = 1
trigger1 = Time = 110;120
helpertype = normal
stateno = 3031
ID = 3031
name = "Tien 3 fake"
postype = Right;p1
pos = -100,-70
ownpal = 1
facing = -1
sprpriority = 3




[State 2001, Helper]
type = helper
triggerall = Facing = -1
trigger1 = Time = 110;120
helpertype = normal
stateno = 3030
ID = 3030
name = "Tien 3"
postype = Right;p1
pos = -100,-70
ownpal = 1
facing = -1
sprpriority = 3

[State 2001, Helper]
type = helper
triggerall = Facing = -1
trigger1 = Time = 110;120
helpertype = normal
stateno = 3031
ID = 3031
name = "Tien 3 fake"
postype = Left;p1
pos = 100,-70
ownpal = 1
facing = 1
sprpriority = 3






[State 3000, set OM variable to 0]
type = VarSet
triggerall = enemy,stateno = 3040
trigger1 = !time
fvar(27) = 0
[State 3000, set OM power to 0]
type = VarSet
triggerall = enemy,stateno = 3040
trigger1 = !time
fvar(28) = 0












[State 195, ChangeState]; LVL 0, nothing
type = ChangeState
triggerall = fvar(28)>=0 && fvar(28)<30;triggerall = var(40) = 0
trigger1 = NumHelper(3030)
trigger1 = Helper(3030), Pos Y >= 0
value = 3035
ctrl = 1




[State 195, ChangeState]; LVL 1, Volleyball Smackdown
type = ChangeState
triggerall = fvar(28)>= 30 && fvar(28) < 60
trigger1 = NumHelper(3020)
trigger1 = Helper(3020), StateNo = 3072
value = 3075
ctrl = 0



[State 195, ChangeState]; LVL 2, Double Dodonpa
type = ChangeState
trigger1 = fvar(28)>= 60 && fvar(28) < 90
trigger1 = NumHelper(3030)
trigger1 = Helper(3030), Pos Y >= 0	&& Helper(3030),StateNo = 3213
value = 3200
ctrl = 0



[State 195, ChangeState]; LVL 3, Shin Kikoho
type = ChangeState
triggerall = fvar(28)>= 90
trigger1 = NumHelper(3030)
trigger1 = Helper(3030), Pos Y >= 0
value = 3400
ctrl = 0



;---------------------------------------------------------------------------
; Custom state 1 ms
;ms = middle screen
[Statedef 3010]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
sprpriority = 1
facep2 = 1

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 3010, NotHitBy]
type = NotHitBy
trigger1 = Time < 10
value = SCA,AA;,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
;ignorehitpause = 
;persistent = 


[State 3010, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3010
elem = 1
ignorehitpause = 1
persistent = 0


[State 3010, VelSet]
type = VelSet
trigger1 = 1
x = -pos x/10*facing
y = ((GameHeight/3)+30)-ScreenPos Y

[State 3010, ChangeState]
type = SelfState
trigger1 = time >= 100
value = 5030
ctrl = 0









;---------------------------------------------------------------------------
; Custom state 2 down
[Statedef 3012]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
sprpriority = 1
facep2 = 1

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 3012, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3012
elem = 1
ignorehitpause = 1
persistent = 0


[State 3012, VelSet]
type = VelSet
trigger1 = !Time
x = 0
y = 6
ignorehitpause = 1

[State 0, Gravity]
type = Gravity
trigger1 = 1
ignorehitpause = 1

[State 3012, ChangeState]
type = SelfState
trigger1 = time >= 100
value = 5030
ctrl = 0

[State 2003, State End]
type = SelfState
trigger1 = Pos Y >= 0
value = 5110


;---------------------------------------------------------------------------
; Custom state 3 up
[Statedef 3013]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
sprpriority = 1
facep2 = 1

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 3013, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3013
elem = 1
ignorehitpause = 1
persistent = 0


[State 3013, VelSet]
type = VelSet
trigger1 = !Time
x = 0
y = -9.8
ignorehitpause = 1

[State 3013, Gravity]
type = VelAdd
trigger1 = 1
y = .5
ignorehitpause = 1


[State 3013, ChangeState]
type = SelfState
trigger1 = time >= 100
value = 5030
ctrl = 0

[State 2003, State End]
type = SelfState
trigger1 = Pos Y >= 0
value = 5110






;---------------------------------------------------------------------------
; Custom state 4 down
[Statedef 3014]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
sprpriority = 1
facep2 = 1

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 3012, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3012
elem = 1
ignorehitpause = 1
persistent = 0


[State 3012, VelSet]
type = VelSet
trigger1 = !Time
x = 0
y = 6
ignorehitpause = 1

[State 0, Gravity]
type = Gravity
trigger1 = 1
ignorehitpause = 1

[State 3012, ChangeState]
type = SelfState
trigger1 = time >= 100
value = 5030
ctrl = 0

[State 2003, State End]
type = ChangeState
;triggerall = Enemy, Var(40) = 0
trigger1 = Pos Y >= 0
value = 3015











;---------------------------------------------------------------------------
; Downed get-hit (hit ground from fall)
[Statedef 3015]
type    = L
movetype= H
physics = N

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.75

[State 5100, 7]
type = ChangeState
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
value = 5110 ;Downed get-hit (lying down)

[State 5100, 9]
type = HitFallDamage
trigger1 = Time = 3


[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 3016 ;Downed get-hit (bounce off ground)

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;---------------------------------------------------------------------------
; Downed get-hit (bounce off ground)
[Statedef 3016]
type    = L
movetype= H
physics = N

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 5101, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160

[State 5101, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160 + (anim % 10)

[State 5101, 3]
type = HitFallVel
trigger1 = Time = 0

[State 5101, 4]
type = PosSet
trigger1 = Time = 0
y = Const(movement.down.bounce.offset.y)

[State 5101, 5]
type = PosAdd
trigger1 = Time = 0
x = Const(movement.down.bounce.offset.x)

[State 5101, 6] ;Acceleration
type = VelAdd
trigger1 = 1
y = Const(movement.down.bounce.yaccel)

[State 5101, 7] ;Hit ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= Const(movement.down.bounce.groundlevel)
value = 3017


;---------------------------------------------------------------------------
; Downed get-hit (lying down)
[Statedef 3017]
type    = L
movetype= H
physics = N

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0


[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14] ;Friction
type = VelSet
trigger1 = abs(Vel x) < Const(movement.down.friction.threshold)
persistent = 0
x = 0


[State 0, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
triggerall = Enemy, FVar(27) = 0
trigger1 = !Time
id = 991901




[State 2012, 12]	;LVL 1
type = ChangeState
triggerall = Enemy, FVar(28) >= 30 && Enemy, FVar(28) < 60
trigger1 = Time >= 25	;100	;150
value = 3040
ctrl = 0


[State 2012, 12]	;LVL 2
type = ChangeState
triggerall = Enemy, FVar(28) >= 60 && Enemy, FVar(28) < 90
trigger1 = Time >= 25	;100	;150
value = 3250
ctrl = 0

[State 2012, 12]	;LVL 3
type = ChangeState
triggerall = Enemy, FVar(28) >= 90
trigger1 = Time >= 25	;100	;150
value = 3450
ctrl = 0




[State 2012, 12]	;LVL 0
type = SelfState		;in case something happens, like Tien not hitting the enemy.
triggerall = Enemy, FVar(28) >= 0 && Enemy, FVar(28) < 30
trigger1 = Time >= 175	;150
value = IfElse(Alive,5120,5150)	;Alive = he gets up; dead = he lies down.











;---------------------------------------------------------------------------
; Landing
[Statedef 3035]
type = S
movetype = I
physics = S
ctrl = 0
anim = 3035
VelSet = 0,0
sprpriority = 2

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = 
;value2 = S,NA
time = 1
;ignorehitpause = 
;persistent = 

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time < 1
flag = invisible




[State 3035, PosSet]
type = PosSet
trigger1 = !Time
x = cond(NumHelper(3030), helper(3030),pos x, pos x)
y = 0




[State 3035, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 3036
ctrl = 1

;---------------------------------------------------------------------------
; Landing (only one frame)
[Statedef 3036]
type = S
movetype = I
physics = S
ctrl = 0
VelSet = 0,0
anim = 3037
sprpriority = 2

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = 
time = 1
;ignorehitpause = 
;persistent = 



[State 3035, ChangeState]
type = ChangeState
triggerall = fvar(28)>=30 && fvar(28)<60|| fvar(27)=0
;triggerall = Root,var(40) = 0
triggerall = var(40) > 0
trigger1 = !Time
value = 3045


[State 3035, ChangeState]
type = ChangeState
triggerall = fvar(28)<30 || fvar(27)=0
;triggerall = var(40) = 0
trigger1 = !Time
value = 3037

;---------------------------------------------------------------------------
; Breathing
[Statedef 3037]
type = S
movetype = I
physics = S
ctrl = 0
anim = 3036
VelSet = 0,0
sprpriority = 2

;[State 3000, VarSet] ;put this in the final move
;type = VarSet
;triggerall = Var(40) > 0
;trigger1 = !Time
;var(40) = 0
;ignorehitpause = 1



[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = Animelem =11;!Time
var(40) = 0
[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = Animelem =11;!Time
fvar(27) = 0




[State 0, HitBy]
type = HitBy
trigger1 = 1
value = 
time = 1
;ignorehitpause = 
;persistent = 


[State 2004, Voice]
type = PlaySnd
trigger1 = AnimElemTime (4) = 0
value = s85,285;80,3005
volumescale = 150
channel = 0




[State 195, PosAdd 1]
type = PosAdd
trigger1 = AnimElem = 2
x = -7
[State 195, PosAdd 2]
type = PosAdd
trigger1 = AnimElem = 3
x = -2
[State 195, PosAdd 3]
type = PosAdd
trigger1 = AnimElem = 4
x = -8
[State 195, PosAdd 4]
type = PosAdd
trigger1 = AnimElem = 11
x = 8
[State 195, PosAdd 5]
type = PosAdd
trigger1 = AnimElem = 12
x = 2
[State 195, PosAdd 6]
type = PosAdd
trigger1 = AnimElem = 13
x = 7

[State 3037, PlaySnd] ;clones returning
type = PlaySnd
trigger1 = AnimElem = 10
value = S183,3
volumescale = 100 

[State 3037, PalFX]
type = PalFX
trigger1 = Time%3 = 0 && AnimElemTime(10) > 0 && AnimElemTime(10) <= 50
time = 2
add = 128,128,128





[State 3037, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1




;---------------------------------------------------------------------------
;1Getting up, then tired
[Statedef 3040]
type = S
movetype = H
physics = N
ctrl = 0
VelSet = 0,0
sprpriority = 2

[State 3040, HitBy]
type = HitBy
trigger1 = 1
value = 
time = 1
ignorehitpause = 1
;persistent = 


[State 3040, ChangeAnim]
type = ChangeAnim
trigger1 = Time = 0
value = IfElse(SelfAnimExist(5120),5120,12)
ignorehitpause = 1
persistent = 0





[State 3040, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 3041
ctrl = 0


;---------------------------------------------------------------------------
;2Getting up, then tired
[Statedef 3041]
type = A
movetype = H
physics = N
ctrl = 0
VelSet = 0,0
sprpriority = 2

[State 3041, ChangeAnim]
type = ChangeAnim
trigger1 = Time = 0
value = IfElse(SelfAnimExist(5300),5300,5000)
ignorehitpause = 1
persistent = 0






;---------------------------------------------------------------------------
; Preparing- Final Spike!!
[Statedef 3075]
type = S
movetype = A
physics = S
ctrl = 0
anim = 3075
VelSet = 0,0
sprpriority = 2




[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = nobardisplay
ignorehitpause = 1


[State 0, HitBy]
type = HitBy
trigger1 = 1
value = 
;value2 = S,NA
time = 1
;ignorehitpause = 
;persistent = 

;[State 0, AssertSpecial]
;type = AssertSpecial
;trigger1 = time < 2
;flag = invisible


[State 3037, PlaySnd] ;clones returning
type = PlaySnd
trigger1 = AnimElem = 3
value = S183,3
volumescale = 100 

[State 3037, PalFX]
type = PalFX
trigger1 = Time%3 = 0 && AnimElemTime(3) > 0
time = 2
add = 128,128,128


[State 3035, PosSet]
type = PosSet
trigger1 = !Time
x = cond(NumHelper(3020), helper(3020),pos x, pos x)
y = 0




[State 3035, ChangeState]
type = ChangeState
trigger1 = Time = 30
value = 3076
ctrl = 0






;---------------------------------------------------------------------------
; Jumping off-screen
[Statedef 3076]
type = A
movetype = A
physics = N
ctrl = 0
anim = 2501
VelSet = 0,0
sprpriority = 2




[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
var(40) = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = nobardisplay
ignorehitpause = 1

[State 2501, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
;ignorehitpause = 1

[State 2501, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1
ignorehitpause = 1


[State 2502, VelSet]
type = VelSet
trigger1 = animelemtime(3)>1;AnimElem = 3
x = 0;p2dist x/15
y = p2dist y/50
;ignorehitpause = 
;persistent = 



[State 55, Dash Effects]
type = Explod
trigger1 = animelemtime(3)=1
Anim = 8051
postype = P1
pos = 0,-20
bindtime = 15
sprpriority = 2
ownpal = 1
removetime = -2
removeongethit = 1


[State 55, Ground Effects]
type = Explod
trigger1 = AnimElemtime(3)=0
Anim = 17200
postype = P1
pos = 0,0
bindtime = 1
sprpriority = -4
ownpal = 1
removetime = -2
removeongethit = 1

[State 55, Ground Effects]
type = Explod
trigger1 = AnimElemtime(3)=0
Anim = 1207
postype = P1
pos = 20,0
bindtime = 1
sprpriority = 5
facing = -1
ownpal = 1
removetime = -2
removeongethit = 1
scale = 0.75,1
[State 55, Ground Effects]
type = Explod
trigger1 = AnimElemtime(3)=0
Anim = 1207
postype = P1
pos = -20,0
bindtime = 1
sprpriority = 5
ownpal = 1
removetime = -2
removeongethit = 1
scale = 0.75,1



[State 55, SND Super jump]
type = PlaySND
trigger1 = AnimElemtime(3)=1
value = 3000,10
persistent = 0



[State 2004, Voice]	;Tien: "Huu!"
type = PlaySnd
trigger1 = AnimElemtime(3)=1
value = 85,12;80,1058
volumescale = 150
channel = 0
persistent = 0





[State 55, Trail]
type = AfterImage
trigger1 = AnimElem = 3
time= 30
timegap= 1
framegap= 3
length= 12
palbright= 0,0,0
paladd= 0,0,0
palmul= .9,.9,.9
palcontrast= 120,120,120
palpostbright= 0,0,0
trans= add1







[State 2500, ChangeState]
type = ChangeState
trigger1 = Time = 90
value = 3077
ctrl = 0







;------------------------------------------------
; Dashing up
[StateDef 3077] ; various and dashing
type = A
movetype = A
physics = N
velset = 0,0
ctrl = 0
anim = 3077
sprpriority = 7




[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1


[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1

[State 3001, no shadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow



[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
var(40) = 0
[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
fvar(27) = 0
[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
fvar(28) = 0




[State 2501, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1
ignorehitpause = 1




[State 2502,  sound]
type = PlaySnd
trigger1 =  Time = 0
value = S6000,0
channel = 6
;ignorehitpause = 1








[State 2201, helper]; Background lines
type = Helper
trigger1 = !time
pos = -640, -480
postype = back
stateno = 2773
helpertype = normal
name = "vertical_lines_BG"
id = 2773
ownpal = 1
supermovetime = 150
pausemovetime = 150
sprpriority = 4
size.xscale = 5
size.yscale= 5





[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[state 2772, out of screen]
type = posset
trigger1 = !time
x = -100*facing
y = 300

[state 2772, dashing]
type = velset
trigger1 = time=30
y = -13

[state 2772, dashing]
type = velset
trigger1 = time=30
x = p2dist x/50	
y = -13

[State 55, SND Super jump]
type = PlaySND
trigger1 = time=30
value = 3000,11




;[State 2004, Voice]	;Tien: "You won't..."   
;type = PlaySnd
;trigger1 = time = 14
;value = 80,1056
;volumescale = 255
;channel = 0



[state 2772, dashing]
type = velset
trigger1 = p2dist y = [-10,10]
x = 0	
y = 0




[State 13100, End]
type = ChangeState
trigger1 = Time = 70
value = 3078
ctrl = 0





;---------------------------------------------------------------------------
; Final Spike!!
[Statedef 3078]
type    = A
movetype= A
physics = N
juggle  = 0
ctrl = 0
anim = 3061
sprpriority = -5
facep2 = 1




[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= nobardisplay
ignorehitpause 	= 1





[State 2501, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1
ignorehitpause = 1




[State 183, Full Screen effect]
type = Explod
trigger1 = MoveHit = 1
anim = 19900
ID = 184
pos = 0,0
postype = back
removetime = 16
scale = .84, 1.07
sprpriority = 5
bindtime = -1
ownpal = 1
removeongethit = 1
persistent = 0
ignorehitpause = 1




[State 3078, helper]; Background lines
type = Helper
trigger1 = MoveHit = 1
pos = -100,-240;-640, -480
postype = back
stateno = 2775
helpertype = normal
name = "Diagonal lines"
id = 2775
ownpal = 1
supermovetime = 150
pausemovetime = 150
sprpriority = 0
size.xscale = 1.2
size.yscale= 1.2
[State 3078, helper]; Background lines
type = Helper
trigger1 = MoveHit = 1
pos = 100,-240;-640, -480
postype = back
stateno = 2775
helpertype = normal
name = "Diagonal lines"
id = 2775
ownpal = 1
supermovetime = 150
pausemovetime = 150
sprpriority = 0
size.xscale = 1.2
size.yscale= 1.2
[State 3078, helper]; Background lines
type = Helper
trigger1 = MoveHit = 1
pos = 300,-240;-640, -480
postype = back
stateno = 2775
helpertype = normal
name = "Diagonal lines"
id = 2775
ownpal = 1
supermovetime = 150
pausemovetime = 150
sprpriority = 0
size.xscale = 1.2
size.yscale= 1.2





[State 2502,  sound]
type = PlaySnd
trigger1 =  MoveHit = 1
value = S6000,0
channel = 6
persistent = 0
ignorehitpause = 1
volumescale = 78

;[State 2502,  sound]
;type = null;PlaySnd
;trigger1 =  MoveHit
;value = S5, 12
;persistent = 0
;ignorehitpause = 1
;volumescale = 100

;[State 2502,  sound]
;type = PlaySnd
;trigger1 =  MoveHit
;value = S5, 7
;persistent = 0
;ignorehitpause = 1




[State 3078, Crashing into ground - sound 1]
type = PlaySnd
trigger1 = Enemy, StateNo = 3108
value = S15000,10
volumescale = 78
ignorehitpause = 1
persistent = 0
[State 3078, Crashing into ground - sound 2]
type = PlaySnd
trigger1 = Enemy, StateNo = 3108
value = S15000,11
volumescale = 78
ignorehitpause = 1
persistent = 0
[State 3078, Crashing into ground - sound 3]
type = PlaySnd
trigger1 = Enemy, StateNo = 3108
value = S15000,12
volumescale = 78
ignorehitpause = 1
persistent = 0





[State 2501, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = 
time = 1
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1
;persistent = 

[State 3013, VelSet]
type = VelSet
trigger1 = MoveHit = 1
x = -3;-15
y = -19.5
ignorehitpause = 1




[State 1015, 2]
type = PlaySND
trigger1 = AnimElemTime(5)=0
value = 0, 2







[State 2004, Voice]	;Tien: "Strike!"  
type = PlaySnd
trigger1 = AnimElemTime(3)=0
value = s85,1025
volumescale = 255
channel = 0





[State 1015, 3];Opponent in air sent to custom bounce state
type = HitDef
trigger1 = AnimElem = 6
trigger2 = AnimElem = 8 && !MoveContact
attr = A, HA
damage = 0,0
hitflag = MAF
guardflag = HA
animtype = Hard
priority = 4, Hit
pausetime = 15,16
guard.pausetime = 13,13
sparkno = s7040
guard.sparkno = s7000
sparkxy = -10,-40
hitsound   = s5,12;s3000,3
guardsound = S6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = -5
air.velocity = -1.5,5
envshake.time = 12
envshake.freq = 60
envshake.ampl = 3
airguard.cornerpush.veloff= 0
air.animtype = Back
fall.animtype = Back
getpower= 0,0;IfElse(p2movetype=H,40,140), 35
givepower = 0,0;35,35
yaccel = 0.5
fall = 1;(NumHelper(15999) || prevstateno=600 || prevstateno=630 || prevstateno=610 || prevstateno=640)
air.fall = 1
fall.recover = 0
id = 3078
p2facing = 1
kill = 0


[State 620, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget(3078)
trigger1 = !(target, ishelper)
value = 3106 ;651
ignorehitpause = 1
persistent = 0
id = 3078





[State 3078, Ground FX 2]
type = Helper
trigger1 = Enemy, StateNo = 3108
helpertype = normal
name = "Ground FX 2"
ID = 3086
stateno = 3085
pos = 0, 0
postype = p2  
facing = 1
keyctrl = 0
persistent = 0
ownpal = 1
size.xscale = 1;1.5
size.yscale = 1;1.5
supermovetime = 0
pausemovetime = 0
[State 3078, Ground FX 1]
type = Helper
trigger1 = Enemy, StateNo = 3108
helpertype = normal
name = "Ground FX 1"
ID = 3085
stateno = 3085
pos = 0,-15
postype = p2 
facing = -1
keyctrl = 0
persistent = 0
ownpal = 1
size.xscale = 1
size.yscale = 1;2
supermovetime = 0
pausemovetime = 0



[State 3078, EnvShake]
type       = EnvShake
trigger1   = P2StateNo = 3108
time       = 50
freq       = 250
ampl       = 10
persistent = 0


[State 3078, Debris Generator]
type = Helper
trigger1 = Enemy, StateNo = 3108
helpertype = normal
name = "Debris Generator"
ID = 66853
stateno = 66853
pos = 0,0
postype = p2    ;p2,front,back,left,right
facing = 1
keyctrl = 0
persistent = 0
ownpal = 1
size.xscale = .5
size.yscale = .5
supermovetime = 0
pausemovetime = 0




[State 806, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = P2StateNo = 3108
value = -1* Ceil(IfElse(fvar(11) * 210 < 70, 70, fvar(11) * 210))  ;-250
kill = 1
absolute = 0
ignorehitpause = 1
persistent = 0

[State 0, HitAdd]
type = HitAdd
trigger1 = P2StateNo = 3108
value = 1
ignorehitpause = 1
persistent = 0

[State 2402, Super BG Proj]
type = Projectile
;triggerall = RoundState != 2
;trigger1 = MoveHit = 1
trigger1 = RoundState != 2
ProjID = 3001	;Physical attack
projanim = 15999
projremovetime = 1
ignorehitpause=1



[State 1015, Land]
type = ChangeState
trigger1 = Time = 200
value = 3079
ctrl = 0





;------------------------------------------------
; Coming down
[StateDef 3079]
type = A
movetype = A
physics = N
velset = 0,0
ctrl = 0
anim = 44
sprpriority = 7




[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= nobardisplay
ignorehitpause 	= 1




[State 2501, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1
ignorehitpause = 1



[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[state 2772, out of screen]
type = posset
trigger1 = !time
x = -100*facing
y = -300

[state 2772, falling]
type = velset
trigger1 = time=35
y = 20


[State 2004, Voice]	
type = PlaySnd
trigger1 = Time = 15
value = 85,350;80,1059
volumescale = 150
channel = 0




[State 1015, 2]
type = PlaySND
trigger1 = Time = 25
value = 3000, 12






[State 13100, End]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 3080
ctrl = 0






;---------------------------------------------------------------------------
; Landing
[Statedef 3080]
type = S
movetype = A
physics = S
ctrl = 0
anim = 3080
VelSet = 0,0
sprpriority = 2




[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= nobardisplay
ignorehitpause 	= 1



[State 2501, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1
ignorehitpause = 1



[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
;ignorehitpause = 
;persistent = 

[State 1015, 2]
type = PlaySND
trigger1 = animelem = 4
value = 3000, 13





;[State 2004, Voice]	;Tien: "You'll never escape my eye!"
;type = PlaySnd
;trigger1 = animelem = 3
;value = 80,1059
;volumescale = 150
;channel = 0



[State 3000, VarSet]
type = VarSet
trigger1 = AnimElemTime(6) >= 0;!Time
var(40) = 0
ignorehitpause = 1


[State 3000, VarSet]
type = VarSet
trigger1 = AnimTime = 0
fvar(28) = 0
ignorehitpause = 1

;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
[State 0, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
trigger1 = AnimTime>0
id = 991901







[State 195, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1






;---------------------------------------------------------------------------
; VF-Custom state (up)1
[Statedef 3100]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
sprpriority = 1
facep2 = 1

[State 3013, VelSet]
type = VelSet
trigger1 = !Time
x = 0
y = -12
ignorehitpause = 1


[State 3013, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3100
elem = 1
ignorehitpause = 1
persistent = 0


[State 3013, Gravity]
type = VelAdd
trigger1 = Time >= 2
y = .5
ignorehitpause = 1


[State 3013, ChangeState]
type = SelfState
trigger1 = time >= 100
value = 5030
ctrl = 0

[State 2003, State End]
type = SelfState
triggerall = Time >= 2
trigger1 = Pos Y >= 0
value = 5110






;---------------------------------------------------------------------------
; VF-Custom state (up)2
[Statedef 3101]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
sprpriority = 1
facep2 = 1



[State 3013, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3100
elem = 1
ignorehitpause = 1
persistent = 0


[State 3013, VelSet]
type = VelSet
trigger1 = !Time
x = 0.8
y = -12
ignorehitpause = 1

[State 3013, Gravity]
type = VelAdd
trigger1 = Time >= 1
y = .5
ignorehitpause = 1


[State 3013, ChangeState]
type = SelfState
trigger1 = time >= 100
value = 5030
ctrl = 0

[State 2003, State End]
type = SelfState
triggerall = Time >= 1
trigger1 = Pos Y >= 0
value = 5110





;---------------------------------------------------------------------------
; VF-Custom state (down)3
[Statedef 3102]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
sprpriority = 1
;facep2 = 1



[State 3013, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3101
elem = 1
ignorehitpause = 1
persistent = 0


[State 3013, VelSet]
type = VelSet
trigger1 = !Time
x = -3
y = 9.5
ignorehitpause = 1

[State 3013, Gravity]
type = VelAdd
trigger1 = Time >= 1
y = .5
ignorehitpause = 1


[State 3013, ChangeState]
type = SelfState
trigger1 = time >= 100
value = 5030
ctrl = 0

[State 2003, State End]
type = SelfState
triggerall = Time >= 1
trigger1 = Pos Y >= 0
value = 5110




;---------------------------------------------------------------------------
; VF-Custom state (up)4
[Statedef 3103]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
sprpriority = 1
facep2 = 1



[State 3013, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3100
elem = 1
ignorehitpause = 1
persistent = 0


[State 3013, VelSet]
type = VelSet
trigger1 = !Time
x = 2
y = -10
ignorehitpause = 1

[State 3013, Gravity]
type = VelAdd
trigger1 = Time >= 1
y = .5
ignorehitpause = 1


[State 3013, ChangeState]
type = SelfState
trigger1 = time >= 100
value = 5030
ctrl = 0

[State 2003, State End]
type = SelfState
triggerall = Time >= 1
trigger1 = Pos Y >= 0
value = 5110










;---------------------------------------------------------------------------
; VF- CS - out of screen5
[Statedef 3104]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
sprpriority = 1
facep2 = 1
velset = 5, -25

[State 2501, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[State 3013, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3100
elem = 1
ignorehitpause = 1
persistent = 0


;[State 3013, VelSet]
;type = VelSet
;trigger1 = !Time
;x = 3
;y = -10
;ignorehitpause = 1
;
;[State 3013, Gravity]
;type = VelAdd
;trigger1 = Time >= 1
;y = .5
;ignorehitpause = 1


;[State 3013, ChangeState]
;type = SelfState
;trigger1 = time >= 100
;value = 5030
;ctrl = 0
;
;[State 2003, State End]
;type = SelfState
;triggerall = Time >= 1
;trigger1 = Pos Y >= 0
;value = 5110

[State 0, ChangeState]
type = ChangeState
trigger1 = Enemy, StateNo = 3077
value = 3105
ctrl = 0
;anim =
;ignorehitpause = 
;persistent = 



;------------------------------------
;P2 center of screen
[Statedef 3105]
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 2

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1

[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 0,0
value = 1

[State 3001, sprpriority]
trigger1 = time = 0
type = SprPriority
value = 2

[State 3001, anim2]
type = Changeanim2
trigger1 = time = 0
value = 3102
elem = 1
ignorehitpause = 1
persistent = 0

[State 3001, PosSet]
type = PosSet
trigger1 = 1
x = 0
y = -50

[State 3001, shake]
type = EnvShake
trigger1 = time = 0
time = 70
freq = 100
ampl = 3

;[State 3000, state] ;invisible
;type = ChangeAnim2
;trigger1 = P2StateNo = 2774
;value = 15999
;
;[State 3000, state] ;invisible
;type = ChangeState
;trigger1 = P2StateNo = 2775
;value = 2780




;---------------------------------------------------------------------------
; VF-Custom state (down)3
[Statedef 3106]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
sprpriority = 1
;facep2 = 1



[State 3031, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1



[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1



[State 3013, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3101
elem = 1
ignorehitpause = 1
persistent = 0

[State 3001, shake]
type = EnvShake
trigger1 = time = 0
time = 70
freq = 100
ampl = 3


[State 3013, VelSet]
type = VelSet
trigger1 = time >= 70
x = -3
y = 20
ignorehitpause = 1

;[State 3013, Gravity]
;type = VelAdd
;trigger1 = Time >= 1
;y = .5
;ignorehitpause = 1


[State 3013, ChangeState]
type = ChangeState
trigger1 = time >= 100
value = 3107
ctrl = 0




;
;[State 2003, State End]
;type = SelfState
;triggerall = Time >= 1
;trigger1 = Pos Y >= 0
;value = 5110


;---------------------------------------------------------------------------
; VF-Custom state (down)4
[Statedef 3107]
type    = A
movetype= H
physics = N
poweradd= 0
ctrl = 0
sprpriority = 1
;facep2 = 1


[State 3031, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1


[State 3001, shake]
type = EnvShake
trigger1 = time = 0
time = 0
freq = 0
ampl = 0



[State 3013, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3101
elem = 1
ignorehitpause = 1
persistent = 0



[State 3001, PosSet]
type = PosSet
trigger1 = Time=0
x = 50*facing
y = -500

[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 0,0
value = 1



[State 3013, VelSet]
type = VelSet
trigger1 = time = 100
x = -12
y = 20
ignorehitpause = 1



[State 3013, Gravity]
type = VelAdd
trigger1 = Time >= 100
y = .5
ignorehitpause = 1



[State 625, Land]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 3108





;---------------------------------------------------------------------------
; Downed get-hit (lying down)
[Statedef 3108]
type    = L
movetype= H
physics = N



[State 3031, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1




[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim2
trigger1 = time = 0
value = 3108


;[State 5110, 4]
;type = HitFallDamage
;trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0


[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0
x = 0


[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 14] ;Friction
type = VelSet
trigger1 = abs(Vel x) < Const(movement.down.friction.threshold)
persistent = 0
x = 0

[State 0, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
triggerall = Enemy, FVar(27) = 0
trigger1 = !Time
id = 991901


[State 2012, 12]
type = SelfState		;in case something happens, like Tien not hitting the enemy.
trigger1 = Time >= 225	;200	;150
value = IfElse(Alive,5120,5150)	;Alive = he gets up; dead = he lies down.






;---------------------------------------------------------------------------
; LVL 2 
; Preparing- Dodonpa
[Statedef 3200, Preparing]
type = S
movetype = A
physics = S
ctrl = 0
anim = 3200
VelSet = 0,0
sprpriority = 2

[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
var(40) = 0
[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
fvar(27) = 0
[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
fvar(28) = 0

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = nobardisplay
ignorehitpause = 1


[State 0, HitBy]
type = HitBy
trigger1 = 1
value = 
;value2 = S,NA
time = 1
;ignorehitpause = 
;persistent = 

;[State 0, AssertSpecial]
;type = AssertSpecial
;trigger1 = time < 2
;flag = invisible


[State 3037, PlaySnd] ;clones returning
type = PlaySnd
trigger1 = AnimElem = 1
value = S183,3
volumescale = 100 

[State 3037, PalFX]
type = PalFX
trigger1 = Time%3 = 0
time = 2
add = 128,128,128


[State 3035, PosSet]
type = PosSet
trigger1 = !Time
x = cond(NumHelper(3030), helper(3030),pos x, pos x)
y = 0




[State 3035, ChangeState]
type = ChangeState
trigger1 = Time = 30
value = 3201
ctrl = 0









;---------------------------------------------------------------------------
; LVL 2 
; Flying
[Statedef 3201, Flying]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3201
VelSet = 0,0
sprpriority = 2


[State 2200, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = AnimElem = 6
value = s3000,15;s2000,0
volumescale = 150
[State 2200, PlaySnd]	;Super activaction
type = PlaySnd
trigger1 = AnimElem = 6
value = s2200,11
volumescale = 65

[State 3037, PlaySnd] ;flying
type = PlaySnd
trigger1 = Time = 0
value = S100,0
volumescale = 100 

[State 2000, Voice]	;Tien: "Haaaaa!"
type = PlaySnd
trigger1 = AnimElemTime (4) = 0
value = 85,900;80,3000
volumescale = 100
channel = 0


[State 2000, Voice]	;Tien: "Dodon!" or "Dodompa!"
type = PlaySnd
trigger1 = Time = 100
value = 85,2200+random%6;80,3202
volumescale = 255
channel = 0



[State 3201, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[State 3201, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay



[State 3201, HitBy]
type = HitBy
trigger1 = 1
value = 
time = 1
ignorehitpause = 1
;persistent = 


[State 3201, PalFX]
type = PalFX
trigger1 = Time = 0
time = 0




[State 3201, 4]
type = VelSet
trigger1 = Time = 0
x = -2.25
y = -7.02	

[State 3201, VelAdd]
type = VelAdd
trigger1 = Time > 0 && Time < 5
x = .10
y = .40
[State 3201, VelAdd]
type = VelAdd
trigger1 = Time > 5 && Time < 10
x = .09
y = .35
[State 3201, VelAdd]
type = VelAdd
trigger1 = Time > 10 && Time < 20
x = .08
y = .30
[State 3201, VelAdd]
type = VelAdd
trigger1 = Time > 20 && Time < 40
y = .20


[State 3201, Stop movement]
type = VelSet
trigger1 = Time =40
x = 0
y = 0


[State 3201, Dodonpa orb]
type = Explod
trigger1 = AnimElem = 6
anim = 3220
ID = 3201
pos = -46,-137
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
pausemovetime = 9999999999
scale = 1,1
sprpriority = -5
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermove = 1
pausemove = 1
persistent = 0





[State 3201, PosFreeze]
type = PosFreeze
trigger1 = Time >=40
value = 1



[State 3201, ChangeState]
type = ChangeState
trigger1 = Time = 100
value = 3202
ctrl = 0



;---------------------------------------------------------------------------
; LVL 2
; Shooting
[Statedef 3202, Shooting]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3202
VelSet = 0,0
sprpriority = 2

[State 3202, RemoveExplod]
type = RemoveExplod
trigger1 = !Time
id = 3201


[State 3202, Dodonpa orb 1st pose]
type = Explod
trigger1 = AnimElem = 8
anim = 3227
ID = 3202
pos = -34,-127
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = 5
pausemovetime = 9999999999
scale = 1,1
sprpriority = -5
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermove = 1
pausemove = 1

[State 3202, Dodonpa orb 2nd pose]
type = Explod
trigger1 = AnimElem = 15
anim = 3227
ID = 3202
pos = -46,-137
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = 5
pausemovetime = 9999999999
scale = 1,1
sprpriority = -5
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermove = 1
pausemove = 1



[State 3202, Dodonpa blur effect 1]
type = Explod
trigger1 = AnimElem = 1
trigger2 = AnimElem = 9
trigger3 = AnimElem = 16
anim = 3221
ID = 3202
pos = 27,-144
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 9999999999
scale = 1,1
sprpriority = -5
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermove = 1
pausemove = 1

[State 3202, Dodonpa blur effect 2]
type = Explod
trigger1 = AnimElem = 2
trigger2 = AnimElem = 10
trigger3 = AnimElem = 17
anim = 3222
ID = 3202
pos = 58,-51
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 9999999999
scale = 1,1
sprpriority = -5
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermove = 1
pausemove = 1







[State 3037, PlaySnd] ;Dodonpa
type = PlaySnd
trigger1 = AnimElem = 3
trigger2 = AnimElem = 11
trigger3 = AnimElem = 18
value = S2200,10
volumescale = 100 


[State 2000, Voice]	;Tien: "Take this"
type = PlaySnd
trigger1 = AnimElem = 18
value = 80,3201
volumescale = 255
channel = 0




[State 3202, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1



[State 3202, Dodonpa helper]
type = Helper
trigger1 = AnimElem = 3
trigger2 = AnimElem = 11
trigger3 = AnimElem = 18
helpertype = normal
stateno = 3223
ID = 3223
name = "Dodonpa - Finisher"
postype = p1
pos = 0,0;0,0	;BindToParent in Helper.cns
ownpal = 1
sprpriority = 5



[State 3202, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay



[State 3202, PosFreeze]
type = PosFreeze
trigger1 = Time >=40
value = 1


[State 3202, ChangeState]
type = ChangeState
trigger1 = Time = 115
value = 3203
ctrl = 0




;---------------------------------------------------------------------------
; LVL 2
; Charge for the last
[Statedef 3203, Charge]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3203
VelSet = 0,0
sprpriority = 2


[State 2000, Voice]	;Tien: "Like one!"
type = PlaySnd
trigger1 = !Time
value = 85,380+random%2;80,2801
volumescale = 255
channel = 0




[State 3201, Explod]
type = Explod
trigger1 = AnimElem = 3
anim = 3220
ID = 3203
pos = -46,-137
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
pausemovetime = 9999999999
scale = 1,1
sprpriority = -5
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermove = 1
pausemove = 1
persistent = 0

[State 3201, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[State 3201, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay

[State 3201, PosFreeze]
type = PosFreeze
trigger1 = Time >=40
value = 1



[State 3202, ChangeState]
type = ChangeState
trigger1 = Time = 70
value = 3204
ctrl = 0






;---------------------------------------------------------------------------
; LVL 2
; Shooting
[Statedef 3204, Shooting last]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3204
VelSet = 0,0
sprpriority = 2

[State 3204, RemoveExplod]
type = RemoveExplod
trigger1 = !Time
id = 3203

[State 2000, Voice]	;Tien: "DODON PAAA!"
type = PlaySnd
trigger1 = AnimElem = 3
value = s85,3200;80,3203
volumescale = 255
channel = 0


;[State 3037, PlaySnd] ;Dodonpa
;type = PlaySnd
;trigger1 = AnimElem = 3
;value = S2200,20
;volumescale = 100 



[State 3204, Dodonpa blur effect 1]
type = Explod
trigger1 = AnimElem = 1
anim = 3221
ID = 3204
pos = 27,-144
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 9999999999
scale = 1,1
sprpriority = -5
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermove = 1
pausemove = 1

[State 3202, Dodonpa blur effect 2]
type = Explod
trigger1 = AnimElem = 2
anim = 3222
ID = 3204
pos = 58,-51
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 9999999999
scale = 1,1
sprpriority = -5
ownpal = 1
removeongethit = 1
ignorehitpause = 1
supermove = 1
pausemove = 1







[State 3202, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1



[State 3202, Dodonpa helper]
type = Helper
trigger1 = AnimElem = 3
helpertype = normal
stateno = 3228
ID = 3223
name = "Dodonpa - Finisher"
postype = p1
pos = 0,0;0,0	;BindToParent in Helper.cns
ownpal = 1
sprpriority = 5



[State 3202, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay




[State 0, Gravity]
type = VelAdd
trigger1 = AnimElemTime(5) >= 0
y = 0.5
ignorehitpause = 1



[State 2012, 12]
type = ChangeState
trigger1 = Pos y >= -5
value = 3205
ctrl = 0


;---------------------------------------------------------------------------
; LVL 2
[Statedef 3205, Landing, pose]
type = S
movetype = I
physics = S
ctrl = 0
anim = 3205
VelSet = 0,0
sprpriority = 2



[State 3202, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay



[State 3205, PosSet]
type = PosSet
trigger1 = 1
y = 0
;ignorehitpause = 
;persistent = 


[State 3205, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
[State 3205, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
trigger1 = AnimTime>0
id = 991901


[State 3205, PosAdd 1]
type = PosAdd
trigger1 = AnimElem = 5
x = -30
[State 3205, PosAdd 2]
type = PosAdd
trigger1 = AnimElem = 10
x = 23
[State 3205, PosAdd 3]
type = PosAdd
trigger1 = AnimTime = 0
x = 7


[State 2000, Voice]	;Tien: "Atone."
type = PlaySnd
trigger1 =  AnimElemTime(7) = 0
value = 85,290;80,3205
volumescale = 255
channel = 0



[State 3205, Swing sound]
type = PlaySnd
trigger1 = AnimElem = 5
value = 3000,13

[State 3205, PlaySnd] ;clone returning
type = PlaySnd
trigger1 = AnimElemTime(8) = 0
value = S183,3
volumescale = 100 

[State 3205, PalFX]
type = PalFX
trigger1 = Time%3 = 0 && AnimElemTime(8) > 0 && AnimElemTime(9) <= 0
time = 2
add = 128,128,128






[State 3205, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1





;---------------------------------------------------------------------------
; Downed get-hit (lying down)
[Statedef 3250]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0


[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14] ;Friction
type = VelSet
trigger1 = abs(Vel x) < Const(movement.down.friction.threshold)
persistent = 0
x = 0


[State 0, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
triggerall = Enemy, FVar(27) = 0
trigger1 = !Time
id = 991901


;[State 2012, 12]
;type = ChangeState		;in case something happens, like Tien not hitting the enemy.
;;triggerall = Enemy, Var(40) > 0 ;OLD, NOT USED
;triggerall = Enemy, FVar(28) >= 30 ;&& Enemy, FVar(28) < 60
;trigger1 = Time >= 25	;100	;150
;value = 3040
;ctrl = 0

[State 2012, 12]
type = SelfState		;in case something happens, like Tien not hitting the enemy.
trigger1 = Time >= 500	;150
value = IfElse(Alive,5120,5150)	;Alive = he gets up; dead = he lies down.








;---------------------------------------------------------------------------
; Downed get-hit (bouncing)
[Statedef 3251]
type    = A
movetype= H
physics = N

[State 5110, 5]
type = PosSet
trigger1 = Time <1
y = 0

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 3251, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3251
ignorehitpause = 1
persistent = 0


[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0




[State 0, VelSet]
type = VelSet
trigger1 = Time = 1
y = -6.5
ignorehitpause = 1
;persistent = 

[State 0, Gravity]
type = VelAdd
trigger1 = Time >= 2
y = 0.70
ignorehitpause = 1



[State 0, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
triggerall = Enemy, FVar(27) = 0
trigger1 = !Time
id = 991901


[State 2012, 12]
type = ChangeState
trigger1 = Pos y > 0
triggerall = Time >= 10
value = 3250
ctrl = 0








;---------------------------------------------------------------------------
; Downed get-hit (bouncing)
[Statedef 3252]
type    = A
movetype= H
physics = N

[State 5110, 5]
type = PosSet
trigger1 = Time <1
y = 0

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 3251, ChangeAnim]
type = ChangeAnim2
trigger1 = !Time
value = 3252
ignorehitpause = 1
persistent = 0


[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0




[State 0, VelSet]
type = VelSet
trigger1 = Time = 1
y = -15
ignorehitpause = 1
;persistent = 

[State 0, Gravity]
type = VelAdd
trigger1 = Time >= 2
y = 0.5
ignorehitpause = 1



[State 0, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
triggerall = Enemy, FVar(27) = 0
trigger1 = !Time
id = 991901


[State 2012, 12]
type = ChangeState
trigger1 = Pos y > 0
triggerall = Time >= 10
value = 3253
ctrl = 0








;---------------------------------------------------------------------------
; Downed get-hit (hit ground from fall)
[Statedef 3253]
type    = L
movetype= H
physics = N


[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0


[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 3254 ;Downed get-hit (bounce off ground)



;---------------------------------------------------------------------------
; Downed get-hit (bounce off ground)
[Statedef 3254]
type    = L
movetype= H
physics = N

[State 5101, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160

[State 5101, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160 + (anim % 10)

[State 5101, 3]
type = HitFallVel
trigger1 = Time = 0

[State 5101, 4]
type = PosSet
trigger1 = Time = 0
y = Const(movement.down.bounce.offset.y)

[State 5101, 5]
type = PosAdd
trigger1 = Time = 0
x = Const(movement.down.bounce.offset.x)

[State 5101, 6] ;Acceleration
type = VelAdd
trigger1 = 1
y = Const(movement.down.bounce.yaccel)

[State 5101, 7] ;Hit ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= Const(movement.down.bounce.groundlevel)
value = 3255











;---------------------------------------------------------------------------
; Downed get-hit (lying down)
[Statedef 3255]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0


[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0




[State 0, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
triggerall = Enemy, FVar(27) = 0
trigger1 = !Time
id = 991901



[State 2012, 12]
type = SelfState		;in case something happens, like Tien not hitting the enemy.
trigger1 = Time >= 150
value = IfElse(Alive,5120,5150)	;Alive = he gets up; dead = he lies down.


















;---------------------------------------------------------------------------
; LVL 3
[Statedef 3400, Landing]
type = S
movetype = I
physics = S
ctrl = 0
anim = 3035
VelSet = 0,0
sprpriority = 2

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = 
;value2 = S,NA
time = 1
;ignorehitpause = 
;persistent = 



[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time < 1
flag = invisible

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State -3, Land FX]
type = Helper
trigger1 = Time = 1
name = "LandFX"
helpertype = normal
StateNo = 17100
id = 17100
postype = P1
ownpal = 1
keyctrl = 0
supermovetime = 99999
pausemovetime = 99999





[State 3035, PosSet]
type = PosSet
trigger1 = !Time
x = cond(NumHelper(3030), helper(3030),pos x, pos x)
y = 0




[State 3035, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 3401
ctrl = 1

;---------------------------------------------------------------------------
; LVL 3 
[Statedef 3401, one frame]
type = S
movetype = A
physics = S
ctrl = 0
VelSet = 0,0
anim = 3037
sprpriority = 2

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = 
time = 1
;ignorehitpause = 
;persistent = 





[State 3035, ChangeState]
type = ChangeState
trigger1 = Time = 1
value = 3402



;---------------------------------------------------------------------------
; LVL 3
[Statedef 3402, Floating]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3400
VelSet = 0,0
sprpriority = 2

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay



[State 3205, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
var(40) = 0
[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
fvar(27) = 0



[State 0, VelSet]
type = VelSet
trigger1 = AnimElemtime(3) = 1
y = -15


[State 0, VelMul]
type = VelMul
trigger1 = Time >=8 && Time <40
y = 0.40
;ignorehitpause = 
;persistent = 

[State 0, VelAdd]
type = VelAdd
trigger1 = Time >=40
y = -0.15
;ignorehitpause = 
;persistent = 







[State 0, HitBy]
type = HitBy
trigger1 = 1
value = 
time = 1
;ignorehitpause = 
;persistent = 







[State 3037, PlaySnd] ;clones returning
type = PlaySnd
trigger1 = AnimElem = 3
value = S183,3
volumescale = 100



[State 3037, PlaySnd] ;Levitation
type = PlaySnd
trigger1 = AnimElem = 3
value = S41,0
volumescale = 100 

[State 3037, PlaySnd] ;flying upward
type = PlaySnd
trigger1 = AnimElem = 4
value = S3000,32
volumescale = 100 



[state 1300, Dust]
type = Explod
trigger1 = animelemtime(3)=0
anim = 1216
id = 1216
pos = 30,4
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
[state 1300, Dust]
type = Explod
trigger1 = animelemtime(3)=0
anim = 1216
id = 1216
pos = -30,4
facing = -1
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1



[State 3037, PalFX]
type = PalFX
trigger1 = Time%3 = 0 && AnimElemTime(3) > 0 && AnimElemTime(4) <= 0
time = 2
add = 128,128,128


[State 3035, ChangeState]
type = ChangeState
trigger1 = Time = 175
value = 3403





;---------------------------------------------------------------------------
; LVL 3
[Statedef 3403, Hands (zoom)]
type = A
movetype = A
physics = N
ctrl = 0
anim = 15999
VelSet = 0,0
sprpriority = 2
;facep2 = 1


[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay
flag3		= Invisible

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= time>0
ignorehitpause	= 1
persistent	= 1
flag 		= NoFG
flag2 		= NoBG
flag3 		= GlobalNoShadow


[State 0, PosSet]
type = PosSet
trigger1 = 1
;x = -30*facing
y = -9999




[State 2201, Hand]
type = Helper
trigger1 = time = 1
helpertype = normal
stateno = 3415
name = "Hand - Left"
postype = Left
pos = -320,-214;0,0	;Helper.cns
ownpal = 0
sprpriority = 5

[State 2201, Hand]
type = Helper
trigger1 = time = 1
helpertype = normal
stateno = 3416
name = "Hand - Right"
postype = Right
pos = 320,-214;0,0	;Helper.cns
ownpal = 0
sprpriority = 5









[State 3037, PlaySnd (zoom)] ;Zoom
type = PlaySnd
trigger1 = time = 70 || time = 140 || time = 200
value = S3000,30
volumescale = 100 
[State 3037, PlaySnd (zoom)] ;Zoom
type = PlaySnd
trigger1 = time = 70 || time = 140 || time = 200
value = S3000,34
volumescale = 50 

;[state 1300, White (zoom)]
;type = Explod
;trigger1 = time = 70 || time = 140 || time = 200
;anim = 19877;957
;scale = 9999,9999
;pos = 0,0;-160,-120
;postype = P2
;sprpriority = 1
;ownpal = 1
;removetime = 2;3
;ignorehitpause = 1



[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = Time = 1
fvar(28) = 0



[State 3205, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1


[State 3035, ChangeState]
type = ChangeState
trigger1 = Time = 240
value = 3404




;---------------------------------------------------------------------------
; LVL 3
[Statedef 3404, Hands]
type = A
movetype = A
physics = N
ctrl = 0
anim = 15999
VelSet = 0,0
sprpriority = 2
;facep2 = 1


[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay
flag3		= Invisible

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag 		= NoFG
flag2 		= NoBG
flag3 		= GlobalNoShadow


[State 3205, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1



[state 1300, Hands];P1
type = Explod
triggerall = facing = 1
trigger1 = time = 0
anim = 3403
id = 3404
scale = 1,1
pos = 160,0;-214
postype = left
sprpriority = 1
facing = -1
ownpal = 0
removetime = -2
ignorehitpause = 1

[state 1300, Hands];P2
type = Explod
triggerall = facing = -1
trigger1 = time = 0
anim = 3403
id = 3404
scale = 1,1
pos = 160,0;-214
postype = left
sprpriority = 1
ownpal = 0
removetime = -2
ignorehitpause = 1

;[State 1005, PlaySND]
;type = PlaySND
;trigger1 = Time = 0
;value = 0, 2
;[State 1005, PlaySND]
;type = PlaySND
;trigger1 = Time = 0
;value = 40, 1

[State 1005, PlaySND]
type = PlaySND
trigger1 = Time = 0
value = 3000, 40



[State 3035, ChangeState]
type = ChangeState
trigger1 = !numExplod(3404)
value = 3405

;---------------------------------------------------------------------------
; LVL 3
[Statedef 3405, Preparing]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3404
VelSet = 0,0
sprpriority = 3
;facep2 = 1

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay
flag3		= invisible

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag 		= NoFG
flag2 		= NoBG
flag3 		= GlobalNoShadow


[State 3205, ScreenBound]
type		= ScreenBound
trigger1		= 1
value		= 1
movecamera	= 0,0
ignorehitpause	= 1


[State 2201, Tien];P1
type = Helper
triggerall = facing = 1
trigger1 = time = 0
helpertype = normal
stateno = 3420
ID = 3420
name = "Tien"
postype = Left
pos = 0,0	;Helper.cns
facing = -1
ownpal = 0
sprpriority = 5


[State 2201, Tien];P2
type = Helper
triggerall = facing = -1
trigger1 = time = 0
helpertype = normal
stateno = 3420
ID = 3420
name = "Tien"
postype = Left
pos = 0,0	;Helper.cns
facing = 1
ownpal = 0
sprpriority = 5









;[State 0, PosSet]
;type = PosSet
;trigger1 = !Time
;x = 145*facing
;y = 6
;
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 3
;x = -24
;y = -61
;
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 4
;x = -21
;y = -39
;
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 5
;x = -25
;y = -19
;
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 6
;x = -30
;y = -4
;
;[State 3416, VelSet]
;type = VelSet
;trigger1 = animelemtime(6)>=0 && Pos x != 0
;x = (p2Dist X)/12
;ignorehitpause = 1
;
;[State 3416, VelSet]
;type = VelSet
;trigger1 = animelemtime(6)>=0 && animelemtime(7)<0
;y = -0.7
;ignorehitpause = 1
;
;
;[State 3416, VelSet]
;type = VelSet
;trigger1 = Pos x = 0 
;x = 0
;ignorehitpause = 1
;
;[State 3416, VelMul]
;type = VelMul
;trigger1 = animelemtime(7)>0
;y = 0.95
;ignorehitpause = 1



[State 3035, ChangeState]
type = ChangeState
trigger1 = time=233;NumHelper(3420)=0
value = 3406



;---------------------------------------------------------------------------
; LVL 3
[Statedef 3406, Invisible Tien]
type = A
movetype = A
physics = N
ctrl = 0
;anim = 3404
VelSet = 0,0
sprpriority = 3
;facep2 = 1



[state 3406, Kikoho BG 1 - behind the enemy - light before the attack]
type		= Explod
trigger1		= P2StateNo = 3452
anim		= 3408
id		= 34079
scale		= 1,9999
pos		= 0,0
postype		= p2
sprpriority	= 0
ownpal		= 1
removetime	= -1
supermovetime	= 99999
Pausemovetime	= 99999
ignorehitpause	= 1
persistent	= 0

[State 3406, RemoveExplod]
type     = RemoveExplod
trigger1 = P2StateNo = 3453
id       = 34079



[state 3406, Kikoho BG 1 - behind the enemy]
type		= Explod
trigger1		= P2StateNo = 3453
anim		= 3407
id		= 3407
scale		= 1,9999
pos		= 0,0
postype		= p2
sprpriority	= 0
ownpal		= 1
removetime	= -1
supermovetime	= 99999
Pausemovetime	= 99999
ignorehitpause	= 1
persistent	= 0

[state 3406, Kikoho BG 2 - over the enemy]
type		= Explod
trigger1		= P2StateNo = 3453 && Enemy,Time = 100	;1;180
anim		= 3408
id		= 3407
scale		= 1,9999
pos		= 0,0
postype		= p2
sprpriority	= 3
ownpal		= 1
removetime	= -1
supermovetime	= 99999
Pausemovetime	= 99999
;ignorehitpause	= 1
;persistent	= 0

[state 3406, Kikoho BG 3 - black lines 1]
type		= Explod
trigger1		= P2StateNo = 3453 && Enemy,Time = 1
trigger2		= P2StateNo = 3453 && Enemy,Time = 50
trigger3		= P2StateNo = 3453 && Enemy,Time = 110
trigger4		= P2StateNo = 3453 && Enemy,Time = 160
trigger5		= P2StateNo = 3453 && Enemy,Time = 230
;trigger6		= P2StateNo = 3453 && Enemy,Time = 270
anim		= 3411
id		= 3407
scale		= 2,1
pos		= 0,-200
postype		= p2
sprpriority	= 2
ownpal		= 1
removetime	= -2
supermovetime	= 99999
Pausemovetime	= 99999
;ignorehitpause	= 1
;persistent	= 0

[state 3406, Kikoho BG 4 - black lines 2]
type		= Explod
trigger1		= P2StateNo = 3453 && Enemy,Time = 1
trigger2		= P2StateNo = 3453 && Enemy,Time = 50
trigger3		= P2StateNo = 3453 && Enemy,Time = 110
trigger4		= P2StateNo = 3453 && Enemy,Time = 160
trigger5		= P2StateNo = 3453 && Enemy,Time = 230
;trigger6		= P2StateNo = 3453 && Enemy,Time = 270
anim		= 3411
id		= 3407
scale		= 1.5,1
pos		= 0,-220
facing		= -1
postype		= P2
sprpriority	= 2
ownpal		= 1
removetime	= -2
supermovetime	= 99999
Pausemovetime	= 99999
;ignorehitpause	= 1
;persistent	= 0






[State 3406, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay
flag3		= invisible

[State 3406, AssertSpecial]
type		= AssertSpecial
trigger1		= P2StateNo = 3453
ignorehitpause	= 1
persistent	= 1
flag 		= NoFG
flag2 		= NoBG
flag3 		= GlobalNoShadow

;[State 3406, AssertSpecial]
;type		= AssertSpecial
;trigger1		= 1
;ignorehitpause	= 1
;persistent	= 1
;flag 		= NoFG
;flag2 		= NoBG
;flag3 		= GlobalNoShadow


[State 3406, ScreenBound]
type		= ScreenBound
trigger1		= 1
value		= 1
movecamera	= 0,0
ignorehitpause	= 1

[State 3406, EnvShake]
type		= EnvShake
trigger1		= Time < 20
time		= 20
freq		= 0
ampl		= 0


[State 3406, PlaySND];Kikoho is coming
type	= PlaySND
trigger1	= Time = 0
value	= 3000, 42
channel	= 18


[State 3406, PlaySND];Kikoho blast (first)
type		= PlaySND
trigger1		= P2StateNo = 3453
value		= 3000, 37
persistent	= 0
channel		= 18
[State 3406, PlaySND];Kikoho blast (others)
type		= PlaySND		;triggers were only time = 110 and 180
trigger1		= P2StateNo = 3453 && Enemy,Time = 50
trigger2		= P2StateNo = 3453 && Enemy,Time = 110
trigger3		= P2StateNo = 3453 && Enemy,Time = 160
trigger4		= P2StateNo = 3453 && Enemy,Time = 230
;trigger5		= P2StateNo = 3453 && Enemy,Time = 270
value		= 3000, 37
channel		= 18


[State 3406, PlaySND];Ground
type	= PlaySND
trigger1	= Win
value	= 3000, 50
persistent = 0






;[State 3406, TargetLifeAdd]
;type = TargetLifeAdd
;trigger1 = P2StateNo = 3453
;value = -1* Ceil(IfElse(fvar(11) * 210 < 70, 70, fvar(11) * 210))  ;-250
;kill = 1
;absolute = 0
;ignorehitpause = 1
;persistent = 0

[State 3406, HitAdd]
type	= HitAdd
trigger1	= P2StateNo = 3453
value	= 1
persistent= 0
[State 3406, HitAdd]
type	= HitAdd
trigger1	= P2StateNo = 3453 && Enemy,Time = 50
trigger2	= P2StateNo = 3453 && Enemy,Time = 110
trigger3	= P2StateNo = 3453 && Enemy,Time = 160
trigger4	= P2StateNo = 3453 && Enemy,Time = 230
;trigger5	= P2StateNo = 3453 && Enemy,Time = 270
value	= 1


;[State 3406, Super BG Proj]
;type = Projectile
;trigger1 = RoundState = 2
;ProjID = 3000	;Ki attack
;projanim = 15999
;projremovetime = 1
;ignorehitpause=1

[State 3406, EnvShake]
type		= EnvShake
triggerall	= P2StateNo = 3452
trigger1		= !(time%4)
time		= 4
freq		= 80
ampl		= 1+0.01*time


[State 3406, shake]
type		= EnvShake
triggerall	= P2StateNo = 3453 && Enemy,Time <= 300
trigger1		= !(time%4)
time		= 4
freq		= 80
ampl		= 1+0.07*time




[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= Win
ignorehitpause	= 1
persistent	= 1
flag		= NoMusic



[State 3406, ChangeState]
type	= ChangeState
trigger1	= enemy, stateno = 3454 && !Win
value	= 3407


[State 3406, ChangeState];Win
type	= ChangeState
trigger1	= enemy, stateno = 3454 && Win
value	= 3410


;---------------------------------------------------------------------------
; LVL 3
[Statedef 3407, Kikoho - flying]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3400
VelSet = 0,0
sprpriority = 3
;facep2 = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id = 3407

[state 1300, Kikoho]
type = Explod
trigger1 = !Time
anim = 3409
scale = 1,9999
pos = 0,0
postype = Left
sprpriority = 4
ownpal = 1
removetime = -2
ignorehitpause = 1
persistent = 0


[State 1005, PlaySND]
type	= PlaySND
trigger1	= !Time
value	= 3000, 32



[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay


[State 3205, ScreenBound]
type		= ScreenBound
trigger1		= 1
value		= 1
movecamera	= 0,0
ignorehitpause	= 1


[State 0, PosSet]
type = PosSet
trigger1 = !time
y = -1600

[State 0, PosSet]
type = PosAdd
trigger1 = !time
x = -10

[State 0, VelSet]
type = VelSet
trigger1 = !Time
y = 8

[State 0, Gravity]
type = VelAdd
trigger1 = AnimElemTime(4) >= 0
y = 0.1
ignorehitpause = 1
persistent = 0

[State 0, VelMul]
type = VelMul
trigger1 = Pos y > -25
y = 0.6
;ignorehitpause = 
;persistent = 




[State 2012, 12]
type = ChangeState
trigger1 = Pos y >= -5
value = 3408
ctrl = 0

;---------------------------------------------------------------------------
; LVL 3
[Statedef 3408, Kikoho - land]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3410
VelSet = 0,0
sprpriority = 3
;facep2 = 1

[State 0, PosSet]
type = PosSet
trigger1 = !Time
y = 0
;ignorehitpause = 
;persistent = 


;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
[State 3205, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
trigger1 = AnimTime>0
id = 991901

[State 1005, PlaySND]
type		= PlaySND
trigger1		= !Time
value		= 40, 0

[State -3, Land FX]
type = Helper
trigger1 = Time = 0
name = "LandFX"
helpertype = normal
StateNo = 17100
id = 17100
postype = P1
ownpal = 1
keyctrl = 0
supermovetime = 99999
pausemovetime = 99999

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay

[State 2012, 12]
type = ChangeState
trigger1 = !Animtime
value = 0
ctrl = 1





;---------------------------------------------------------------------------
; LVL 3
[Statedef 3410, WIN Kikoho - flying]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3400
VelSet = 0,0
sprpriority = 3
;facep2 = 1

[State 3410, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id = 3407

[state 3410, Kikoho]
type = Explod
trigger1 = !Time
anim = 3409
scale = 1,9999
pos = 0,0
postype = Left
sprpriority = 4
ownpal = 1
removetime = -2
ignorehitpause = 1
persistent = 0
supermovetime = 99999
supermove = 1
Pausemovetime = 99999


[state 3410, BG - Ground]
type = Explod
trigger1 = !Time
anim = 3414
scale = 1,1
pos = 0,0
postype = Left
sprpriority = -5
ownpal = 1
removetime = -1
supermovetime = 99999
supermove = 1
Pausemovetime = 99999

[state 3410, BG - Sky]
type = Explod
trigger1 = !Time
anim = 3413
scale = 1,1
pos = 0,0
postype = Left
sprpriority = -5
ownpal = 1
removetime = -1
supermovetime = 99999
supermove = 1
Pausemovetime = 99999


[State 3410, PlaySND]
type		= PlaySND
trigger1		= !Time
value		= 3000, 32

[State 3410, PlaySND];Sound from Majin Vegeta Aftermath
type		= PlaySND
trigger1		= Time = 50
value		= 3000, 51
volumescale	= 175

[State 3410, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze
flag2		= NoBarDisplay

[State 3410, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag 		= NoFG
flag2 		= NoBG
flag3 		= GlobalNoShadow

[State 3410, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= NoMusic


[State 3410, ScreenBound]
type		= ScreenBound
trigger1		= 1
value		= 1
movecamera	= 0,0
ignorehitpause	= 1


[State 3410, PosSet]
type = PosSet
trigger1 = !time
y = -1600

[State 3410, PosSet]
type = PosAdd
trigger1 = !time
x = -10

[State 3410, VelSet]
type = VelSet
trigger1 = !Time
y = 8

[State 3410, Gravity]
type = VelAdd
trigger1 = AnimElemTime(4) >= 0
y = 0.1
ignorehitpause = 1
persistent = 0

[State 3410, VelMul]
type = VelMul
trigger1 = Pos y > -25
y = 0.6
;ignorehitpause = 
;persistent = 


;[State 0, SuperPause]
;type = SuperPause
;trigger1 = 1
;time = 99999
;movetime = 99999
;anim = -1
;sound = -1
;pos = 0,0
;movetime = 0
;darken = 0
;poweradd = 0
;unhittable = 1


[State 2012, 12]
type = ChangeState
trigger1 = Pos y >= -15;-5
value = 3411
ctrl = 0


;---------------------------------------------------------------------------
; Win by Kikoho
[Statedef 3411]
type = S
velset = 0,0

;ctrl = 0     
;If it's 0 it won't work normally, if it's 1 you can move around.
;If it's commented it works as intended.
;What the heck?
;Mugen problems!



;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
;CODE FOR CINEMATIC 
[State 3411, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
trigger1 = AnimTime>0
id = 991901


[State 3411, ScreenBound]
type		= ScreenBound
trigger1		= 1
value		= 1
movecamera	= 0,0
ignorehitpause	= 1


[State 3411, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= NoBarDisplay

[State 3406, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag 		= NoFG
flag2 		= NoBG
flag3 		= GlobalNoShadow

[State 3410, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= NoMusic


[State 3412, ScreenBound]
type		= ScreenBound
trigger1		= 1
value		= 1
movecamera	= 0,0
ignorehitpause	= 1



[State 3412, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && PrevStateNo = 3410
value = 3415


[State 30000, Stand Hover]	;copied from Jailbot by altoiddealer and edited a bit. ;)
type = Offset
trigger1 = animelemtime(5)>=0
y = 4*cos(GameTime/24.0)







[State 4501, Changestate]
type     = Changestate
trigger1 = PrevStateNo = 3410; && AnimTime = 0
value    = 180
ctrl     = 1


[State 4501, AssertSpecial]
type = AssertSpecial
trigger1 = Time <= 450
flag = RoundNotOver








;---------------------------------------------------------------------------
; Downed get-hit (lying down)
[Statedef 3450]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0


[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0




[State 0, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
triggerall = Enemy, FVar(27) = 0
trigger1 = !Time
id = 991901



[State 2012, 12]
type = SelfState		;in case something happens, like Tien not hitting the enemy.
trigger1 = Time >= 250;150
value = IfElse(Alive,5120,5150)	;Alive = he gets up; dead = he lies down.


[State 3450, ChangeState]
type     = ChangeState
trigger1 = Enemy, Stateno = 3403
value    = 3451

;---------------------------------------------------------------------------
; Custom State - Lying on the ground (with zoom)
[Statedef 3451]
type    = L
movetype= H
physics = N
sprpriority = 0


[State 3451, AssertSpecial]
type = AssertSpecial
trigger1 = Time > 238;Enemy, stateno = 3404
ignorehitpause = 1
persistent = 1
flag = Invisible

[State 3451, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1


[State 3451, PosSet]
type = PosSet
trigger1 = !Time
x = 0
y = -100;-116

[State 3451, PosSet]
type = PosSet
trigger1 = Time > 238
x = 0
y = -9999


[State 3451, ChangeAnim2]
type = ChangeAnim2
trigger1 = !Time
value = IfElse(SelfAnimExist(5220),5220,3450)
elem = 1



[State 3451, AngleDraw]	;Scale 0
type = AngleDraw
trigger1 = Time <= 70
scale = 0,0;0.25,0.25
[State 3451, AngleDraw]	;Scale 1/3
type  = AngleDraw
trigger1 = Time > 70 && Time <= 140
scale = 0.33,0.33
[State 3451, AngleDraw]	;Scale 2/3
type = AngleDraw
trigger1 = Time > 140 && Time <= 200
scale = 0.66,0.66
[State 3451, AngleDraw]	;Scale 3/3 = 1
type = AngleDraw
trigger1 = Time > 200
scale = 1,1





[State 3451, ChangeState]
type     = ChangeState
trigger1 = Enemy, Stateno = 3406
value    = 3452

;---------------------------------------------------------------------------
; Custom State - Lying on the ground
[Statedef 3452]
type    = A
movetype= H
physics = N
sprpriority = 1


[State 0, PosSet]
type	= PosSet
trigger1	= !time
x	= 0
y	= 0

[State 0, ChangeAnim]
type     = ChangeAnim
trigger1 = !Time
value    = 5110
elem     = 1

;[State 0, ChangeAnim2]
;type     = ChangeAnim2
;trigger1 = Time = 110;135
;value    = 3455
;elem     = 1


;[State -2, AssertSpecial]
;type		= AssertSpecial
;trigger1		= time > 300;325
;ignorehitpause	= 1
;persistent	= 1
;flag 		= Invisible



[State 3451, ChangeState]
type     = ChangeState
trigger1 = Time = 80;110       ;350;400
value    = 3453;3454

;---------------------------------------------------------------------------
; Custom State - Bouncing on the ground
[Statedef 3453]
type    = A
movetype= H
physics = N
sprpriority = 1


[State 3453, PosSet]
type	= PosSet
trigger1	= !Time
x	= 0
y	= 0


[State 3453, ChangeAnim2]
type     = ChangeAnim2
trigger1 = !Time
value    = 3455
elem     = 1
[State 3453, ChangeAnim2]
type     = ChangeAnim2
trigger1 = Time = 50
trigger2 = Time = 110
trigger3 = Time = 160
trigger4 = Time = 230
;trigger5 = Time = 270
value    = 3455
elem     = 1





[State 3453, AssertSpecial]
type		= AssertSpecial
trigger1		= Time > 300;190   ;325
ignorehitpause	= 1
persistent	= 1
flag 		= Invisible

[State 3453, No Shake]
type	= EnvShake
trigger1	= Time = 300
time	= 20
freq	= 0
ampl	= 0



[State 3453, ChangeState]
type     = ChangeState
trigger1 = Time = 450		;400 ;240 ;350 ;400
value    = 3454

;---------------------------------------------------------------------------
; Downed get-hit (hit ground from fall)
[Statedef 3454]
type    = L
movetype= H
physics = N

[State 3454, No Shake]
type	= EnvShake
trigger1	= Time < 20
time	= 20
freq	= 0
ampl	= 0


[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = Time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0


[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 3455 ;Downed get-hit (bounce off ground)



;---------------------------------------------------------------------------
; Downed get-hit (bounce off ground)
[Statedef 3455]
type    = L
movetype= H
physics = N

[State 5101, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = Time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160

[State 5101, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = Time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160 + (anim % 10)

[State 5101, 3]
type = HitFallVel
trigger1 = Time = 0

[State 5101, 4]
type = PosSet
trigger1 = Time = 0
y = Const(movement.down.bounce.offset.y)

[State 5101, 5]
type = PosAdd
trigger1 = Time = 0
x = Const(movement.down.bounce.offset.x)

[State 5101, 6] ;Acceleration
type = VelAdd
trigger1 = 1
y = Const(movement.down.bounce.yaccel)

[State 5101, 7] ;Hit ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= Const(movement.down.bounce.groundlevel)
value = 3456











;---------------------------------------------------------------------------
; Downed get-hit (lying down)
[Statedef 3456]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = Time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = Time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0


[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

;[State 5110, 11] ;If just died
;type = ChangeState
;triggerall = !alive
;trigger1 = AnimTime = 0
;trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
;trigger3 = Anim = [5110,5119]
;value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0




[State 0, RemoveExplod];Put this when tien finishes or fails the technique
type = RemoveExplod
triggerall = Enemy, FVar(27) = 0
trigger1 = !Time
id = 991901



[State 2012, 12]
type = SelfState		;in case something happens, like Tien not hitting the enemy.
trigger1 = Time >= 280
value = IfElse(Alive,5120,5150)	;Alive = he gets up; dead = he lies down.








;---------------------------------------------------------------------------
; Action - Shield (Chiaotzu)
[Statedef 4498]
type = S
movetype = I
physics = S
ctrl = 0
anim = 4498
VelSet = 0,0
sprpriority = 2
facep2 = 1

[State 2004, Voice]	;Tien: "Chiaotzu!"   
type = PlaySnd
trigger1 = AnimElemTime (1) = 0
value = s85,3502
volumescale = 150
channel = 0


[State 195, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1




;---------------------------------------------------------------------------
; Reaction to Chiaotzu's Sacrifice
[Statedef 4499]
type = S
movetype = A
physics = S
ctrl = 0
anim = 4499
VelSet = 0,0
sprpriority = 2
facep2 = 1

[State 4499, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
;ignorehitpause = 
;persistent = 

[State 30000, turn]
type = Turn
trigger1 = p2dist X < -3



[State 2260, bg]
type = assertspecial
trigger1 = Time < 23
flag = noFG
flag2 = noBG
flag3 = globalnoshadow
ignorehitpause = 1


[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = nobardisplay
ignorehitpause = 1


[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze


[State 2200, SuperPause]
type = SuperPause
trigger1 = !Time
time = 23
p2defmul = 1
unhittable = 1
anim = -1
;sound = s3000,20
darken = 0
movetime = 23
persistent = 0



[State 2004, Sound Surprise]
type = PlaySnd
trigger1 = !Time
value = s3000,20
volumescale = 100
persistent = 0

[State 2200, BG Pal FX - Dark]
type = BGPalFX
trigger1 = !Time
time = 23;60
color = 0
mul = 0,0,0



[State 2200, Surprise Line 1]
type = Explod
trigger1 = !Time
anim = 10203
id = 10203
pos = 0,-87
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = -4
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0
[State 2200, Surprise Line 2]
type = Explod
trigger1 = !Time
anim = 10203
id = 10203
pos = 0,-87
postype = p1
facing = -1
vfacing = -1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = -4
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0



[State 2004, Voice]	  
type = PlaySnd
trigger1 = NumHelper(30000) && Helper(30000),stateno = 32501 && Helper(30000), time = 80
value = 85,5005;80,4499
volumescale = 150
channel = 0
persistent = 0





[State 2103, Super BG Proj]
type = Projectile
trigger1 = RoundState = 2
ProjID = 3000	;Ki attack
projanim = 15999
projremovetime = 1
ignorehitpause=1





[State 195, ChangeState]
type = ChangeState
triggerall = NumHelper(30000)
trigger1 = Helper(30000), StateNo = 32502
value = 4500
ctrl = 0

[State 195, ChangeState]
type = ChangeState
triggerall = NumHelper(30000)
trigger1 = Helper(30000), StateNo = [30000,30005] ;!= [32500,32509]
value = 0
ctrl = 1
[State 195, ChangeState]
type = ChangeState
triggerall = NumHelper(30000)
trigger1 = Helper(30000), StateNo = [30007,30020] ;!= [32500,32509]
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Reaction to Chiaotzu's Sacrifice - blowing up
[Statedef 4500]
type = S
movetype = A
physics = S
ctrl = 0
anim = 4500
VelSet = 0,0
sprpriority = 2

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze


[State 4500, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1




[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = nobardisplay
ignorehitpause = 1



[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
var(40) = 0
[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
fvar(27) = 0
[State 2700, Emotion bar abortion]
type = VarSet
trigger1 = !Time
fvar(28) = 0


[State 2004, Voice]	;Tien: "Chiaotzuuuuuu!!!"   
type = PlaySnd
trigger1 = AnimElemTime (5) = 0
value = s85,4500+random%3
volumescale = 150
channel = 0



[State 195, ChangeState]
type = ChangeState
;triggerall = NumHelper(30000)
;trigger1 = Helper(30000), StateNo = 32502
trigger1 = Time > 160 && WinKO
value = 4501
ctrl = 0

[State 195, ChangeState]
type = ChangeState
triggerall = NumHelper(30000)
trigger1 = Helper(30000), StateNo = 32504
;trigger1 = AnimTime = 0
value = 4502
ctrl = 1


;---------------------------------------------------------------------------
; Reaction to Chiaotzu's Sacrifice - blowing up - win
[Statedef 4501]
type = S

;ctrl = 0     
;If it's 0 it won't work normally, if it's 1 you can move around.
;If it's commented it works as intended.
;What the heck?
;Mugen problems!


[State 4501, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && PrevStateNo = 4500
value = 4501

[State 4501, PosAdd 1]
type = PosAdd
trigger1 = AnimElemTime(2) = 0 && Anim = 4501
X = 14
[State 4501, PosAdd 2]
type = PosAdd
trigger1 = AnimElemTime(3) = 0 && Anim = 4501
X = 12

[State 4501, PlaySnd];Ground
type = PlaySnd
trigger1 = AnimElemTime(3) = 0
value = S40, 0

[State 4501, Voice]	;Tien: "Chiaotzu..."   
type = PlaySnd
trigger1 = Time = 50
value = s85,4503
volumescale = 120
channel = 0






[State 4501, Changestate]
type     = Changestate
trigger1 = PrevStateNo = 4500; && AnimTime = 0
value    = 180
ctrl     = 1


[State 4501, AssertSpecial]
type = AssertSpecial
trigger1 = Time <= 150
flag = RoundNotOver


;---------------------------------------------------------------------------
; Reaction to Chiaotzu's Sacrifice - blowing up - still fighting
[Statedef 4502]
type = S
movetype = I
physics = S
ctrl = 0
anim = 4502
VelSet = 0,0
sprpriority = 2

[State -2, AssertSpecial]
type		= AssertSpecial
trigger1		= 1
ignorehitpause	= 1
persistent	= 1
flag		= TimerFreeze


[State 4502, Changestate]
type     = Changestate
trigger1 = AnimTime = 0
value    = 0
ctrl     = 1

